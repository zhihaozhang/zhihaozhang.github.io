<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Chih-Hao&#39;s Blog</title>
  <icon>https://www.gravatar.com/avatar/ee6c42acd9e6fdf6da073aabf58a2ad9</icon>
  <subtitle>éª¨ç°çº§æœç²‰</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://zhihaozhang.github.io/"/>
  <updated>2017-10-18T12:35:20.981Z</updated>
  <id>http://zhihaozhang.github.io/</id>
  
  <author>
    <name>Chih-Hao</name>
    <email>zhihaozhang@me.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ‹“æ‰‘å›¾çš„å®ç°</title>
    <link href="http://zhihaozhang.github.io/2017/10/18/topology/"/>
    <id>http://zhihaozhang.github.io/2017/10/18/topology/</id>
    <published>2017-10-18T07:31:13.472Z</published>
    <updated>2017-10-18T12:35:20.981Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>æ‹“æ‰‘å›¾æ˜¯Consoleç•Œé¢ä¸­ä¸€ä¸ªé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå®ƒçš„æ„¿æ™¯æ˜¯æˆ‘å…¬å¸Consoleå¹³å°ç›¸æ¯”äºå…¶ä»–å…¬å¸ç›¸åŒå¹³å°çš„åˆ›æ–°ä¹‹å¤„ã€‚è¿™ä¸ªéƒ¨åˆ†ä¸€ç›´æ˜¯ç”±æˆ‘æ¥è´Ÿè´£ï¼Œä»å¼€å§‹çš„é«˜åº¦æŠ½è±¡æ´¾å›¾å½¢åŒ–å›¾ï¼Œåˆ°åé¢åˆ›æ–°æ€§çš„å¼•å…¥Radial-layoutï¼Œåˆ°è¿™è½®è¿­ä»£è¿”ç’å½’çœŸçš„<strong>Tree-layout</strong>ä¿¡æ¯å±•ç¤ºï¼Œå‡ ç»è¿­ä»£ï¼Œæ„Ÿæ…¨è‰¯å¤šã€‚å¾ˆå¤šæ—¶å€™éƒ½è¦è·Ÿè®¾è®¡å¸ˆæ­»ç£•ï¼Œåœ¨ä»–çš„æƒ³æ³•ä¸æŠ€æœ¯ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªæƒè¡¡ç‚¹ã€‚æœ¬æ–‡ä½œä¸ºæœ¬è½®è¿­ä»£çš„ä¸€ä¸ªå°å°æ€»ç»“ï¼Œä¹Ÿä½œä¸ºAPIæ–‡æ¡£çš„ä¾›å…¶ä»–åŒäº‹å‚è€ƒã€‚ä¹Ÿå› ä¸ºè¦ä½œä¸ºAPIæ–‡æ¡£ï¼Œå› æ­¤æœ¬æ–‡ä¼šæ·±å…¥åˆ°ä»£ç çº§è®²è¿°æ¯æ®µä»£ç ç”šè‡³å‡½æ•°å’Œå…³é”®å˜é‡çš„ä½œç”¨ã€‚</p><h1 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h1><p>æ‹“æ‰‘å›¾çš„ç›®æ ‡æ˜¯åˆ©ç”¨å›¾å½¢åŒ–çš„æ–¹å¼<strong>æ¸…æ™°åœ°</strong>å±•ç¤ºé›†ç¾¤å†…<em>Appã€Serviceã€Deploymentã€Podã€Storage</em>ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶æä¾›äº¤äº’æ‰‹æ®µç»™ç”¨æˆ·åŠ¨æ€çš„å¢å‡Podï¼ŒæŸ¥çœ‹æŸéƒ¨åˆ†çš„Detailä¿¡æ¯ç­‰ã€‚</p><h1 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h1><p>æœ€æ–°ç‰ˆæœ¬çš„æ‹“æ‰‘å›¾æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º:</p><div align="center"><br><img src="https://ip.freep.cn/588778/demo.png" alt=""><br>æœ€æ–°ç‰ˆæœ¬çš„æ‹“æ‰‘å›¾<br></div><p>è¯·æ³¨æ„ï¼Œå›¾ç‰‡ä¸­é™¤äº†åæœŸåŠ ä¸Šçš„è¯´æ˜æ–‡å­—å’Œè¾¹æ¡†å¤–ï¼Œå…¶ä»–çš„ä¸€åˆ‡å…ƒç´ éƒ½æ˜¯ä½¿ç”¨<a href="https://d3js.org" target="_blank" rel="external">d3.js</a>è¿™ä¸ªåº“ç»˜åˆ¶ä¸Šå»çš„ï¼ŒåŒ…æ‹¬å…¶ä¸­çš„æ–‡å­—ã€‚</p><p>ä»æ€»ä½“ä¸Šçœ‹ï¼Œæ‹“æ‰‘å›¾ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œåˆ†åˆ«æ˜¯é¡¶éƒ¨çš„<strong>æ ·ä¾‹è¯´æ˜åŒº</strong>ã€ä¸»ä½“éƒ¨åˆ†çš„<strong>ä¿¡æ¯å±•ç¤ºåŒº</strong>ã€å³ä¸Šè§’çš„<strong>ç»†èŠ‚ä¿¡æ¯å±•ç¤ºåŒº</strong>ã€‚ç”»å¸ƒåç§°æ˜¯vis,è¿™æ˜¯ä¸€ä¸ªå¾ˆå…³é”®çš„å…¨å±€å˜é‡ã€‚</p><h2 id="æ ·ä¾‹è¯´æ˜åŒº"><a href="#æ ·ä¾‹è¯´æ˜åŒº" class="headerlink" title="æ ·ä¾‹è¯´æ˜åŒº"></a>æ ·ä¾‹è¯´æ˜åŒº</h2><p>å’Œå¦å¤–ä¸¤ä¸ªéƒ¨åˆ†ä¸åŒï¼Œæ ·ä¾‹è¯´æ˜åŒºæ˜¯<strong>é™æ€</strong>çš„ï¼Œä¸ä¼šå› ä¸ºä¸åŒçš„Appè€Œå˜åŒ–ã€‚å› æ­¤è¿™ä¸ªéƒ¨åˆ†ç›¸å¯¹ç®€å•ï¼Œæ¶‰åŠåˆ°çš„ä»£ç ä¹Ÿä¸æ˜¯å¾ˆå¤šã€‚ä¸»è¦çš„å®ç°æ–¹å¼æ˜¯é¦–å…ˆç»˜åˆ¶ä¸€ä¸ªæ— è¾¹æ¡†çš„åœ†è§’çŸ©å½¢æ”¾ç½®åœ¨åº•éƒ¨ï¼Œç„¶åç”¨ä»£ç æ§åˆ¶åœ†åœˆå’Œç›¸åº”æ–‡å­—çš„é—´éš”å’Œç±»å‹ã€‚ç±»å‹æ˜¯ä¸ºäº†æ–¹ä¾¿å°†cssæ ·å¼åº”ç”¨åˆ°å›¾å½¢ä¸Šåšçš„å‡†å¤‡ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><pre><code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">     vis.append(<span class="string">'rect'</span>)</div><div class="line">      .attr(<span class="string">'x'</span>,<span class="number">-18</span>)</div><div class="line">      .attr(<span class="string">'y'</span>,<span class="number">-30</span>)</div><div class="line">      .attr(<span class="string">'rx'</span>,<span class="number">5</span>)</div><div class="line">      .attr(<span class="string">'ry'</span>,<span class="number">5</span>)</div><div class="line">      .attr(<span class="string">'width'</span>,<span class="number">4</span>*<span class="number">180</span>+<span class="number">120</span>)</div><div class="line">      .attr(<span class="string">'height'</span>,<span class="number">30</span>)</div><div class="line">      .attr(<span class="string">'stroke'</span>,<span class="string">'none'</span>)</div><div class="line">      .style(<span class="string">'fill'</span>,<span class="string">'#f0f0f0'</span>);</div><div class="line">      </div><div class="line"> <span class="keyword">var</span> exampleData = [<span class="string">'App'</span>,<span class="string">'Service'</span>,<span class="string">'Deployment'</span>,<span class="string">'Pod'</span>,<span class="string">'Storage'</span>];</div><div class="line">  <span class="keyword">var</span> example = vis.selectAll(<span class="string">'.example'</span>).data(exampleData).enter().append(<span class="string">'g'</span>);</div><div class="line">     </div><div class="line">      example.append(<span class="string">'circle'</span>)</div><div class="line">      .attr(<span class="string">'cy'</span>,<span class="number">-15</span>)</div><div class="line">      .attr(<span class="string">'cx'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="number">180</span>*(i);</div><div class="line">      &#125;)</div><div class="line">          .style(<span class="string">'fill'</span>,<span class="string">'#fff'</span>)</div><div class="line">      .attr(<span class="string">'r'</span>,<span class="number">7</span>)</div><div class="line">      .attr(<span class="string">'class'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>)</span>&#123;</div><div class="line">      <span class="keyword">if</span>(i == <span class="number">0</span>)&#123;</div><div class="line">          <span class="keyword">return</span> <span class="string">'app'</span></div><div class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i ==<span class="number">1</span>)&#123;</div><div class="line">          <span class="keyword">return</span> <span class="string">'service'</span></div><div class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i ==<span class="number">2</span>)&#123;</div><div class="line">          <span class="keyword">return</span> <span class="string">'deployment'</span></div><div class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i ==<span class="number">3</span>)&#123;</div><div class="line">          <span class="keyword">return</span> <span class="string">'pod'</span></div><div class="line">      &#125;<span class="keyword">else</span> <span class="keyword">if</span>(i ==<span class="number">4</span>)&#123;</div><div class="line">          <span class="keyword">return</span> <span class="string">'storage'</span></div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="string">'unclear'</span></div><div class="line">      &#125;</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">example.append(<span class="string">"text"</span>).attr(<span class="string">'class'</span>,<span class="string">'exampleTEXT'</span>).attr(<span class="string">"x"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d,i</span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="number">180</span>*i+<span class="number">10</span></div><div class="line">      &#125;).attr(<span class="string">"y"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="number">-15</span>;</div><div class="line">      &#125;).attr(<span class="string">"dy"</span>, <span class="string">".35em"</span>).attr(<span class="string">"text-anchor"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="string">"start"</span>;</div><div class="line">      &#125;).text(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> d;</div><div class="line">      &#125;).style(<span class="string">"fill-opacity"</span>, <span class="number">1</span>);</div></pre></td></tr></table></figure></code></pre><h2 id="ä¸»ä½“ä¿¡æ¯å±•ç¤ºåŒº"><a href="#ä¸»ä½“ä¿¡æ¯å±•ç¤ºåŒº" class="headerlink" title="ä¸»ä½“ä¿¡æ¯å±•ç¤ºåŒº"></a>ä¸»ä½“ä¿¡æ¯å±•ç¤ºåŒº</h2><p>ä¸»ä½“ä¿¡æ¯çš„å±•ç¤ºæ˜¯æ‹“æ‰‘å›¾çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚å„ä¸ªç»„ä»¶çš„æ•°é‡ä¼šæœ‰å¾ˆå¤§çš„å˜åŒ–èŒƒå›´ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¼ƒç”¨è€ç‰ˆæœ¬æ‹“æ‰‘å›¾çš„åŸå› ã€‚å¦ç‡çš„è®²ï¼Œè€ç‰ˆæœ¬çš„æ‹“æ‰‘å›¾æ˜¯æ¯”è¾ƒç¾è§‚çš„ã€å›¾å½¢åŒ–çš„ï¼Œä½†æ˜¯é‡åˆ°çš„æ ¸å¿ƒé—®é¢˜æ˜¯å½“æŸäº›ç»„ä»¶æ•°é‡è¿‡å¤§æ—¶ï¼Œå®¹æ˜“å¼•èµ·å¤§é‡çš„é‡å é—®é¢˜ï¼Œé€ æˆæ•´ä¸ªç³»ç»Ÿä¸workäº†ã€‚</p><p>è€Œè¿™ä¸ªç‰ˆæœ¬çš„æ‹“æ‰‘å›¾å¾—ç›Šäºd3æä¾›çš„Treeå¸ƒå±€æ–¹å¼ï¼Œæ¯”è¾ƒå¥½çš„è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚å®ƒä¼šæ ¹æ®ç”¨æˆ·æŒ‡å®šçš„ç”»å¸ƒå®½é«˜ï¼Œç®—å‡ºæœ€é€‚åˆçš„å¸ƒå±€æ–¹å¼ï¼Œå³æ¯ä¸ªç‚¹åº”è¯¥æ”¾ç½®åœ¨å“ªé‡Œã€‚</p><p>Tree-layoutæ¥å—çš„æ•°æ®å½¢å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p>æœ€æ–°ç‰ˆæœ¬çš„æ‹“æ‰‘å›¾æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º:</p><div align="center"><br><img src="https://ip.freep.cn/588778/E6A8D171-0CC5-4351-9FB3-A4D76BDD6A08.png" alt=""><br>Tree-layoutæ¥å—çš„æ•°æ®æ ¼å¼<br></div><p>æˆ‘ä»¬backendæä¾›çš„jsonæ–‡ä»¶ä¸è¦æ±‚çš„æ•°æ®æ ¼å¼æœ‰è¾ƒå¤§çš„å·®åˆ«ï¼Œä¸‹é¢æ¯”è¾ƒæ¶å¿ƒçš„ä»£ç çš„åŠŸèƒ½æ˜¯åˆ©ç”¨å¾ªç¯å°†åç«¯æä¾›çš„jsonæ–‡ä»¶è½¬åŒ–æˆTree-layoutéœ€è¦çš„æ ¼å¼ã€‚</p><pre><code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">d3.json(<span class="string">"topologyRaw.json"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">error, data</span>) </span>&#123;</div><div class="line">     <span class="keyword">if</span> (error) <span class="keyword">throw</span> error;</div><div class="line"></div><div class="line">     <span class="keyword">var</span> jsonData = &#123;<span class="attr">name</span>:<span class="string">"nil"</span>,<span class="attr">children</span>:<span class="keyword">new</span> <span class="built_in">Array</span>()&#125;;</div><div class="line">     apps = data.app;</div><div class="line">     storages = data.storages;</div><div class="line">     services = data.services;</div><div class="line">     deployments = data.deployments;</div><div class="line"></div><div class="line">     <span class="keyword">var</span> tmpDeployment;</div><div class="line"></div><div class="line">     jsonData.name = data.app.name;</div><div class="line"></div><div class="line">     <span class="keyword">for</span>(<span class="keyword">var</span> i =<span class="number">0</span> ;i&lt;services.length;i++)&#123;</div><div class="line">         <span class="keyword">var</span> service = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line">         <span class="keyword">for</span>(<span class="keyword">var</span> j=<span class="number">0</span>;j&lt;deployments.length;j++)&#123;</div><div class="line">             <span class="keyword">var</span> deployment = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line">             <span class="keyword">if</span>(contains(deployments[j][<span class="string">"selector"</span>][<span class="string">"matchLabels"</span>],services[i][<span class="string">"selector"</span>]))&#123;</div><div class="line">                 <span class="keyword">var</span> pod = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line">                 <span class="keyword">for</span>(<span class="keyword">var</span> k=<span class="number">0</span>;k&lt;deployments[j][<span class="string">"pods"</span>].length;k++)&#123;</div><div class="line">                     <span class="keyword">var</span> storage = <span class="keyword">new</span> <span class="built_in">Array</span>();</div><div class="line">                     <span class="keyword">for</span>(<span class="keyword">var</span> m=<span class="number">0</span>;m&lt;deployments[j][<span class="string">"pods"</span>][k][<span class="string">"storageNames"</span>].length;m++) &#123;</div><div class="line">                         <span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; storages.length; n++) &#123;</div><div class="line">                             <span class="keyword">if</span>(deployments[j][<span class="string">"pods"</span>][k][<span class="string">"storageNames"</span>][m]==storages[n][<span class="string">"storageName"</span>]) &#123;</div><div class="line">                                 <span class="keyword">if</span>(storages[n].unshared==<span class="literal">true</span> &amp;&amp; storages[n][<span class="string">"storageType"</span>]==<span class="string">"HostPath"</span>)</div><div class="line">                                 &#123;</div><div class="line">                                     <span class="keyword">for</span>(<span class="keyword">var</span> q=<span class="number">0</span>;q&lt;storages[n][<span class="string">"hostpathInfo"</span>].length;q++)</div><div class="line">                                     &#123;</div><div class="line">                                         storage.push(&#123;</div><div class="line">                                             name: storages[n][<span class="string">"storageName"</span>],</div><div class="line">                                             size: storages[n][<span class="string">"hostpathInfo"</span>][q][<span class="string">"amountBytes"</span>]</div><div class="line">                                         &#125;)</div><div class="line">                                     &#125;</div><div class="line">                                 &#125;</div><div class="line">                                 <span class="keyword">else</span>&#123;</div><div class="line">                                     storage.push(&#123;</div><div class="line">                                         name: deployments[j][<span class="string">"pods"</span>][k][<span class="string">"storageNames"</span>][m],</div><div class="line">                                         size: getAmountByStorageName(deployments[j][<span class="string">"pods"</span>][k][<span class="string">"storageNames"</span>][m])</div><div class="line">                                     &#125;)</div><div class="line">                                 &#125;</div><div class="line">                             &#125;</div><div class="line"></div><div class="line">                         &#125;</div><div class="line"></div><div class="line">                     &#125;</div><div class="line">                     pod.push(&#123;<span class="attr">name</span>:deployments[j][<span class="string">"pods"</span>][k].name,<span class="attr">children</span>:deepClone(storage)&#125;);</div><div class="line"></div><div class="line">                 &#125;</div><div class="line">                 tmpDeployment = deployments[j].name;</div><div class="line">             &#125;</div><div class="line">             deployment.push(&#123;<span class="attr">name</span>:(tmpDeployment),<span class="attr">children</span>:deepClone(pod)&#125;);</div><div class="line"></div><div class="line">         &#125;</div><div class="line"></div><div class="line">         jsonData.children.push(&#123;<span class="attr">name</span>:services[i].name,<span class="attr">children</span>:deepClone(deployment)&#125;);</div><div class="line">     &#125;</div></pre></td></tr></table></figure></code></pre><h3 id="èŠ‚ç‚¹çš„æ ·å¼å’Œå±•å¼€åŠŸèƒ½"><a href="#èŠ‚ç‚¹çš„æ ·å¼å’Œå±•å¼€åŠŸèƒ½" class="headerlink" title="èŠ‚ç‚¹çš„æ ·å¼å’Œå±•å¼€åŠŸèƒ½"></a>èŠ‚ç‚¹çš„æ ·å¼å’Œå±•å¼€åŠŸèƒ½</h3><p>ä¸ºäº†è®©å„ä¸ªç»„ä»¶çš„æ ·å¼æ»¡è¶³è®¾è®¡å¸ˆçš„ä¸¥è‹›è¦æ±‚ï¼Œéœ€è¦æ ¹æ®Tree-Layoutçš„depth(æ·±åº¦)è¿›è¡Œåˆ¤æ–­ï¼Œæ§åˆ¶åœ†å½¢çš„é¢œè‰²ã€è¯´æ˜æ–‡å­—å‡ºç°çš„ä½ç½®<em>ï¼ˆæ”¾ç½®ä½ç½®å’Œå¯¹é½æ–¹å¼ï¼‰</em>ã€‚è¿™éƒ¨åˆ†é€»è¾‘æ˜¯åœ¨nodeEnterã€nodeUpdateå’ŒnodeExitç›¸å…³å˜é‡åé¢æŒ‡å®šçš„ã€‚ä¹Ÿæ˜¯å‡­å€Ÿè¿™ä¸‰ä¸ªå˜é‡ä¹‹é—´çš„åå·®ï¼Œæ¯æ¬¡é¡µé¢åˆšæ‰“å¼€å¹¶loadçš„æ—¶å€™ï¼Œä¼šæœ‰ä¸€ä¸ªèˆ’å±•å¼€çš„æ ·å¼ï¼Œéå¸¸ç¾è§‚ã€‚</p><div align="center"><br><img src="https://ip.freep.cn/588778/%E6%9C%AA%E5%91%BD%E5%90%8D.gif" alt=""><br>å±•å¼€çš„è¿‡ç¨‹<br></div><h3 id="èŠ‚ç‚¹çš„å¼€å…³åŠŸèƒ½"><a href="#èŠ‚ç‚¹çš„å¼€å…³åŠŸèƒ½" class="headerlink" title="èŠ‚ç‚¹çš„å¼€å…³åŠŸèƒ½"></a>èŠ‚ç‚¹çš„å¼€å…³åŠŸèƒ½</h3><p>åŒæ ·ï¼Œå±•å¼€åï¼ŒåæœŸä¾ç„¶å¯ä»¥æ§åˆ¶æŸä¸ªèŠ‚ç‚¹çš„å­èŠ‚ç‚¹çš„å¼€åˆçŠ¶æ€ï¼Œç‚¹å‡»æŸä¸ªèŠ‚ç‚¹ï¼Œå®ƒçš„å­èŠ‚ç‚¹æ‰€åŒ…å«çš„å…ƒç´ ä¼šä»¥åŠ¨ç”»çš„å½¢å¼æ”¶ç¼©è¿›å®ƒçš„ä½ç½®ï¼Œè¯¥èŠ‚ç‚¹çš„ä¸­å¿ƒéƒ¨åˆ†ä¹Ÿä¼šç”±ç™½è‰²å˜ä¸ºæµ…ç°è‰²ï¼Œå¹¶ä¸”æ•´ä¸ªå¸ƒå±€ä¼šç›¸åº”å‘ç”Ÿå˜åŒ–ã€‚å†æ¬¡ç‚¹å‡»ï¼Œä¼šæ‰§è¡Œç›¸åçš„æ“ä½œï¼Œæ”¶ç¼©è¿›å»çš„éƒ¨åˆ†ä¼šå†æ¬¡èˆ’å±•å¼€ã€‚è¿™ä¸ªé€»è¾‘æ˜¯ç”±toggleå’Œupdateå‡½æ•°å®Œæˆçš„ã€‚toggleå‡½æ•°çš„ä¼šå°†d.childrenä¿å­˜åˆ°å¦ä¸€ä¸ªå˜é‡_childrenä¸­ï¼Œç„¶åå°†d.childrenç½®ç©º(æˆ–æ‰§è¡Œç›¸åæ“ä½œ)ï¼Œç„¶åè°ƒç”¨updateå‡½æ•°é‡æ–°ç»˜åˆ¶Treeçš„åˆ†æ”¯ã€‚</p><pre><code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"> toggle = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span>(d) &#123;</div><div class="line">        <span class="keyword">if</span> (d.children) &#123;</div><div class="line">            d._children = d.children;</div><div class="line">            <span class="keyword">return</span> d.children = <span class="literal">null</span>;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            d.children = d._children;</div><div class="line">            <span class="keyword">return</span> d._children = <span class="literal">null</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">update = <span class="function"><span class="keyword">function</span>(<span class="params">source</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> duration, link, node, nodeEnter, nodeExit, nodeUpdate, nodes;</div><div class="line">  duration = d3.event &amp;&amp; d3.event.altKey ? <span class="number">5000</span> : <span class="number">500</span>;</div><div class="line">  nodes = tree.nodes(root).reverse();</div><div class="line">  nodes.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> d.y = d.depth * <span class="number">180</span>;</div><div class="line">  &#125;);</div><div class="line">  node = vis.selectAll(<span class="string">"g.node"</span>).data(nodes, <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> d.id || (d.id = ++i);</div><div class="line">  &#125;).attr(<span class="string">'id'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">      <span class="keyword">return</span> d.name;</div><div class="line">  &#125;);</div></pre></td></tr></table></figure></code></pre><h3 id="å¢åˆ podçš„åŠŸèƒ½"><a href="#å¢åˆ podçš„åŠŸèƒ½" class="headerlink" title="å¢åˆ podçš„åŠŸèƒ½"></a>å¢åˆ podçš„åŠŸèƒ½</h3><p>å¢åˆ podçš„åŠŸèƒ½æ˜¯åœ¨æ¯æ¡deploymentä¸podä¹‹é—´çš„åŠ å…¥ä¸¤å¼ é¢„å…ˆåšå¥½çš„å›¾ç‰‡ï¼Œç›‘å¬clickäº‹ä»¶ï¼Œè°ƒç”¨ç›¸åº”çš„åç«¯APIï¼Œå®ç°å¢åˆ çš„åŠŸèƒ½ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<strong>åœ†ç¯å½¢ã€å›¾ç‰‡ã€æ–‡å­—è¯´æ˜</strong>æ˜¯depolymentçš„ä¸€ä¸ªgï¼Œç‚¹å‡»å›¾ç‰‡é»˜è®¤æƒ…å†µä¸‹ä¼šé€ æˆdeploymentå…³é—­çŠ¶æ€ã€‚å› æ­¤è¦åœ¨clickäº‹ä»¶ä¸­åŠ å…¥<strong>d3.event.stopPropagation();</strong>è®©ç‚¹å‡»äº‹ä»¶ä¸å†å‘ä¸‹ä¼ æ’­ã€‚</p><h3 id="hoveré«˜äº®æ•ˆæœ"><a href="#hoveré«˜äº®æ•ˆæœ" class="headerlink" title="hoveré«˜äº®æ•ˆæœ"></a>hoveré«˜äº®æ•ˆæœ</h3><p>æ³¨æ„åˆ°ï¼Œå½“é¼ æ ‡hoveråˆ°æŸä¸ªå…ƒç´ ä¸Šæ—¶ï¼Œå…ƒç´ ä»£è¡¨çš„textä¼šé«˜äº®ï¼Œä»APPå¼€å§‹ç»è¯¥å…ƒç´ åˆ°è¾¾storageçš„è·¯å¾„éƒ½å°†ä¼šè¢«é«˜äº®ã€‚è¿™ä¸ªéƒ¨åˆ†ä¸»è¦æ˜¯ç”±highlightOnå’ŒhighlightOffè¿™ä¸¤ä¸ªå‡½æ•°æ§åˆ¶çš„ã€‚</p><p>åœ¨å»ºç«‹è·¯å¾„çš„æ—¶å€™ï¼Œæˆ‘ä»¬ç»™æ¯ä¸€æ®µè·¯å¾„éƒ½åŠ ä¸Šä¸€ä¸ªä¸€ä¸ªid</p><blockquote><p>path.link.source-â€œ + d.parent.name+d.parent.id + â€œ.target-â€œ + d.name+d.id<br>ç”±pathçš„èµ·å§‹ç‚¹åˆ°pathçš„ç»ˆç‚¹id+nameç»„æˆï¼Œè¿™æ ·å°±å¯ä»¥å”¯ä¸€ç¡®å®šè¯¥pathã€‚</p></blockquote><p>hightlightOnå‡½æ•°ä¸­ï¼Œæœ‰ä¸¤ä¸ªé‡è¦çš„å­å‡½æ•°ï¼Œ<strong>parentLine()å’ŒchildLine()</strong>ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°æ˜¯å¯»æ‰¾ä»Appåˆ°è¯¥èŠ‚ç‚¹å’Œä»è¯¥èŠ‚ç‚¹åˆ°storageèŠ‚ç‚¹çš„è·¯å¾„ç”¨çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">highlightOn = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> parentLine;</div><div class="line">  parentLine = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (d.parent) &#123;</div><div class="line">      parentLine(d.parent);</div><div class="line">      vis.selectAll(<span class="string">"path.link.source-"</span> + d.parent.name+d.parent.id + <span class="string">".target-"</span> + d.name+d.id).classed(<span class="string">'highlight'</span>, <span class="literal">true</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">  parentLine(d);</div><div class="line"></div><div class="line">  <span class="keyword">var</span> childLine = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">      <span class="keyword">if</span>(d.children &amp;&amp; d.children.length&gt;<span class="number">0</span>)&#123;</div><div class="line">          <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;d.children.length;i++)&#123;</div><div class="line">              childLine(d.children[i]);</div><div class="line">              vis.selectAll(<span class="string">"path.link.source-"</span>+d.name+d.id+<span class="string">".target-"</span>+d.children[i].name+d.children[i].id).classed(<span class="string">'highlight'</span>,<span class="literal">true</span>);</div><div class="line">          &#125;</div><div class="line">      &#125;</div><div class="line">  &#125;;</div><div class="line">  childLine(d);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> update(d);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">highlightOff = <span class="function"><span class="keyword">function</span>(<span class="params">d</span>) </span>&#123;</div><div class="line">  vis.selectAll(<span class="string">"path.link"</span>).classed(<span class="string">'highlight'</span>, <span class="literal">false</span>);</div><div class="line">  <span class="keyword">return</span> update(d);</div><div class="line">&#125;;</div></pre></td></tr></table></figure><h2 id="detailä¿¡æ¯"><a href="#detailä¿¡æ¯" class="headerlink" title="detailä¿¡æ¯"></a>detailä¿¡æ¯</h2><p>Detailçš„ä¿¡æ¯ï¼Œä¹‹å‰çš„åšå®¢ä¸­å†™è¿‡äº†ï¼Œå¯ä»¥å‚è€ƒå‰é¢çš„ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;æ‹“æ‰‘å›¾æ˜¯Consoleç•Œé¢ä¸­ä¸€ä¸ªé‡è¦çš„ç»„æˆéƒ¨åˆ†ï¼Œå®ƒçš„æ„¿æ™¯æ˜¯æˆ‘å…¬å¸Consoleå¹³å°ç›¸æ¯”äºå…¶ä»–å…¬å¸ç›¸åŒå¹³å°çš„åˆ›æ–°ä¹‹å¤„ã€‚è¿™ä¸ªéƒ¨åˆ†ä¸€ç›´æ˜¯ç”±æˆ‘æ¥è´Ÿè´£
      
    
    </summary>
    
      <category term="d3" scheme="http://zhihaozhang.github.io/categories/d3/"/>
    
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/tags/visualization/"/>
    
  </entry>
  
  <entry>
    <title>Swift4å­—å…¸å’Œé›†åˆçš„æ–°ç‰¹æ€§</title>
    <link href="http://zhihaozhang.github.io/2017/10/13/DicAndSetInSwift4/"/>
    <id>http://zhihaozhang.github.io/2017/10/13/DicAndSetInSwift4/</id>
    <published>2017-10-13T06:02:20.042Z</published>
    <updated>2017-10-13T06:02:35.750Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—æ›´å¥½"><a href="#Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—æ›´å¥½" class="headerlink" title="Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—æ›´å¥½"></a>Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—æ›´å¥½</h1><h2 id="å†™åœ¨å‰é¢"><a href="#å†™åœ¨å‰é¢" class="headerlink" title="å†™åœ¨å‰é¢"></a>å†™åœ¨å‰é¢</h2><p>åœ¨æœ€æ–°ç‰ˆæœ¬çš„Swiftä¸­ï¼Œdictionarieså’Œsetsæ–°å¢äº†å¾ˆå¤šè¡Œä¸ºæ–¹æ³•å’Œåˆå§‹åŒ–æ–¹æ³•ï¼Œè®©ä¸€äº›å¸¸è§çš„ä»»åŠ¡å˜å¾—å¼‚å¸¸ç®€å•ã€‚è¯¸å¦‚ç»„åˆã€è¿‡æ»¤å’Œtransformå€¼æ“ä½œå¯ä»¥ç”¨ä¸€æ­¥å®Œæˆï¼Œè®©ä½¿ç”¨è€…å¯ä»¥å†™å‡ºæ›´é«˜æ•ˆå’Œç®€æ´çš„ä»£ç ã€‚</p><p>æœ¬ç¯‡åšå®¢å°†ä½¿ç”¨æ‚è´§é“ºä¸­çš„å•†å“ä½œä¸ºä¾‹å­æ¼”ç¤ºè¿™äº›æ–°åŠŸèƒ½ã€‚GroceryItemç»“æ„ä½“ï¼Œç”±åå­—å’Œéƒ¨é—¨ç»„æˆï¼Œä½œä¸ºæœ¬ä¾‹çš„æ•°æ®ç±»å‹ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">GroceryItem</span>: <span class="title">Hashable</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> name: <span class="type">String</span></div><div class="line">    <span class="keyword">var</span> department: <span class="type">Department</span></div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">enum</span> <span class="title">Department</span> </span>&#123;</div><div class="line">        <span class="keyword">case</span> bakery, produce, seafood</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> ==<span class="params">(lhs: GroceryItem, rhs: GroceryItem)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">return</span> (lhs.name, lhs.department) == (rhs.name, rhs.department)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> hashValue: <span class="type">Int</span> &#123;</div><div class="line">        <span class="comment">// Combine the hash values for the name and department</span></div><div class="line">        <span class="keyword">return</span> name.hashValue &lt;&lt; <span class="number">2</span> | department.hashValue</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Create some groceries for our store:</span></div><div class="line"><span class="keyword">let</span> ğŸ = <span class="type">GroceryItem</span>(name: <span class="string">"Apples"</span>, department: .produce)</div><div class="line"><span class="keyword">let</span> ğŸŒ = <span class="type">GroceryItem</span>(name: <span class="string">"Bananas"</span>, department: .produce)</div><div class="line"><span class="keyword">let</span> ğŸ¥ = <span class="type">GroceryItem</span>(name: <span class="string">"Croissants"</span>, department: .bakery)</div><div class="line"><span class="keyword">let</span> ğŸŸ = <span class="type">GroceryItem</span>(name: <span class="string">"Salmon"</span>, department: .seafood)</div><div class="line"><span class="keyword">let</span> ğŸ‡ = <span class="type">GroceryItem</span>(name: <span class="string">"Grapes"</span>, department: .produce)</div><div class="line"><span class="keyword">let</span> ğŸ = <span class="type">GroceryItem</span>(name: <span class="string">"Bread"</span>, department: .bakery)</div><div class="line"><span class="keyword">let</span> ğŸ¤ = <span class="type">GroceryItem</span>(name: <span class="string">"Shrimp"</span>, department: .seafood)</div><div class="line"></div><div class="line"><span class="keyword">let</span> groceries = [ğŸ, ğŸŒ, ğŸ¥, ğŸŸ, ğŸ‡, ğŸ, ğŸ¤]</div></pre></td></tr></table></figure><p>åé¢çš„ä¾‹å­å°†å›´ç»•ç€groceriesæ•°ç»„å±•ç¤ºã€‚</p><h2 id="ç”¨Keyå€¼å¯¹åŸæ•°ç»„è¿›è¡Œåˆ†ç»„"><a href="#ç”¨Keyå€¼å¯¹åŸæ•°ç»„è¿›è¡Œåˆ†ç»„" class="headerlink" title="ç”¨Keyå€¼å¯¹åŸæ•°ç»„è¿›è¡Œåˆ†ç»„"></a>ç”¨Keyå€¼å¯¹åŸæ•°ç»„è¿›è¡Œåˆ†ç»„</h2><p>å­—å…¸æ‹¥æœ‰äº†ä¸€ä¸ªæ–°çš„åˆå§‹åŒ–å‡½æ•°ï¼Œå¯ä»¥å°†ä¸€ç³»åˆ—å€¼æŒ‰ç…§Keyå€¼è¿›è¡Œåˆ†ç»„ã€‚ä¸‹é¢å±•ç¤ºä½¿ç”¨è¯¥åˆå§‹åŒ–æ–¹æ³•æ ¹æ®GroceryItemçš„departmentè¿›è¡Œåˆ†ç»„çš„ä¸€ä¸ªå°ä¾‹å­ã€‚</p><div align="center"><br><img src="https://swift.org/assets/images/dictionary-blog/grouping_2x.png" alt=""><br></div><p>åœ¨è€ç‰ˆæœ¬çš„Swiftä¸­ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„ä»£ç å®Œæˆä¸Šè¿°ä»»åŠ¡ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Swift &lt;= 3.1</span></div><div class="line"><span class="keyword">var</span> grouped: [<span class="type">GroceryItem</span>.<span class="type">Department</span>: [<span class="type">GroceryItem</span>]] = [:]</div><div class="line"><span class="keyword">for</span> item <span class="keyword">in</span> groceries &#123;</div><div class="line">    <span class="keyword">if</span> grouped[item.department] != <span class="literal">nil</span> &#123;</div><div class="line">        grouped[item.department]!.append(item)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        grouped[item.department] = [item]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™ä¸€è¿‡ç¨‹éœ€è¦ä½¿ç”¨type annotationsã€æ‰‹åŠ¨å¾ªç¯å¹¶ä¸”éœ€è¦æ£€æŸ¥departementæ˜¯å¦å·²ç»å­˜åœ¨äº†ã€‚</p><p>åœ¨Swift4ä¸­ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨<strong>Dictionary(grouping:by)</strong>æ–¹æ³•ï¼Œä»…éœ€ä¸€è¡Œä»£ç å°±å¯ä»¥è¾¾åˆ°ä¸Šè¿°æ•ˆæœã€‚æ‰€è¦åšçš„æ˜¯ä¼ å…¥ä¸€ä¸ªé—­åŒ…ï¼Œè¯¥é—­åŒ…è¿”å›æ•°ç»„æ¯ä¸€é¡¹é¡¹å¯¹åº”çš„Keyå€¼å³å¯ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Swift 4.0</span></div><div class="line"><span class="keyword">let</span> groceriesByDepartment = <span class="type">Dictionary</span>(grouping: groceries,</div><div class="line">                                       by: &#123; item <span class="keyword">in</span> item.department &#125;)</div><div class="line"><span class="comment">// groceriesByDepartment[.bakery] == [ğŸ¥, ğŸ]</span></div></pre></td></tr></table></figure><p>æœ€ç»ˆçš„å­—å…¸groceriesByDepartmentå¯¹æ¯ä¸ªdepartmentéƒ½æœ‰å”¯ä¸€å…¥å£ï¼Œè€Œä¸”è¯¥å…¥å£å¯¹åº”ç€GroceryItemç›¸åº”çš„nameã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨.bakeryä½œä¸ºå…¥å£ï¼Œå°†è¿”å›[ğŸ¥, ğŸ]æ•°ç»„ã€‚</p><h2 id="è·å¾—å­—å…¸å€¼çš„æ•°é‡"><a href="#è·å¾—å­—å…¸å€¼çš„æ•°é‡" class="headerlink" title="è·å¾—å­—å…¸å€¼çš„æ•°é‡"></a>è·å¾—å­—å…¸å€¼çš„æ•°é‡</h2><p>ä½¿ç”¨æ–°çš„<strong>mapValues(_:)</strong>æ–¹æ³•ï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿çš„è·å¾—æ¯ä¸ªå…¥å£å¯¹åº”æ•°ç»„çš„é•¿åº¦ã€‚ä»¥ä¸Šé¢ä¾‹å­ä¸­è·å–çš„groceriesByDepartmentå­—å…¸ä¸ºä¾‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> departmentCounts = groceriesByDepartment.mapValues &#123; items <span class="keyword">in</span> items.<span class="built_in">count</span> &#125;</div><div class="line"><span class="comment">// departmentCounts[.bakery] == 2</span></div></pre></td></tr></table></figure><p>å› ä¸ºå­—å…¸æœ‰ç›¸åŒçš„keyï¼Œåªæ˜¯å€¼ä¸åŒï¼Œæ‰€ä»¥å¯ä»¥ä¸éœ€è¦é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œä»è€Œä½¿å¾—è°ƒç”¨<strong>mapValues(_:)</strong>æ–¹æ³•æ¯”ä»å¤´å»ºç«‹å­—å…¸å¿«å¾ˆå¤šã€‚</p><h2 id="ä»é”®å€¼å¯¹å»ºç«‹å­—å…¸"><a href="#ä»é”®å€¼å¯¹å»ºç«‹å­—å…¸" class="headerlink" title="ä»é”®å€¼å¯¹å»ºç«‹å­—å…¸"></a>ä»é”®å€¼å¯¹å»ºç«‹å­—å…¸</h2><p>Swift4æä¾›äº†ä¸¤ç§æ–¹æ³•ç»™ç”¨æˆ·ä»é”®å€¼å¯¹åºåˆ—ç”Ÿæˆå­—å…¸ï¼Œä¸€ç§æ–¹æ³•å…è®¸keyæœ‰é‡å¤ï¼Œå¦ä¸€ç§ä¸å…è®¸ã€‚</p><p>ä½¿ç”¨<strong>zip(<em>:</em>:)</strong>å‡½æ•°å¯ä»¥å°†ä¸€äº›äº†é”®å€¼ç»„åˆèµ·æ¥ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä»£ç å°±åˆ›ç«‹äº†ä¸€ç³»åˆ—(String,GroceryItem)å…ƒç»„ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> zippedNames = <span class="built_in">zip</span>(groceries.<span class="built_in">map</span> &#123; $<span class="number">0</span>.name &#125;, groceries)</div></pre></td></tr></table></figure><p>zippedNamesçš„æ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªå…ƒç»„(tuple)ï¼Œç¬¬ä¸€é¡¹æ˜¯<strong>(â€œApplesâ€, ğŸ)</strong>.å› ä¸ºnameå€¼æ˜¯å”¯ä¸€çš„ï¼Œä¸‹é¢çš„æ–¹æ³•å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªå­—å…¸ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ä¸å…è®¸keyå€¼é‡å¤çš„æ–¹æ³•ã€‚</p><div align="center"><br><img src="https://swift.org/assets/images/dictionary-blog/uniqueKeys_2x.png" alt=""><br></div><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> groceriesByName = <span class="type">Dictionary</span>(uniqueKeysWithValues: zippedNames)</div><div class="line"><span class="comment">// groceriesByName["Apples"] == ğŸ</span></div><div class="line"><span class="comment">// groceriesByName["Kumquats"] == nil</span></div></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¦ä½¿ç”¨è¯¥æ–¹æ³•çš„å‰ææ˜¯ä½ å¯ä»¥ç¡®ä¿keyå€¼æ˜¯ä¸é‡å¤çš„ã€‚å¦åˆ™ä¼šå¼•èµ·runtime errorã€‚</p><p>å¦‚æœkeyå€¼å¯èƒ½ä¼šé‡å¤ï¼Œä½¿ç”¨å¦ä¸€ä¸ªæ–¹æ³•:<strong>Dictionary(_:uniquingKeysWith:)</strong>ã€‚è¿™ä¸ªæ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ªé—­åŒ…æ¥å¤„ç†å½“keyé‡å¤æ—¶çš„æ“ä½œã€‚é—­åŒ…çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯key(é”®)å¯¹åº”çš„old value(å€¼)ï¼Œè€Œç¬¬äºŒä¸ªå¯¹åº”çš„æ˜¯æ–°å€¼ã€‚ç”¨æˆ·å¯ä»¥åœ¨é—­åŒ…é‡Œå†™ç›¸åº”çš„é€»è¾‘ï¼Œæ¯”å¦‚æ–°å€¼æ›¿ä»£è€å€¼ï¼Œæˆ–è€…å°†æ–°è€å€¼åˆå¹¶ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> pairs = [(<span class="string">"dog"</span>, <span class="string">"ğŸ•"</span>), (<span class="string">"cat"</span>, <span class="string">"ğŸ±"</span>), (<span class="string">"dog"</span>, <span class="string">"ğŸ¶"</span>), (<span class="string">"bunny"</span>, <span class="string">"ğŸ°"</span>)]</div><div class="line"><span class="keyword">let</span> petmoji = <span class="type">Dictionary</span>(pairs,</div><div class="line">                         uniquingKeysWith: &#123; (old, new) <span class="keyword">in</span> new &#125;)</div><div class="line"><span class="comment">// petmoji["cat"] == "ğŸ±"</span></div><div class="line"><span class="comment">// petmoji["dog"] == "ğŸ¶"</span></div></pre></td></tr></table></figure><p>çœ‹ä¸Šé¢çš„ä¾‹å­ï¼Œdogå¯¹åº”äº†ä¸¤ä¸ªå€¼ã€‚å½“æ–¹æ³•å¤„ç†åˆ°(â€œdogâ€, â€œğŸ¶â€)æ—¶ï¼Œé—­åŒ…çš„å‚æ•°æ˜¯ (â€œğŸ•â€ï¼Œ â€œğŸ¶â€)ï¼Œè€Œé—­åŒ…çš„é€»è¾‘æ˜¯è¿”å›ç¬¬äºŒä¸ªå€¼ï¼Œå› æ­¤æ–°å€¼å°±ä»£æ›¿äº†è€å€¼ï¼Œæœ€ç»ˆçš„å­—å…¸ä¸­ï¼Œdogå¯¹åº”çš„å€¼å°±æ˜¯ğŸ¶ã€‚</p><h2 id="ç­›é€‰å‡ºç‰¹å®šçš„é¡¹"><a href="#ç­›é€‰å‡ºç‰¹å®šçš„é¡¹" class="headerlink" title="ç­›é€‰å‡ºç‰¹å®šçš„é¡¹"></a>ç­›é€‰å‡ºç‰¹å®šçš„é¡¹</h2><p>å­—å…¸ç°åœ¨æœ‰äº†ä¸€ä¸ª<strong>filter(_:)</strong>æ–¹æ³•ï¼Œè¿”å›å€¼æ˜¯æ»¡è¶³æ¡ä»¶çš„æ–°å­—å…¸<strong><em>(æ—©æœŸç‰ˆæœ¬çš„swiftè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„)</em></strong>ã€‚æ–¹æ³•ä¼ å…¥çš„å‚æ•°ä¾ç„¶æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå¦‚æœæŸä¸€é¡¹éœ€è¦åœ¨è¿”å›å€¼ä¸­å‡ºç°ï¼Œé—­åŒ…è¿”å›trueï¼Œå¦åˆ™è¿”å›falseã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">isOutOfStock</span><span class="params">(<span class="number">_</span> item: GroceryItem)</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">    <span class="comment">// Looks up `item` in inventory</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> outOfStock = groceriesByName.<span class="built_in">filter</span> &#123; (<span class="number">_</span>, item) <span class="keyword">in</span> isOutOfStock(item) &#125;</div><div class="line"><span class="comment">// outOfStock["Croissants"] == ğŸ¥</span></div><div class="line"><span class="comment">// outOfStock["Apples"] == nil</span></div></pre></td></tr></table></figure><p>ä¸Šä¾‹ä¸­ï¼ŒisOutOfStockå†³å®šæŸä¸€é¡¹è¯¥ä¸è¯¥å‡ºç°åœ¨è¿”å›å€¼å­—å…¸ä¸­ã€‚</p><h2 id="ä½¿ç”¨é»˜è®¤å€¼"><a href="#ä½¿ç”¨é»˜è®¤å€¼" class="headerlink" title="ä½¿ç”¨é»˜è®¤å€¼"></a>ä½¿ç”¨é»˜è®¤å€¼</h2><p>å­—å…¸ç°åœ¨æä¾›äº†ç±»ä¼¼æ•°ç»„ä¸‹æ ‡æ¥è·å–å’Œæ›´æ–°å€¼ï¼Œä¸‹é¢çš„ä»£ç å®šä¹‰äº†ä¸€ä¸ªç®€å•çš„è´­ç‰©ç¯®ï¼Œkeyæ˜¯å•†å“ï¼Œvalueæ˜¯å•†å“çš„æ•°é‡ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Begin with a single banana</span></div><div class="line"><span class="keyword">var</span> cart = [ğŸŒ: <span class="number">1</span>]</div></pre></td></tr></table></figure><p>å› ä¸ºæŸäº›keyåœ¨å­—å…¸ä¸­æ²¡æœ‰å¯¹åº”çš„å€¼ï¼Œå› æ­¤ä½ ç”¨keyå»è·å–å€¼çš„æ—¶å€™ï¼Œè¿”å›ç»“æœæ˜¯optionalçš„ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// One banana:</span></div><div class="line">cart[ğŸŒ]    <span class="comment">// Optional(1)</span></div><div class="line"><span class="comment">// But no shrimp:</span></div><div class="line">cart[ğŸ¤]    <span class="comment">// nil</span></div></pre></td></tr></table></figure><p>å¯ä»¥ä½¿ç”¨<strong>??</strong>æ“ä½œç¬¦å°†optinalå€¼æ‹†åŒ…ä¸ºçœŸå®çš„æ•°å€¼ï¼Œç°åœ¨swift4æä¾›äº†å¦ä¸€ç§è§£å†³æ–¹æ¡ˆï¼ˆè®¾ç½®é»˜è®¤å€¼ï¼‰ï¼Œå¦‚æœkeyå¯¹åº”çš„å€¼å­˜åœ¨ï¼Œé‚£ä¹ˆè¿”å›è¯¥å€¼ï¼Œå¦åˆ™è¿”å›é»˜è®¤å€¼ã€‚å¦‚æœkeyæ²¡æœ‰å¯¹åº”å€¼ï¼Œé‚£ä¹ˆè¿”å›é»˜è®¤å€¼ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Still one banana:</span></div><div class="line">cart[ğŸŒ, <span class="keyword">default</span>: <span class="number">0</span>]    <span class="comment">// 1</span></div><div class="line"><span class="comment">// And zero shrimp:</span></div><div class="line">cart[ğŸ¤, <span class="keyword">default</span>: <span class="number">0</span>]    <span class="comment">// 0</span></div></pre></td></tr></table></figure><p>ç”šè‡³ç”¨ä¸‹é¢çš„ä»£ç ç®€åŒ–å¢åŠ æ–°itemåˆ°è´­ç‰©è½¦çš„è¿‡ç¨‹ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> item <span class="keyword">in</span> [ğŸŒ, ğŸŒ, ğŸ] &#123;</div><div class="line">    cart[item, <span class="keyword">default</span>: <span class="number">0</span>] += <span class="number">1</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å½“å¾ªç¯å¤„ç†åˆ°ğŸŒæ—¶ï¼Œæ£€ç´¢åˆ°å½“å‰å€¼ï¼Œç„¶åè‡ªå¢ï¼Œæ”¾å›åˆ°åŸå­—å…¸ä¸­ã€‚å½“æ£€ç´¢åˆ°ğŸæ—¶ï¼Œå‘ç°ğŸç°åœ¨å¹¶æ²¡æœ‰å¯¹åº”å€¼ï¼Œä»è€Œè¿”å›é»˜è®¤å€¼0ï¼Œè‡ªå¢ä¸º1ï¼Œå­˜å‚¨åˆ°å­—å…¸ä¸­ï¼Œä¸‹æ¬¡æ£€ç´¢çš„æ—¶å€™å°±å˜æˆäº†1.</p><h2 id="åˆå¹¶ä¸¤ä¸ªå­—å…¸åˆ°ä¸€ä¸ªå­—å…¸ä¸­"><a href="#åˆå¹¶ä¸¤ä¸ªå­—å…¸åˆ°ä¸€ä¸ªå­—å…¸ä¸­" class="headerlink" title="åˆå¹¶ä¸¤ä¸ªå­—å…¸åˆ°ä¸€ä¸ªå­—å…¸ä¸­"></a>åˆå¹¶ä¸¤ä¸ªå­—å…¸åˆ°ä¸€ä¸ªå­—å…¸ä¸­</h2><p>å°†ä¸¤ä¸ªå­—å…¸åˆå¹¶ä¹Ÿå˜å¾—å¼‚å¸¸ç®€å•ã€‚swift4æä¾›äº†<strong>merge(_:uniquingKeysWith:)</strong>æ–¹æ³•æ¥å¤„ç†åˆå¹¶æ“ä½œã€‚å’Œä¸Šé¢ä¸€æ ·ï¼Œéœ€è¦ä¼ å…¥ä¸€ä¸ªé—­åŒ…å®Œæˆåˆå¹¶çš„é€»è¾‘ï¼Œå½“ä¸¤ä¸ªå­—å…¸æ‹¥æœ‰ç›¸åŒçš„keyå€¼æ—¶ï¼Œç”±è¯¥é—­åŒ…å¤„ç†å¦‚ä½•æ“ä½œã€‚</p><p><img src="https://swift.org/assets/images/dictionary-blog/merging_2x.png" alt=""></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> otherCart = [ğŸŒ: <span class="number">2</span>, ğŸ‡: <span class="number">3</span>]</div><div class="line">cart.merge(otherCart, uniquingKeysWith: +)</div><div class="line"><span class="comment">// cart == [ğŸŒ: 5, ğŸ‡: 3, ğŸ: 1]</span></div></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å°†ç›¸åŒkeyå¯¹åº”çš„å€¼ç›¸åŠ ä½œä¸ºæ–°å­—å…¸ä¸­çš„å€¼ã€‚</p><p>å¦‚æœä¸æƒ³åŸåœ°åˆå¹¶ï¼Œå¯ä»¥ä½¿ç”¨<strong>merging(_:uniquingKeysWith:)</strong>æ–¹æ³•ç”Ÿæˆä¸€ä¸ªæ–°å­—å…¸ã€‚</p><h2 id="And-Thatâ€™s-Not-Allâ€¦"><a href="#And-Thatâ€™s-Not-Allâ€¦" class="headerlink" title="And Thatâ€™s Not Allâ€¦"></a>And Thatâ€™s Not Allâ€¦</h2><p>ä¸Šé¢ä»‹ç»çš„æ–°ç‰¹æ€§å¹¶ä¸æ˜¯å…¨éƒ¨ï¼Œé™äºç¯‡å¹…ï¼Œå¹¶æ²¡æœ‰å®Œå…¨ä»‹ç»å…¨ã€‚</p><p>å’Œå­—å…¸ä¸€æ ·ï¼Œé›†åˆä¹Ÿæ‹¥æœ‰äº†æ–°çš„<strong>filter(_:) </strong>æ–¹æ³•ï¼Œè¿”å›çš„ä¹Ÿæ˜¯é›†åˆï¼Œè€Œä¸æ˜¯æ—©èµ·ç‰ˆæœ¬ä¸­çš„æ•°ç»„ã€‚å­—å…¸å’Œé›†åˆç°åœ¨æä¾›äº†æš´æ¼ç°åœ¨capacityçš„æ–¹æ³•:<strong>reserveCapacity(_:)</strong>ï¼Œæœ‰äº†è¯¥æ–¹æ³•ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°å¹¶æ§åˆ¶ä»–ä»¬çš„å†…éƒ¨å­˜å‚¨ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p>æœ¬æ–‡è¯‘è‡ªï¼š<a href="https://swift.org/blog/dictionary-and-set-improvements/" target="_blank" rel="external">https://swift.org/blog/dictionary-and-set-improvements/</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—æ›´å¥½&quot;&gt;&lt;a href=&quot;#Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—æ›´å¥½&quot; class=&quot;headerlink&quot; title=&quot;Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—æ›´å¥½&quot;&gt;&lt;/a&gt;Swift4ä¸­çš„å­—å…¸å’Œé›†åˆåœ¨è¿™äº›æ–¹é¢å˜å¾—
      
    
    </summary>
    
      <category term="è‹¹æœå¼€å‘" scheme="http://zhihaozhang.github.io/categories/%E8%8B%B9%E6%9E%9C%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="swift" scheme="http://zhihaozhang.github.io/tags/swift/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºSVGä¸­å¤§å°å¯å˜çš„&lt;g&gt;å…ƒç´ åŠ ä¸Šè¾¹æ¡†å’ŒèƒŒæ™¯è‰²</title>
    <link href="http://zhihaozhang.github.io/2017/10/11/gInSVG/"/>
    <id>http://zhihaozhang.github.io/2017/10/11/gInSVG/</id>
    <published>2017-10-11T13:11:38.258Z</published>
    <updated>2017-10-11T13:12:12.755Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜çš„å‡ºç°"><a href="#é—®é¢˜çš„å‡ºç°" class="headerlink" title="é—®é¢˜çš„å‡ºç°"></a>é—®é¢˜çš„å‡ºç°</h1><p>æˆ‘åœ¨ä½¿ç”¨d3jså¼€å‘é¡¹ç›®è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†è¿™æ ·çš„éœ€æ±‚ï¼Œå°†é¼ æ ‡hoveråˆ°æŸäº›å…ƒç´ ä¸Šæ—¶ï¼Œå°†è¯¥å…ƒç´ çš„detailä¿¡æ¯<strong>é€æ¡å±•ç¤º</strong>å‡ºæ¥ï¼Œè€Œä¸”ä¸ºäº†å°†detailæ¡†ä¸å…¶ä»–å…ƒç´ åŒºåˆ«å¼€æ¥ï¼Œéœ€è¦ç»™detailå±•ç¤ºåŒºåŸŸæ·»åŠ è¾¹æ¡†æˆ–å¢åŠ åº•è‰²ï¼Œæƒ³è¦çš„æ•ˆæœå¤§æ¦‚æ˜¯ä¸‹é¢çš„å›¾é‚£æ ·çš„ã€‚</p><div align="center"><br><img src="https://ip.freep.cn/588778/screen.png" alt=""><br>é¢„æœŸæ•ˆæœå›¾<br></div><h1 id="é—®é¢˜è§£å†³æ€è·¯"><a href="#é—®é¢˜è§£å†³æ€è·¯" class="headerlink" title="é—®é¢˜è§£å†³æ€è·¯"></a>é—®é¢˜è§£å†³æ€è·¯</h1><p>æ™®é€šçš„HTMLå…ƒç´ æœ‰å¾ˆå¤šæ–¹æ³•æ¥è·å¾—å…¶å®½é«˜ç­‰å…¶ä»–ä½ç½®å±æ€§çš„æ–¹æ³•ã€‚å¦‚æœæ˜¯ä¸€ç»„å…ƒç´ ï¼Œå¯ä»¥ç”¨divæ ‡ç­¾å°†ä»–ä»¬ç»„åˆèµ·æ¥ï¼ŒæŒ‡å®šdivçš„borderé¢œè‰²å’Œå®½åº¦ï¼Œdivçš„è¾¹æ¡†ä¼šæ ¹æ®å…ƒç´ çš„å®½é«˜åŠ¨æ€æ”¹å˜å¤§å°ã€‚</p><p>SVGä¸­ï¼Œå°†å…ƒç´ æˆç»„çš„æ ‡ç­¾æ˜¯gå…ƒç´ ï¼Œä¹‹å‰ä½¿ç”¨å®ƒæ˜¯å°†å…ƒç´ è¿›è¡Œåˆ†ç»„ï¼Œç„¶åç»Ÿä¸€è¿›è¡Œå¹³ç§»å’Œæ—‹è½¬ä¹‹ç±»çš„åŠŸèƒ½å˜æ¢ã€‚æ¯«æ— æ„å¤–çš„ï¼Œæ™®é€šDOMå…ƒç´ è·å–å®½é«˜å’Œä½ç½®å±æ€§çš„æ–¹æ³•offsetWidthã€ClientWidthå…¨éƒ¨å¤±æ•ˆï¼Œè¿”å›å€¼å‡ä¸º<strong>undefined</strong>ã€‚æˆ‘çš„åˆæ­¥æƒ³æ³•æ˜¯è·å¾—è¿™äº›å…ƒç´ ï¼Œç„¶åç»˜åˆ¶çŸ©å½¢ï¼Œè¿™æ ·å°±æœ‰äº†ç±»ä¼¼divçš„è¾¹æ¡†æ•ˆæœã€‚</p><p>åœ¨Stack Overflowä¸­ï¼Œæ‰¾åˆ°äº†é—®é¢˜çš„ç­”æ¡ˆï¼Œæœ‰ä¸¤ä¸ªåŸç”Ÿçš„JSæ–¹æ³•å¯ä»¥ä½œä¸ºå€™é€‰ã€‚</p><h2 id="getBBox"><a href="#getBBox" class="headerlink" title="getBBox"></a>getBBox</h2><p>document.getElementById(â€œg1â€).getBBox()çš„è¿”å›ç»“æœå¦‚ä¸‹ï¼š</p><div align="center"><br><img src="http://youdaocloud.oss-cn-shanghai.aliyuncs.com/SVG_g_width.4.PNG" alt=""><br>getBBoxè¿”å›å€¼<br></div><h2 id="getBoundingClientRect"><a href="#getBoundingClientRect" class="headerlink" title="getBoundingClientRect()"></a>getBoundingClientRect()</h2><p>è€Œdocument.getElementById(â€œg1â€).getBoundingClientRect()çš„è¿”å›ç»“æœå¦‚ä¸‹ï¼š</p><div align="center"><br><img src="http://youdaocloud.oss-cn-shanghai.aliyuncs.com/SVG_g_width.5.PNG" alt=""><br>getBoundingClientRectè¿”å›å€¼<br></div><h2 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h2><p>å‘ç°ä¸¤ä¸ªæ–¹æ³•çš„è¿”å›ç»“æœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸»è¦æ˜¯å› ä¸ºgetBBox()è·å¾—çš„æ˜¯å…ƒç´ åœ¨å½“å‰SVGåæ ‡ä¸­çš„æ•°æ®ï¼Œè€ŒgetBoundingClientRect()åˆ™æ˜¯æµè§ˆå™¨çš„åæ ‡ã€‚<br>æ˜¾ç„¶ï¼ŒgetBBox()æ–¹æ³•æ›´è´´åˆæˆ‘ä»¬çš„éœ€æ±‚ã€‚</p><h1 id="æ·»åŠ èƒŒæ™¯è‰²"><a href="#æ·»åŠ èƒŒæ™¯è‰²" class="headerlink" title="æ·»åŠ èƒŒæ™¯è‰²"></a>æ·»åŠ èƒŒæ™¯è‰²</h1><p>getBBoxæ–¹æ³•å¯ä»¥è®©æˆ‘ä»¬çŸ¥é“çŸ©å½¢è¯¥å¦‚ä½•ç»˜åˆ¶ï¼Œå¦‚æœè®©çŸ©å½¢fill noneçš„è¯ï¼Œæ˜¯å¯ä»¥çœ‹åˆ°åº•å±‚çš„æ–‡å­—çš„ï¼Œä½†è®¾è®¡å¸ˆæ¯”è¾ƒæ‰§æ‹—ï¼Œæ­»ç£•æˆ‘éœ€è¦èƒŒæ™¯è‰²ã€‚è€Œæ­£ç¡®è·å–çŸ©å½¢ä½ç½®å¤§å°æ˜¯éœ€è¦å…ˆå°†detailä¿¡æ¯ç»˜åˆ¶åˆ°svgç”»æ¿ä¸Šçš„ï¼Œå› æ­¤åé¢å†ç»˜åˆ¶çŸ©å½¢çš„æ—¶å€™ï¼ŒçŸ©å½¢å°±ç›–ä½äº†åº•å±‚çš„detailä¿¡æ¯æ–‡å­—ã€‚</p><p>å¯¹äºè¿™ä¸ªå…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹çš„é—®é¢˜ï¼Œæˆ‘é‡‡å–äº†ä¸€ä¸ªæ¯”è¾ƒtrickyçš„æ–¹æ³•ï¼Œå³åœ¨ç»˜åˆ¶å®ŒçŸ©å½¢ä¹‹åï¼Œå†ç»˜åˆ¶ä¸€édeatilä¿¡æ¯ï¼Œè¿™æ ·åç»˜åˆ¶çš„detailä¿¡æ¯å°±å¤„åœ¨äº†çŸ©å½¢çš„ä¸Šå±‚ï¼Œä»è€Œå¯ä»¥è¢«ç”¨æˆ·çœ‹åˆ°ï¼Œè€Œåº•å±‚çš„detailä¿¡æ¯å®é™…ä¸Šæ˜¯å­˜åœ¨çš„ï¼Œåªä¸è¿‡æ˜¯è¢«çŸ©å½¢è¿™é®æŒ¡ä½äº†ã€‚</p><p>ç»™è®¾è®¡å¸ˆçœ‹è¿‡æ•ˆæœä¹‹åï¼Œä»–éœ²å‡ºäº†æ»¡æ„çš„å¾®ç¬‘â˜ºã€‚</p><p>ä»£ç </p><pre><code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawDeatilBorder</span>(<span class="params">data</span>)</span>&#123;</div><div class="line"></div><div class="line">           vis.selectAll(<span class="string">'.detailBorder'</span>).remove();</div><div class="line"></div><div class="line">           <span class="keyword">var</span> position = <span class="built_in">document</span>.getElementById(<span class="string">"detailInfoBorder"</span>).getBBox();</div><div class="line"></div><div class="line">           vis.append(<span class="string">'rect'</span>).attr(<span class="string">'class'</span>,<span class="string">'detailBorder'</span>).style(<span class="string">'fill'</span>,<span class="string">'#f0f0f0'</span>).attr(<span class="string">'x'</span>,position.x<span class="number">-20</span>).attr(<span class="string">'y'</span>,position.y<span class="number">-20</span>).attr(<span class="string">'width'</span>,position.width+<span class="number">40</span>)</div><div class="line">               .attr(<span class="string">'height'</span>,position.height+<span class="number">40</span>).attr(<span class="string">'fill'</span>,<span class="string">'red'</span>).attr(<span class="string">'rx'</span>,<span class="string">'3px'</span>).attr(<span class="string">'ry'</span>,<span class="string">'3px'</span>).attr(<span class="string">'stroke'</span>,<span class="string">'none'</span>);</div><div class="line"></div><div class="line">           <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line">           <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> data) &#123;</div><div class="line"></div><div class="line">               <span class="keyword">if</span> (<span class="keyword">typeof</span>(data[key]) !== <span class="string">"object"</span>) &#123;</div><div class="line">                   i++;</div><div class="line">                   vis.append(<span class="string">"text"</span>).attr(<span class="string">'class'</span>, <span class="string">'detailInfo'</span>).attr(<span class="string">"x"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                       <span class="keyword">return</span> <span class="number">850</span></div><div class="line">                   &#125;).attr(<span class="string">"y"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                       <span class="keyword">return</span> i * <span class="number">20</span> + <span class="number">30</span>;</div><div class="line">                   &#125;).attr(<span class="string">"dy"</span>, <span class="string">".35em"</span>).attr(<span class="string">"text-anchor"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                       <span class="keyword">return</span> <span class="string">"start"</span>;</div><div class="line">                   &#125;).text(<span class="function"><span class="keyword">function</span> (<span class="params">d</span>) </span>&#123;</div><div class="line">                       <span class="keyword">return</span> key + <span class="string">" : "</span> + data[key];</div><div class="line">                   &#125;)</div><div class="line">                       .style(<span class="string">"fill-opacity"</span>, <span class="number">1</span>);</div><div class="line">               &#125;</div><div class="line">           &#125;</div><div class="line"></div><div class="line">       &#125;</div></pre></td></tr></table></figure></code></pre><p><a href="https://github.com/zhihaozhang/Topology" target="_blank" rel="external">é¡¹ç›®å¼€æºåœ°å€</a>,ä¾›å‚è€ƒã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;é—®é¢˜çš„å‡ºç°&quot;&gt;&lt;a href=&quot;#é—®é¢˜çš„å‡ºç°&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜çš„å‡ºç°&quot;&gt;&lt;/a&gt;é—®é¢˜çš„å‡ºç°&lt;/h1&gt;&lt;p&gt;æˆ‘åœ¨ä½¿ç”¨d3jså¼€å‘é¡¹ç›®è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°äº†è¿™æ ·çš„éœ€æ±‚ï¼Œå°†é¼ æ ‡hoveråˆ°æŸäº›å…ƒç´ ä¸Šæ—¶ï¼Œå°†è¯¥å…ƒç´ çš„detailä¿¡æ¯&lt;str
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="SVG" scheme="http://zhihaozhang.github.io/tags/SVG/"/>
    
  </entry>
  
  <entry>
    <title>mouseSyncåç»­åŠŸèƒ½å®Œå–„å¿ƒå¾—</title>
    <link href="http://zhihaozhang.github.io/2017/09/29/mouseSyncII/"/>
    <id>http://zhihaozhang.github.io/2017/09/29/mouseSyncII/</id>
    <published>2017-09-29T13:26:44.235Z</published>
    <updated>2017-09-30T02:39:00.704Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>åœ¨<a href="http://zhihaozhang.github.io/2017/09/23/è®©iMacä¸MacBooké«˜æ•ˆååŒå·¥ä½œâ€”â€”mouseSyncå¼€å‘å¿ƒå¾—/">ä¸Šç¯‡åšå®¢</a>ä¸­,æˆ‘ä»‹ç»äº†mouseSyncè¿™æ¬¾è½¯ä»¶çš„å¼€å‘åˆè¡·ã€ä½¿ç”¨åœºæ™¯å’Œå¼€å‘çš„è¿‡ç¨‹ï¼Œæ„Ÿè°¢ä¸€äº›æœ‹å‹è¯•ç”¨è¯¥è½¯ä»¶å¹¶ç»™æˆ‘ç•™è¨€ï¼Œæå‡ºäº†ä¸€äº›æ–°çš„éœ€æ±‚å’Œissueã€‚åŒæ—¶ä¹Ÿæ„Ÿè°¢å¼€å‘è€…å¤´æ¡çš„æ¨èè‡³å¤´ç‰ˆçš„ç²¾é€‰æ¿å—ï¼Œè®©é‚£ç¯‡å¼€å‘ç¬”è®°è¢«2ä¸‡å¼€å‘è€…é˜…è¯»è¿‡äº†ï¼Œæ”¶è·äº†<strong>githubçš„star</strong>è‹¥å¹²ã€<strong>å…¬ä¼—å·çš„å…³æ³¨</strong>è‹¥å¹²ã€èµèµçº¦<strong>50å…ƒ</strong>ã€‚çœŸçš„éå¸¸æ„Ÿè°¢å¤§å®¶çš„å…³æ³¨ã€staré¼“åŠ±å’Œé‡‘é’±èµèµã€‚</p><p>æˆ‘æ•´ç†äº†ä¸€ä¸‹å¤§å®¶çš„éœ€æ±‚ï¼Œå¤§ä½“ä¸Šå¯å½’çº³ä¸º3ç±»ã€‚</p><ol><li>æ²¡æœ‰logo</li><li>åœ¨å¤–éƒ¨è®¾å¤‡(é¼ æ ‡/TrackpadçœŸæ­£å±äºçš„é‚£å°Mac)ä¸Šå®¹æ˜“å¼•èµ·è¯¯æ“ä½œ</li><li>ä¸€ä¸ªå…³é”®çš„åŠŸèƒ½ï¼Œå·¦é”®æ‹–æ‹½åŠŸèƒ½ï¼Œæ²¡æœ‰å®ç°</li></ol><p>åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘å°±æ¥å†™ä¸€ä¸‹å¯¹ä¸Šé¢æåˆ°çš„ä¸‰ä¸ªéœ€æ±‚çš„è§£å†³æ–¹æ¡ˆã€‚å®Œæˆä¸Šè¿°ä¸‰ä¸ªéœ€æ±‚åçš„è½¯ä»¶åœ¨<a href="https://pan.baidu.com/s/1i5Gee6T" target="_blank" rel="external">ç½‘ç›˜</a>å¯ä¸‹è½½åˆ°ï¼Œæœ€æ–°ä»£ç ä¾ç„¶å¼€æºåœ¨<a href="https://github.com/zhihaozhang/mouseSync" target="_blank" rel="external">github</a>ä¸Šã€‚</p><h1 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h1><h2 id="æ²¡æœ‰logo"><a href="#æ²¡æœ‰logo" class="headerlink" title="æ²¡æœ‰logo"></a>æ²¡æœ‰logo</h2><p>å…¶å®è¿™ä»¶äº‹æŒºå°´å°¬çš„ï¼Œæˆ‘ä¸æ˜¯è®¾è®¡å¸ˆï¼Œå› æ­¤å¹³æ—¶logoçš„ä¸»è¦æ¥æºæ˜¯<a href="https://www.flaticon.com" target="_blank" rel="external">flaticon</a>ï¼Œè¿™æ¬¡æ²¡å¿å¿ƒæ‰“æ‰°æ­£åœ¨ç†Ÿç¡çš„éè‘—åè®¾è®¡å¸ˆJosephï¼Œå› æ­¤è¿˜æ˜¯åœ¨flaticonä¸Šæ‰¾çš„iconï¼Œè¿›è¡Œäº†ç®€å•çš„é¢œè‰²å˜æ¢ä¸ç»„åˆã€‚</p><p>iconè€ƒè™‘åˆ°äº†mouseSyncå…·æœ‰é¼ æ ‡å’Œè“ç‰™çš„ç‰¹æ€§ï¼Œå› æ­¤è¿˜æ˜¯æ¯”è¾ƒå†™å®çš„ã€‚è€ƒè™‘åˆ°è“ç‰™å®¢æˆ·ç«¯æœ‰å¤–éƒ¨è®¾å¤‡å’Œæ•°æ®ä¸­å¿ƒ(ä¸¤å°Mac)ä¹‹åˆ†ï¼Œå› æ­¤ä¸¤ä¸ªiconè™½ç„¶å¾ˆç›¸ä¼¼ï¼Œä½†ä»æœ‰ç»†å¾®çš„ä¸åŒã€‚ä¸åŒç‚¹åœ¨äºï¼Œæ•°æ®ä¸­å¿ƒçš„iconå¤šäº†ä¸€ä¸ªç±»ä¼¼ä¿¡å·æŒ‡ç¤ºçš„æ ‡å¿—ï¼Œè¡¨ç¤ºå®ƒæ˜¯æ¥æ”¶è“ç‰™ä¿¡å·çš„ä¸€ç«¯ã€‚</p><p>ç”±äºæœ¬äººè®¾è®¡æ–¹é¢å®åœ¨ä¸šä½™ï¼Œè¿˜è¯·å¤§å®¶è½»å–·ã€‚æœ‰ç©ºå†æ‰¾éè‘—åè®¾è®¡å¸ˆJosephå®ç°ä¸€æšæ¼‚äº®çš„logoã€‚</p><div align="center"><br><img src="https://syy.freep.cn/588778/icons.png" alt=""><br>&gt; icons<br></div><h2 id="åœ¨å¤–éƒ¨è®¾å¤‡ç«¯å®¹æ˜“å¼•èµ·è¯¯æ“ä½œ"><a href="#åœ¨å¤–éƒ¨è®¾å¤‡ç«¯å®¹æ˜“å¼•èµ·è¯¯æ“ä½œ" class="headerlink" title="åœ¨å¤–éƒ¨è®¾å¤‡ç«¯å®¹æ˜“å¼•èµ·è¯¯æ“ä½œ"></a>åœ¨å¤–éƒ¨è®¾å¤‡ç«¯å®¹æ˜“å¼•èµ·è¯¯æ“ä½œ</h2><p>ä¹‹å‰çš„demoè§†é¢‘ä¸­ï¼Œä¸ºäº†è®©ä¸¤å°ç”µè„‘çœ‹èµ·æ¥ä¸€è‡´ï¼Œæˆ‘å½•çš„æ˜¯åŒæ—¶æ‰“å¼€æ–‡ä»¶ï¼ŒåŒæ—¶åœ¨å›¾æ ‡ä¸Šå³å‡»ï¼Œåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œåœ¨åŒä¸€æ—¶åˆ»åŒæ—¶æ“ä½œä¸¤å°Macçš„éœ€æ±‚å¾ˆå°‘ä¸å­˜åœ¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·è¿˜æ˜¯æƒ³å¯¹æŸä¸€å°Macè¿›è¡Œæ“ä½œçš„ã€‚<strong>mouseSyncçš„å®šä½åº”è¯¥æ˜¯ï¼šå¸®åŠ©ç”¨æˆ·ç”¨ä¸€ä¸ªé¼ æ ‡æ“ä½œä¸¤å°ç”µè„‘ï¼Œä¸”ç»™ç”¨æˆ·å†³å®šä»€ä¹ˆæ—¶å€™æ“ä½œå“ªå°ï¼Œçœå»ä¸¤ä¸ªé¼ æ ‡ä¹‹é—´æ¢æ¥æ¢å»çš„éº»çƒ¦ã€‚</strong></p><p>ä¹‹å‰çš„é¡¹ç›®ä¸­ï¼Œæˆ‘å¯¹é¼ æ ‡äº‹ä»¶æ·»åŠ çš„å‡æ˜¯å…¨å±€ç›‘æ§äº‹ä»¶ï¼Œå› æ­¤åªè¦mouseSync<strong>ç”Ÿå‘½å‘¨æœŸ</strong>æ²¡æœ‰ç»“æŸï¼Œå®ƒçš„æ“ä½œå°†å®æ—¶è¢«å‘é€åˆ°å¦ä¸€å°macä¸Šã€‚æˆ‘æƒ³è¿‡ä¸¤ä¸ªè§£å†³æ–¹æ¡ˆï¼š</p><ol><li>è·Ÿå…¶ä»–å…±äº«é”®ç›˜çš„è½¯ä»¶ä¸€æ ·ï¼Œä½¿ç”¨å…¨å±€å¿«æ·é”®å¯¹è“ç‰™é€šçŸ¥æœåŠ¡è¿›è¡Œå¼€å¯/å…³é—­</li><li>å°†å…¨å±€ç›‘æ§äº‹ä»¶å˜æˆå±€éƒ¨ç›‘æ§äº‹ä»¶ï¼Œè“ç‰™é€šçŸ¥æœåŠ¡ä»…åœ¨åº”ç”¨è§†å›¾ä¸ºKeywindowæ—¶æœ‰æ•ˆ</li></ol><h3 id="ä¸ºä»€ä¹ˆé€‰æ‹©Plan-B"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©Plan-B" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©Plan B"></a>ä¸ºä»€ä¹ˆé€‰æ‹©Plan B</h3><p>å…³äºæ–¹æ¡ˆ1ï¼Œæˆ‘è§‰å¾—ä½œä¸ºä¸€æ¬¾è½¯ä»¶ï¼Œå¿«æ·é”®åº”å½“ç”±ç”¨æˆ·è‡ªå·±å†³å®šï¼Œè™½ç„¶cocoapodä¸Šå·²ç»æœ‰éå¸¸å¥½çš„é¡¹ç›®<a href="https://github.com/Clipy/KeyHolder" target="_blank" rel="external">KeyHolder</a>è¿›è¡Œæ”¯æŒ,ä½†æ˜¯è€ƒè™‘åˆ°ä¸¤ä¸ªå› ç´ è¿˜æ˜¯å†³å®šä½¿ç”¨Plan Bã€‚</p><p>å…ˆçœ‹çœ‹Plan Bï¼ŒPlan Bæ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆè®©å½“å‰çš„windowå…¨å±ï¼Œä½†æ˜¯é‡Œé¢æ²¡æœ‰å†…å®¹ï¼Œå› æ­¤æ— è®ºåœ¨å½“å‰è¯•å›¾ä¸‹å¦‚ä½•æ“ä½œï¼Œéƒ½ä¸ä¼šæœ‰å¯èƒ½é€ æˆè¯¯æ“ä½œã€‚å›åˆ°Plan Aï¼Œå¿«æ·é”®çš„å½•å…¥æ”¾åˆ°å“ªé‡Œå‘¢ï¼Ÿå¦‚æœæ”¾åˆ°å½“å‰è§†å›¾ï¼Œå°†ä¼šå¸¦æ¥ä¸€å®šçš„è¯¯æ“ä½œé£é™©ï¼›å¦‚æœæ”¾åˆ°MenuBarï¼Œé‚£ä¹ˆç”¨æˆ·å°†ä¸å¾—ä¸é€€å‡ºå…¨å±æ¨¡å¼ï¼Œåˆ°èœå•æ è¿›è¡Œè®¾ç½®ï¼Œè¿™æ ·çš„è§£å†³æ–¹æ¡ˆç ´åäº†ç”¨æˆ·ä½“éªŒï¼Œç»¼åˆè€ƒè™‘ï¼Œæœ€ç»ˆè¿˜æ˜¯é€‰äº†Plan Bã€‚</p><h3 id="å®ç°è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜"><a href="#å®ç°è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å®ç°è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜"></a>å®ç°è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜</h3><p>è®©å½“å‰çª—å£ä¸€æ‰“å¼€å°±å…¨å±çš„æ–¹æ³•æ˜¯åœ¨ViewDidLoadæ–¹æ³•ä½“ä¸­è¿›è¡Œæ§åˆ¶çš„:</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</div><div class="line"><span class="keyword">super</span>.viewDidLoad()</div><div class="line"><span class="keyword">self</span>.view.window?.zoom(<span class="keyword">self</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä½†æ˜¯æˆ‘å¾ˆå¿«å°±å‘ç°äº†é—®é¢˜ï¼š<strong>å°½ç®¡å·²ç»å°†åº”ç”¨å…¨å±äº†ï¼Œä½†æ˜¯ç”¨æˆ·ä¾ç„¶ä¼šæœ‰ä¸€å®šå‡ ç‡å¯¹dockæ å’Œé¡¶éƒ¨èœå•æ è¿›è¡Œè¯¯æ“ä½œã€‚</strong>ç”¨æˆ·å¦‚æœåœ¨æ“ä½œå¦ä¸€å°ç”µè„‘çš„æ—¶å€™ï¼Œè¿˜å¾—æ³¨æ„è¿™å°ç”µè„‘ä¸Šæ˜¯ä¸æ˜¯è¯¯æ“ä½œäº†ï¼Œè¿™ä¸ç¬¦åˆæˆ‘ä»¬è½¯ä»¶å¼€å‘çš„åˆè¡·ã€‚è€ƒè™‘åˆ°æœ‰äº›ç”¨æˆ·å°†dockæ”¾åœ¨åº•éƒ¨ï¼Œæœ‰äº›ç”¨æˆ·å°†dockæ”¾åœ¨å·¦è¾¹ï¼Œå› æ­¤ï¼Œæˆ‘åŠ äº†è¿™æ ·çš„é™åˆ¶ï¼Œå½“ç”¨æˆ·å°†é¼ æ ‡ç§»åŠ¨åˆ°è·ç¦»å±å¹•è¾¹ç¼˜<strong>50px</strong>ä»¥å†…çš„æ—¶å€™ï¼Œç¨‹åºå¸®åŠ©ä»–å°†é¼ æ ‡ç§»åŠ¨è‡³å±å¹•ä¸­å¤®ã€‚å‚ç…§ä¸‹å›¾ï¼Œç°è‰²åœ°å¸¦å°±å¯ä»¥ä½œä¸ºé˜²æ­¢é¼ æ ‡è¯¯æ“ä½œçš„ç¼“å†²åŒºã€‚</p><div align="center"><br><img src="https://syy.freep.cn/588778/border.png" alt=""><br>&gt; é˜²æ­¢å¯¹dockå’Œèœå•æ è¯¯æ“ä½œè§£å†³æ–¹æ³•ç¤ºæ„å›¾<br></div><p>é˜…è¯»è¿‡ä¸Šä¸€ç¯‡åšå®¢çš„æœ‹å‹ä¸€å®šæ³¨æ„åˆ°äº†ï¼Œæˆ‘ä»¬çš„ç¨‹åºæ˜¯è®°å½•ä¸Šä¸€ä¸ªé¼ æ ‡ç‚¹çš„ä½ç½®ï¼Œå¹¶å°†ä¸Šä¸€ä¸ªé¼ æ ‡ç‚¹çš„ä½ç½®ä¸å½“å‰ä½ç½®ç›¸å‡ï¼Œå°†ä½ç½®å˜åŠ¨ä½œä¸ºç‰¹å¾å€¼è¿›è¡Œå‘é€ã€‚å› æ­¤ï¼Œåœ¨é¼ æ ‡è¢«ç¨‹åºç§»åŠ¨åˆ°å±å¹•ä¸­å¤®çš„æ—¶å€™ï¼Œéœ€è¦å°†ä¸Šä¸€ä¸ªä½ç½®æ›´æ–°ä¸ºå±å¹•ä¸­å¤®çš„åæ ‡ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å±å¹•å®½é«˜çš„è·å–æ–¹å¼</span></div><div class="line">    <span class="keyword">let</span> <span class="type">SCREEN_WIDTH</span> = <span class="type">NSScreen</span>.main()!.frame.width</div><div class="line">    <span class="keyword">let</span> <span class="type">SCREEN_HEIGHT</span> = <span class="type">NSScreen</span>.main()!.frame.height</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="å·¦é”®æ‹–æ‹½åŠŸèƒ½"><a href="#å·¦é”®æ‹–æ‹½åŠŸèƒ½" class="headerlink" title="å·¦é”®æ‹–æ‹½åŠŸèƒ½"></a>å·¦é”®æ‹–æ‹½åŠŸèƒ½</h2><p>å·¦é”®æ‹–ä¸€ä¸ªæ–‡ä»¶æˆ–çª—å£åˆ°ä¸€ä¸ªæ–°ä½ç½®è¿™ä¸ªåŠŸèƒ½è¿˜æ˜¯ç»å¸¸è¢«ä½¿ç”¨åˆ°çš„ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯Trackpadï¼Œé€šå¸¸æ˜¯ä½¿ç”¨<strong>ä¸‰æ”¯æ‹–ç§»</strong>ã€‚æƒ³è¦ç›‘å¬å¤–å›´è®¾å¤‡çš„è¿™ä¸ªåŠ¨ä½œå¹¶ä¸éš¾ï¼Œä½†æ˜¯æƒ³è®©è®¡ç®—æœºæ¨¡æ‹Ÿè¿™ä¸ªæ“ä½œç›¸å¯¹æ¯”è¾ƒå›°éš¾ã€‚å°±åƒåŒå‡»ä¸æ˜¯å•çº¯çš„æ¨¡æ‹Ÿå•å‡»äº‹ä»¶ä¸¤æ¬¡ä¸€æ ·ï¼Œè¿™æ¬¡æˆ‘åˆè¸©åˆ°å‘äº†ï¼Œdrag and moveäº‹ä»¶å¹¶ä¸æ˜¯ç®€å•çš„mousedown-&gt; mousemove -&gt; mouseupè¿™ä¹ˆå®¹æ˜“çš„äº‹æƒ…ã€‚</p><p>æˆ‘åœ¨<a href="https://stackoverflow.com/questions/1817628/clicking-the-mouse-down-to-drag-objects-on-mac" target="_blank" rel="external">Stack Overflow</a>ä¸Šæ‰¾åˆ°äº†æ­£ç¡®çš„æ–¹æ³•ï¼šæœ‰ä¸€ä¸ªå«<strong>kCGEventLeftMouseDragged</strong>çš„äº‹ä»¶ï¼Œä¸“é—¨æ¥å¤„ç†è¿™ä»¶äº‹ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">mouse_left_drag_to</span><span class="params">(<span class="keyword">float</span> x, <span class="keyword">float</span> y)</span> </span>&#123;</div><div class="line">    CGEventRef left_drag_event = CGEventCreateMouseEvent(<span class="literal">NULL</span>, kCGEventLeftMouseDragged, CGPointMake(x, y), <span class="number">0</span>);</div><div class="line"></div><div class="line">    CGEventPost(kCGHIDEventTap, left_drag_event);</div><div class="line">    CFRelease(left_drag_event);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å’ŒScrollæ»šè½®äº‹ä»¶ä¸€æ ·ï¼Œè¿™é‡Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯Quartzæ¨¡æ‹Ÿé¼ æ ‡äº‹ä»¶,å› æ­¤ä¾ç„¶éœ€è¦Cä¸swiftè¿›è¡Œæ··ç¼–ã€‚æ¨¡æ‹Ÿæ€»å…±å¯åˆ†ä¸º3æ­¥ï¼šç¬¬ä¸€æ­¥æ˜¯åˆ›å»ºä¸€ä¸ªQuartzé¼ æ ‡äº‹ä»¶ï¼›ç¬¬äºŒæ­¥æ˜¯å°†è¿™ä¸ªäº‹ä»¶æ”¾åˆ°äº‹ä»¶æµä¸­ï¼Œå¹¶æŒ‡å®šä½ç½®ï¼›ç¬¬ä¸‰æ­¥æ˜¯releaseè¿™ä¸ªäº‹ä»¶ã€‚</p><p>æ¨¡æ‹Ÿè¿™ä¸ªäº‹ä»¶çš„æ—¶å€™ï¼Œéšç€é¼ æ ‡æ‹–æ‹½åçš„ä¸åœç§»åŠ¨ï¼Œä¼šä¸åœäº§ç”Ÿeventï¼Œè€Œä¸”eventä¸­xå’Œyçš„åç§»é‡å§‹ç»ˆæ˜¯ç›¸å¯¹äºç¬¬ä¸€æ¬¡é¼ æ ‡dragæŒ‰ä¸‹æ—¶çš„åæ ‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦è®°å½•ä¸¤ä»¶äº‹ï¼Œç¬¬ä¸€ä»¶äº‹æ˜¯ç¬¬ä¸€æ¬¡dragæ—¶å€™çš„åæ ‡ï¼Œç¬¬äºŒä»¶äº‹æ˜¯å½“å‰æ˜¯ä¸æ˜¯å¼€å¯äº†æ–°ä¸€è½®çš„dragè¿˜æ˜¯ä»ç„¶åœ¨ä¸Šä¸€è½®çš„dragä¸­ã€‚æ ¸å¿ƒä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> dragFirst == <span class="literal">true</span>&#123;</div><div class="line">dragFirst = <span class="literal">false</span></div><div class="line">    mouseLocBeforeDrag = <span class="type">NSEvent</span>.mouseLocation()                 mouseLocBeforeDrag.y = <span class="type">NSHeight</span>(<span class="type">NSScreen</span>.screens()![<span class="number">0</span>].frame) - mouseLocBeforeDrag.y;</div><div class="line">    </div><div class="line">    mouse_left_drag_to(<span class="type">Float</span>(mouseLocBeforeDrag.x)+<span class="type">Float</span>(dx!),<span class="type">Float</span>(mouseLocBeforeDrag.y)-<span class="type">Float</span>(dy!)</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">    mouse_left_drag_to(<span class="type">Float</span>(mouseLocBeforeDrag.x)+<span class="type">Float</span>(dx!),<span class="type">Float</span>(mouseLocBeforeDrag.y)-<span class="type">Float</span>(dy!))</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç æœ‰ä¸¤å¤„éœ€è¦æ³¨æ„ï¼š</p><ol><li>dragFirståˆå§‹å€¼ä¸ºtrue,åœ¨mouseUpä¹‹åé‡æ–°ç½®ä¸ºtrueï¼Œè¡¨ç¤ºä¸€è½®çš„dragå·²ç»å®Œæˆäº†ï¼›</li><li>yçš„åæ ‡æ˜¯-ï¼Œxçš„åæ ‡æ˜¯+ï¼Œè¿™æ˜¯ç”±OS Xçš„åæ ‡ç³»å†³å®šçš„ã€‚</li></ol><p>æœ€åï¼Œæˆ‘ç”¨ä¸¤å°ç”µè„‘åŒæ—¶åœ¨ç”»æ¿ä¸Šå†™äº†ä¸€ä¸ªç‰›Bã€‚mouseSyncçš„å¼€å‘å·¥ä½œç®—æ˜¯å‘Šä¸€æ®µè½äº†ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ï¼</p><div align="center"><br><img src="https://syy.freep.cn/588778/dragdemo.gif" alt=""><br>&gt; dragäº‹ä»¶demo<br></div><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a href="https://stackoverflow.com/questions/1817628/clicking-the-mouse-down-to-drag-objects-on-mac" target="_blank" rel="external">https://stackoverflow.com/questions/1817628/clicking-the-mouse-down-to-drag-objects-on-mac</a></li><li><a href="https://www.flaticon.com" target="_blank" rel="external">https://www.flaticon.com</a></li></ol><h1 id="ç»“æŸ"><a href="#ç»“æŸ" class="headerlink" title="ç»“æŸ"></a>ç»“æŸ</h1><p>è¯•ç”¨è½¯ä»¶ä¹‹åå¦‚æœæ‚¨å¯¹è½¯ä»¶æœ‰ä»»ä½•çš„æ„è§ä¸å»ºè®®ï¼Œæ¬¢è¿ç•™è¨€ã€‚å¦‚æœæ‚¨å–œæ¬¢è¿™æ¬¾è½¯ä»¶ï¼Œä¹Ÿæ¬¢è¿æ‚¨å°†å®ƒæ¨èç»™æ‚¨çš„æœ‹å‹ä»¬ã€‚è®©æˆ‘ä»¬ä¸€èµ·å°†mouseSyncå˜å¾—æ›´å¥½ï¼</p><p>æˆ‘ä¼šåœ¨è®¢é˜…å·é‡Œä¸å®šæœŸåˆ†äº«æˆ‘ä¸ªäººçš„macOS/ioså¼€å‘å¿ƒå¾—å’Œå¼€å‘ç¬”è®°ï¼Œä¹Ÿä¼šåœ¨é‡Œé¢å‘è¡¨å¯¹äºè‹¹æœäº§å“/æ¡†æ¶/è¶‹åŠ¿çš„æ‹™è§ï¼Œå¸Œæœ›çˆ±å¥½ç§‘æŠ€äº§å“æˆ–è€…è‹¹æœç”Ÿæ€åœˆçš„å¼€å‘è€…å…³æ³¨ã€‚ç›¸ä¿¡æœ¬å…¬ä¼—å·ä¸€å®šèƒ½ç»™æ‚¨å¸¦æ¥æ”¶è·å’Œå¯å‘ã€‚</p><p>ã€æ¬¢è¿æ‰«ç å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€‘</p><div align="center"><br><img src="https://syy.freep.cn/588778/640.jpeg" alt=""><br>&gt; æ‰«ç å…³æ³¨å¾®ä¿¡å…¬ä¼—å· éª¨ç°çº§æœç²‰ è·å¾—æœ€æ–°æ–‡ç« æ›´æ–°<br></div>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;åœ¨&lt;a href=&quot;http://zhihaozhang.github.io/2017/09/23/è®©iMacä¸MacBooké«˜æ•ˆååŒå·¥ä½œâ€”
      
    
    </summary>
    
      <category term="è‹¹æœå¼€å‘" scheme="http://zhihaozhang.github.io/categories/%E8%8B%B9%E6%9E%9C%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="macOSå¼€å‘" scheme="http://zhihaozhang.github.io/tags/macOS%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>é’èŠ’ for Macå®¢æˆ·ç«¯å¼€å‘ç¬”è®°</title>
    <link href="http://zhihaozhang.github.io/2017/09/26/%E9%9D%92%E8%8A%92%20for%20Mac%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/"/>
    <id>http://zhihaozhang.github.io/2017/09/26/é’èŠ’ for Macå®¢æˆ·ç«¯å¼€å‘ç¬”è®°/</id>
    <published>2017-09-26T02:59:15.000Z</published>
    <updated>2017-09-26T03:54:57.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å…³äºè½»èŠ’å’Œé’èŠ’"><a href="#å…³äºè½»èŠ’å’Œé’èŠ’" class="headerlink" title="å…³äºè½»èŠ’å’Œé’èŠ’"></a>å…³äºè½»èŠ’å’Œé’èŠ’</h1><p>è½»èŠ’é˜…è¯»æ˜¯æˆ‘æ¯å¤©éƒ½ä¼šæ‰“å¼€çš„appï¼Œåœ¨å®ƒæä¾›çš„ä¸¤ç™¾å¤šä¸ªchannelä¸­ï¼Œæˆ‘è®¢é˜…äº†å…¶ä¸­åå‡ ä¸ªchannelï¼Œéå¸¸å–œæ¬¢è¿™ä¸ªäº§å“ã€‚è¿™ä¸ªäº§å“çš„åˆ›å§‹äººæ˜¯ç‹ä¿Šç…œï¼Œä»–æ›¾ç»åˆ›åŠäº†ä¸€ä¸ªæ›´æœ‰åçš„å…¬å¸â€”â€”è±Œè±†èšã€‚å…³äºè½»èŠ’å’Œä¿Šç…œçš„æ›´å¤šä»‹ç»ï¼Œè¯·å‚ç…§ï¼š <a href="http://tech2ipo.com/10034248" target="_blank" rel="external">å‰æ²¿ç§‘æŠ€</a>çš„æŠ¥é“ã€‚è™½ç„¶æŠ¥é“é‡Œå¼ºè°ƒäº†è½»èŠ’ä¸æ˜¯é’èŠ’ï¼Œä½†æ˜¯å‚ç…§çŸ¥äº†å’ŒçŸ¥ä¹çš„å…³ç³»ï¼Œæˆ‘è¿˜æ˜¯å†³å®šæŠŠæˆ‘çš„å®¢æˆ·ç«¯å–åä¸ºé’èŠ’ã€‚è€Œä¸”å–åé’èŠ’çš„ä¸€å¤§å¥½å¤„æ˜¯logoå¥½è®¾è®¡ã€‚åšå®ŒåŸå‹çš„ç¬¬äºŒå¤©ï¼Œæˆ‘å°±æ‰¾äº†éè‘—åè®¾è®¡å¸ˆJosephå¸®æˆ‘è®¾è®¡äº†ä¸€æšlogoï¼Œä¸ªäººè§‰å¾—è¿˜æ˜¯å¾ˆèµçš„ã€‚</p><p><img src="https://syy.freep.cn/588778/41854-ddfac87df1936535.jpeg" alt="éè‘—åè®¾è®¡å¸ˆJosephè®¾è®¡çš„logo" title="éè‘—åè®¾è®¡å¸ˆJosephè®¾è®¡çš„logo"></p><blockquote><p>éè‘—åè®¾è®¡å¸ˆJosephè®¾è®¡çš„logo</p></blockquote><h1 id="ä¸ºä»€ä¹ˆè¦åšé’èŠ’"><a href="#ä¸ºä»€ä¹ˆè¦åšé’èŠ’" class="headerlink" title="ä¸ºä»€ä¹ˆè¦åšé’èŠ’"></a>ä¸ºä»€ä¹ˆè¦åšé’èŠ’</h1><p>8æœˆ18æ—¥ï¼Œæˆ‘åœ¨githubé—²é€›çš„æ—¶å€™å‘ç°äº†è½»èŠ’å›¢é˜Ÿä»å¤„äºå†…æµ‹é˜¶æ®µçš„<a href="https://github.com/qingmang-team/docs" target="_blank" rel="external">APIæ–‡æ¡£</a>ï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„æ€åº¦ï¼Œæˆ‘ç»™è½»èŠ’å›¢é˜Ÿå‘é€äº†å†…æµ‹ç”³è¯·çš„é‚®ä»¶ï¼Œä¸¤å¤©åå¾—åˆ°äº†å¯¹æ–¹äº§å“ç»ç†æŒ¯è¾‰çš„å›å¤ï¼ŒåŒæ„äº†æˆ‘å‚åŠ å†…æµ‹çš„ç”³è¯·ï¼Œåœ¨è¿™è¡¨ç¤ºæ„Ÿè°¢ã€‚æ”¶åˆ°é‚®ä»¶ä¹‹åæˆ‘å…´å¥‹å¼‚å¸¸ï¼Œè™½ç„¶ä¹‹å‰ä¹Ÿåšäº†åƒå¾®åšã€twitterã€Instagramçš„å®¢æˆ·ç«¯ï¼Œä½†æ˜¯è¿™äº›äº§å“æ—©å·²æœ‰æ¯”æˆ‘åšçš„æ›´å¥½çš„äº§å“ä¸Šæ¶åˆ°Apple Storeäº†ï¼Œä¼°è®¡é™¤äº†æˆ‘ä»¥å¤–ï¼Œæ²¡æœ‰äººä¼šç”¨æˆ‘å¼€å‘çš„ç®€é™‹ç‰ˆå®¢æˆ·ç«¯ã€‚è€Œè½»èŠ’åˆ™ä¸åŒï¼Œç›®å‰è¿˜çœŸæ²¡æœ‰macå’Œwindowsçš„å®¢æˆ·ç«¯ã€‚</p><p>è½»èŠ’çš„ç”¨æˆ·é€šå¸¸å¯¹ç²¾ç¥ç”Ÿæ´»æœ‰ä¸°å¯Œçš„è¿½æ±‚ï¼Œåœ¨macOSå’Œwindowsä¸­ï¼Œæˆ‘ä¼°è®¡macOSç”¨æˆ·ä¼šéå¸¸å¤šï¼Œå› æ­¤æˆ‘é€‰æ‹©äº†macOSå¹³å°ï¼Œæˆ‘è®¤ä¸ºè¿™å¯¹æˆ‘æ˜¯ä¸€ä¸ªæœºä¼šï¼Œå¯èƒ½ä¼šæœ‰ä¸å°‘äººè¯•ç”¨è¿™æ¬¾è½¯ä»¶ã€‚æ¯•ç«Ÿçœ‹åˆ°åˆ«äººç”µè„‘æˆ–æ‰‹æœºä¸Šè¿è¡Œç€ä½ å¼€å‘çš„è½¯ä»¶ï¼Œè¿˜æ˜¯ä¼šç»™äººå¸¦æ¥å¾ˆå¤§çš„æˆå°±æ„Ÿçš„ã€‚(å·ç¬‘)</p><p>æ®ä¸å®Œå…¨ç»Ÿè®¡ï¼Œè‡ªä»å¼€æºä»¥æ¥ï¼Œå·²ç»æœ‰100å¤šäººä¸‹è½½äº†è¯¥è½¯ä»¶ã€‚</p><h1 id="é’èŠ’æ˜¯æ€ä¹ˆåšçš„"><a href="#é’èŠ’æ˜¯æ€ä¹ˆåšçš„" class="headerlink" title="é’èŠ’æ˜¯æ€ä¹ˆåšçš„"></a>é’èŠ’æ˜¯æ€ä¹ˆåšçš„</h1><p>çŸ¥äº†æ˜¯çŸ¥ä¹æ—¥æŠ¥çš„macå®¢æˆ·ç«¯ï¼Œé’èŠ’è·ŸçŸ¥äº†æœ‰ç€ç›¸åŒçš„éœ€æ±‚ï¼Œå³å±•ç¤ºchannel listã€article listã€article contentä¸‰ä¸ªéƒ¨åˆ†ï¼Œäºæ˜¯èŒç”Ÿäº†å€Ÿé‰´çŸ¥äº†çš„å¿µå¤´ï¼Œæœäº†ä¸€åœˆä¹‹åå‘ç°githubä¸Šå¹¶æ²¡æœ‰ç±»ä¼¼çš„macè½¯ä»¶å¼€æºå‡ºæ¥ï¼Œäºæ˜¯åšäº†å†³å®šï¼šè‡ªå·±ä»å¤´å¼€å§‹å†™ï¼Œå¹¶ä¸”å†™å®Œçš„ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å°†é¡¹ç›®å¼€æºã€‚æˆ‘ç›¸ä¿¡ä¸‰æ®µå¼å¸ƒå±€çš„åº”ç”¨ä¼šé€‚ç”¨å¾ˆå¤šåœºæ™¯ï¼Œå¹¶ä¸”ä¼šç»™åˆå­¦è€…ä»¬å¸¦æ¥ä¸€å®šçš„å¯å‘ã€‚é¡¹ç›®å¼€æºåœ¨<a href="https://github.com/zhihaozhang/qingmang-for-mac" target="_blank" rel="external">æˆ‘çš„github</a>ä¸Šï¼Œæ¬¢è¿forkå’Œstarï¼Œç‰¹åˆ«æ„Ÿè°¢githubå¼€å‘è€…@jydemoã€@immresså¯¹æœ¬é¡¹ç›®æå‡ºçš„æ”¹è¿›ä¸codeå®ç°ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ã€‚</p><p><img src="https://syy.freep.cn/588778/1BFAC168-DB08-4B9B-9EC4-04E8CE009D08.png" alt="å®¢æˆ·ç«¯è§†å›¾ï¼ˆæ¨¡ä»¿çš„çŸ¥äº†ï¼‰" title="å®¢æˆ·ç«¯è§†å›¾ï¼ˆæ¨¡ä»¿çš„çŸ¥äº†ï¼‰"></p><blockquote><p>å®¢æˆ·ç«¯è§†å›¾ï¼ˆæ¨¡ä»¿çš„çŸ¥äº†ï¼‰</p></blockquote><p><img src="https://syy.freep.cn/588778/41854-4a66018d8973436d.jpeg" alt="Notification Centerè§†å›¾ï¼ˆç•¥ä¸‘ï¼‰" title="Notification Centerè§†å›¾ï¼ˆç•¥ä¸‘ï¼‰"></p><blockquote><p>Notification Centerè§†å›¾ï¼ˆç•¥ä¸‘ï¼‰</p></blockquote><p><img src="https://syy.freep.cn/588778/41854-dfd0c7c1f1826698.jpeg" alt="TouchBarè§†å›¾" title="TouchBarè§†å›¾"></p><blockquote><p>TouchBarè§†å›¾</p></blockquote><p>è½»èŠ’çš„APIéµå¾ªRPCé£æ ¼ï¼Œå½¢å¦‚ åŸŸå/ä¸»ä½“.æ“ä½œï¼Œä¸»ä½“å’Œæ“ä½œéƒ½ä½¿ç”¨å°å†™å¼€å¤´çš„é©¼å³°å‘½åæ³•ï¼Œæ€»ä½“ä¸Šè¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“è°ƒç”¨çš„ã€‚é’èŠ’ç›®å‰ç”¨åˆ°äº†å…¶ä¸­çš„category.listã€category.getã€article.listã€article.getã€‚ç»æµ‹è¯•ï¼Œå‘ç°å†…æµ‹ç‰ˆé‡Œæä¾›çš„channelè¿˜éå¸¸æœ‰é™ï¼Œåªæœ‰11ä¸ªï¼Œæ‰€ä»¥ç›®å‰é€‰æ‹©å°†æ‰€æœ‰channelå±•ç¤ºå‡ºæ¥ã€‚</p><p>å¼€å‘é’èŠ’è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨åˆ°äº†å¦‚ä¸‹æŠ€æœ¯ï¼š<strong>HTTPè¯·æ±‚ã€jsonè§£æã€NSSplitViewã€WebKitã€NSTableViewã€å¤šçº¿ç¨‹(GCD)ã€imageViewã€è‡ªå®šä¹‰NSTextFieldã€NSScrollViewã€è‡ªå®šä¹‰Windowã€NSTouchBarã€NCWidgetProviding</strong>ç­‰æŠ€æœ¯,ä¸‹é¢æˆ‘æ¥è¯¦ç»†ä»‹ç»ä¸€ä¸‹é’èŠ’å®ç°çš„è¿‡ç¨‹ã€‚</p><h1 id="ç•Œé¢éƒ¨åˆ†"><a href="#ç•Œé¢éƒ¨åˆ†" class="headerlink" title="ç•Œé¢éƒ¨åˆ†"></a>ç•Œé¢éƒ¨åˆ†</h1><p>macOS/iosç•Œé¢çš„æ„å»ºä¸€ç›´æ˜¯å€¼å¾—äº‰è®ºçš„è¯é¢˜ï¼Œå¤§ä½“ä¸Šæœ‰ä¸‰ç§å¯é€‰æ–¹å¼ï¼š</p><ol><li>çº¯ä»£ç æ‰‹å†™</li><li>Xibæ–‡ä»¶</li><li>Stroyboard</li></ol><h2 id="çº¯æ‰‹å†™ä»£ç "><a href="#çº¯æ‰‹å†™ä»£ç " class="headerlink" title="çº¯æ‰‹å†™ä»£ç "></a>çº¯æ‰‹å†™ä»£ç </h2><p>çº¯æ‰‹å†™ä»£ç æ˜¯æå®¢çš„ä¸äºŒé€‰æ‹©ï¼Œå¯¹äºå¤šäººåä½œå·¥ä½œæ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯ç¼ºç‚¹ä¸»è¦æ˜¯ä¸èƒ½ç›´è§‚çš„çœ‹åˆ°æ•ˆæœã€ç¼–ç é€Ÿåº¦å¾ˆæ…¢ï¼Œä¾‹å¦‚åˆå§‹åŒ–ä¸€ä¸ªè‡ªå®šä¹‰çš„Buttonå¯èƒ½å°±éœ€è¦äºŒåè¡Œä»£ç ï¼Œéå¸¸ä¸åˆ©äºé˜…è¯»ã€‚</p><h2 id="Xibæ–‡ä»¶"><a href="#Xibæ–‡ä»¶" class="headerlink" title="Xibæ–‡ä»¶"></a>Xibæ–‡ä»¶</h2><p>Xibè§£å†³äº†ä¸Šé¢çš„ä¸¤ä¸ªé—®é¢˜ï¼Œæå‡äº†å¼€å‘æ•ˆç‡ã€‚å…¶å®Xibå°±æ˜¯XMLæ ¼å¼çš„æ–‡ä»¶ï¼Œåœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œè¢«ç¼–è¯‘æˆNibæ–‡ä»¶ï¼Œæ¯ä¸ªNibæ–‡ä»¶è·Ÿå¯¹åº”çš„ViewControllerå…³è”ã€‚Xibçš„ç¼ºç‚¹æ˜¯ï¼šä»£ç å¯èƒ½å›è¦†ç›–UIçš„è®¾è®¡ï¼Œè€Œä¸”æ¯ä¸ªè§†å›¾éƒ½éœ€è¦å•ä¸ªçš„Xibï¼Œè§†å›¾é—´çš„è·³è½¬ä¾ç„¶éœ€è¦ä»£ç æ§åˆ¶ã€‚</p><h2 id="Stroyboard"><a href="#Stroyboard" class="headerlink" title="Stroyboard"></a>Stroyboard</h2><p>ä¸ºäº†è§£å†³äº†Xibçš„é—®é¢˜ï¼ŒAppleæä¾›äº†æ•…äº‹æ¿åŠŸèƒ½ã€‚StoryBoardå¯ä»¥çœ‹æˆå°†å¾ˆå¤šXibé›†ä¸­åˆ°äº†ä¸€èµ·ï¼Œåƒè®²è¿°ä¸€ä¸ªæ•…äº‹ä¸€æ ·ï¼Œæ¸…æ™°çš„çœ‹åˆ°æ¯ä¸ªViewControllerä¹‹é—´çš„è·³è½¬å…³ç³»ï¼Œè·³è½¬å¯ä»¥ä¸ç”¨å†™ä»£ç äº†ã€‚å› æ­¤æˆ‘é€‰ç”¨äº†StoryBoardæ¥æ„å»ºé’èŠ’ã€‚</p><p><img src="https://syy.freep.cn/588778/41854-29c7c999adbbd83f.jpeg" alt="é’èŠ’çš„StoryBoardæ–‡ä»¶æˆªå›¾" title="é’èŠ’çš„StoryBoardæ–‡ä»¶æˆªå›¾"></p><blockquote><p>é’èŠ’çš„StoryBoardæ–‡ä»¶æˆªå›¾</p></blockquote><p>ä»StroyBoardæˆªå›¾å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°æ•´ä¸ªç•Œé¢çš„å¸ƒå±€ï¼Œæ•´ä¸ªç•Œé¢çš„å¸ƒå±€æ˜¯æ¨¡ä»¿çš„çŸ¥ä¹æ—¥æŠ¥Macå®¢æˆ·ç«¯ï¼ˆçŸ¥äº†ï¼‰åšçš„ï¼Œç»å…¸çš„ä¸‰æ®µå¼å¸ƒå±€ï¼ŒNSSplitViewå¯ä»¥å°†ç•Œé¢åˆ†æˆå·¦å³(æˆ–ä¸Šä¸‹)çš„ä¸¤éƒ¨åˆ†ã€‚è€ƒè™‘åˆ°ä¸»é¢˜ä¸€åˆ—æ¯”è¾ƒçª„ï¼Œè€Œä¸”ä¸»é¢˜å’Œç›¸åº”ä¸»é¢˜ä¸‹çš„æ–‡ç« æœ‰å¼ºå…³è”å…³ç³»ï¼Œå› æ­¤å€Ÿç”¨SplitViewå°†Overview Controllerä¸€åˆ†ä¸ºäºŒï¼Œè¿™æ ·ä¸‰æ®µå¼å¸ƒå±€å°±ç®—æ˜¯å®Œæˆäº†ã€‚</p><p>å…ˆä»å·¦è¾¹çš„OverViewè§†å›¾è¯´èµ·ï¼Œè¿™ä¸ªè§†å›¾é‡Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯ä¸€ç³»åˆ—çš„ä¸»é¢˜æŒ‰é’®ï¼Œç‚¹å‡»ä¹‹åï¼Œåœ¨å³è¾¹çš„NSTableviewé‡Œå±•ç¤ºå¯¹åº”ä¸»é¢˜ä¸‹çš„æœ€æ–°æ–‡ç« listã€‚æœ€æ–°æ–‡ç« listç‚¹å‡»ä¹‹åï¼Œåœ¨å³è¾¹çš„DetailViewä¸­ç”¨ä¸€ä¸ªWebViewå±•ç°æ–‡ç« çš„è¯¦æƒ…ã€‚</p><p>é»‘è‰²çš„éƒ¨åˆ†æ˜¯TouchBarçš„è§†å›¾ï¼ŒTouchBaræ˜¯è‹¹æœåœ¨MacBook Pro 2016æœºå‹ä¸ŠåŠ å…¥çš„ä¸€ä¸ªæ–°çš„äº¤äº’è®¾å¤‡ï¼Œå›´ç»•ä»–çš„è®¨è®ºæœ‰å¾ˆå¤šï¼Œæˆ‘ä»¬æœ‰ç©ºå¯ä»¥å•ç‹¬èŠä¸€ä¸‹ï¼Œä½†æ˜¯ä¸ºäº†å°Šé‡è¿™æ¡ä»·å€¼4Kçš„barï¼Œæˆ‘è¿˜æ˜¯å†³å®šåšäº†ç›¸åº”çš„é€‚é…ï¼Œå°†ä¸»é¢˜é€šè¿‡æŒ‰é’®çš„å½¢å¼æ”¾åˆ°äº†Barä¸Šï¼ŒBarä¸Šçš„æŒ‰é’®å’ŒOverViewçš„æŒ‰é’®æ˜¯éœ€è¦åšè”åŠ¨åŠŸèƒ½çš„ï¼Œåœ¨ä¸‹æ–‡ä¸­ä¼šæåˆ°ã€‚</p><p>è€å¿ƒåœ°æ‹–å…¥ç›¸å…³æ§ä»¶ã€æ§åˆ¶æ§ä»¶ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ï¼Œæœ€åˆå§‹çš„åŸå‹å°±ç®—æ˜¯å®Œæˆäº†ã€‚å½“ç„¶ï¼Œç»è¿‡è¯•ç”¨ï¼Œè¿˜æ˜¯å¯ä»¥å‘ç°ä¼˜åŒ–çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚Overviewé‡Œçš„tableviewå¹¶ä¸æ˜¯é¡¶åˆ°window titleçš„ï¼Œè¿™æ ·ç”¨æˆ·æ‹–æ‹½é‚£éƒ¨åˆ†çš„æ—¶å€™ï¼Œçª—å£ä¾ç„¶å¯ä»¥ç§»åŠ¨ï¼ŒåŒæ ·ï¼ŒWebViewä¸Šæ–¹ä¹Ÿæ˜¯éœ€è¦ç•™ç™½çš„ã€‚è™½ç„¶åªæ˜¯ä¸ªå¾ˆå°çš„ç»†èŠ‚ï¼Œä½†çœŸçš„å¾ˆè®¨å¥½ç”¨æˆ·ã€‚</p><h1 id="è‡ªå®šä¹‰å–ä»£ç³»ç»Ÿé»˜è®¤"><a href="#è‡ªå®šä¹‰å–ä»£ç³»ç»Ÿé»˜è®¤" class="headerlink" title="è‡ªå®šä¹‰å–ä»£ç³»ç»Ÿé»˜è®¤"></a>è‡ªå®šä¹‰å–ä»£ç³»ç»Ÿé»˜è®¤</h1><p>ç•Œé¢å®Œæˆåï¼Œå°±éœ€è¦åšåŠŸèƒ½äº†ï¼Œä½†æ˜¯ç­‰ç­‰ï¼Œå¥½åƒçœ‹èµ·æ¥ä¸å¤§å¯¹åŠ²ï¼Œä¸ºä»€ä¹ˆæ•ˆæœç›¸æ¯”äºçŸ¥äº†å·®å¾ˆå¤šå‘¢ï¼Ÿä¸‹é¢çš„æˆªå›¾å±•ç°äº†é’èŠ’çš„ç¬¬äºŒç‰ˆï¼Œç›¸æ¯”äºç¬¬ä¸€ç‰ˆï¼Œå·²ç»æ˜¯æŠŠwindowçš„æ ‡é¢˜å»æ‰äº†ï¼Œä½†è¿˜æ˜¯ç»™äººä¸€ç§å¯¨å¯¨çš„ã€ä¸å¤Ÿç®€æ´çš„æ„Ÿè§‰ã€‚TableViewä¸­é€‰ä¸­çš„é¢œè‰²è·Ÿæ•´ä½“ç•Œé¢å¾ˆä¸ç¬¦ã€‚</p><p><img src="https://syy.freep.cn/588778/41854-9395234244a1c39e.jpeg" alt="ç¬¬äºŒç‰ˆçš„é’èŠ’åŸå‹" title="ç¬¬äºŒç‰ˆçš„é’èŠ’åŸå‹"></p><blockquote><p>ç¬¬äºŒç‰ˆçš„é’èŠ’åŸå‹</p></blockquote><p>ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µå‘¢ï¼Ÿå› ä¸ºä¸€ç›´åˆ°ç°åœ¨ï¼Œæˆ‘ä»¬éƒ½æ˜¯é‡‡ç”¨çš„ç³»ç»Ÿé»˜è®¤é€‰é¡¹ï¼Œæ²¡æœ‰è®¾è®¡äººå‘˜çš„å®¡ç¾åœ¨é‡Œé¢ã€‚å¦‚ä½•ç»™ç”¨æˆ·å¸¦æ¥ç§äººè®¢åˆ¶çš„æ„Ÿè§‰å‘¢ï¼Ÿè¿™å°±éœ€è¦æˆ‘ä»¬è¦†ç›–ç³»ç»Ÿçš„é»˜è®¤è¡Œä¸ºå’Œå±æ€§ï¼Œå…·ä½“æ¥è¯´ï¼Œå°±æ˜¯è‡ªå®šä¹‰å­ç±»ï¼Œç»§æ‰¿å¹¶è¦†ç›–çˆ¶ç±»ä¸­ä¸ç¬¦åˆå¼€å‘è€…é¢„æœŸçš„éƒ¨åˆ†ã€‚</p><p>ä»æœ€åçš„ç»“æœæ¥çœ‹ï¼Œæˆ‘ä»¬éœ€è¦æ•´ä¸ªè½¯ä»¶çœ‹èµ·æ¥èƒŒæ™¯æ˜¯ç™½è‰²çš„ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ¯ä¸€ä¸ªviewåŠ è½½çš„å‡½æ•°ä¸­ï¼ŒæŒ‡å®šèƒŒæ™¯è‰²ä¸ºç™½è‰²ï¼Œä½¿ç”¨<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">view.wantsLayer =<span class="literal">true</span></div><div class="line"><span class="keyword">self</span>.view.layer?.backgroundColor=<span class="type">NSColor</span>.white.cgColor</div></pre></td></tr></table></figure></p><p>è™½ç„¶æ‰€æœ‰è§†å›¾èƒŒæ™¯è‰²å…¨éƒ¨è®¾ä¸ºäº†ç™½è‰²ï¼Œä½†æ˜¯å…³é—­ã€æœ€å¤§åŒ–ã€æœ€å°åŒ–æŒ‰é’®ä¾ç„¶titleä¸Šï¼Œè€Œä¸æ˜¯overviewé‚£éƒ¨åˆ†ï¼Œè®¾ç½®titleä¸ºå½±è—ï¼Œå®ƒä»¬åˆä¸è§äº†ï¼Œè®©ä»–ä»¬æ­£ç¡®æ˜¾ç¤ºåœ¨overviewä¸­çš„åšæ³•æ˜¯åœ¨windowåŠ è½½å‡½æ•°ä¸­åŠ å…¥ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">self</span>.window?.titleVisibility = .hidden</div><div class="line"><span class="keyword">self</span>.window?.titlebarAppearsTransparent =<span class="literal">true</span></div><div class="line"><span class="keyword">self</span>.window?.styleMask.insert(.fullSizeContentView)</div></pre></td></tr></table></figure></p><p>å…³äºTableViewä¸­é€‰ä¸­çŠ¶æ€çš„èƒŒæ™¯è‰²ï¼Œå¯è¡Œçš„æ–¹æ³•æœ‰ä¸¤ç§ã€‚ç¬¬ä¸€ç§æ˜¯è‡ªå®šä¹‰Cellè¦†ç›–NSTableCellViewï¼Œè¦†ç›–çˆ¶ç±»ä¸­çš„override var backgroundStyle:NSBackgroundStyle{}å±æ€§ã€‚ç¬¬äºŒç§æ–¹æ³•æ˜¯githubä¸Šçš„ç”¨æˆ·@jydemoforkæˆ‘çš„é¡¹ç›®ä¹‹åç»™æˆ‘æçš„issueï¼Œè‡ªå®šä¹‰NSTableRowViewï¼Œè¦†ç›–çˆ¶ç±»æ–¹æ³•ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">drawSelection</span><span class="params">(<span class="keyword">in</span> dirtyRect:NSRect)</span></span> &#123;</div><div class="line">    <span class="keyword">super</span>.drawSelection(<span class="keyword">in</span>: dirtyRect)</div><div class="line">    <span class="keyword">var</span> slectorRect =<span class="type">NSInsetRect</span>(<span class="keyword">self</span>.bounds,<span class="number">0</span>,<span class="number">0</span>)</div><div class="line">    <span class="type">NSColor</span>(calibratedWhite:<span class="number">0.92</span>, alpha:<span class="number">1.0</span>).setStroke()</div><div class="line">    <span class="type">NSColor</span>(calibratedWhite:<span class="number">0.92</span>, alpha:<span class="number">1.0</span>).setFill()</div><div class="line">    <span class="keyword">var</span> slectorPath =<span class="type">NSBezierPath</span>(roundedRect: slectorRect, xRadius:<span class="number">0</span>, yRadius:<span class="number">0</span>)</div><div class="line">    slectorPath.fill()</div><div class="line">    slectorPath.stroke()</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>ç„¶åå®ç°tableviewçš„ä»£ç†æ–¹æ³•ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">tableView</span><span class="params">(_tableView:NSTableView, rowViewForRow row:Int)</span></span> -&gt;<span class="type">NSTableRowView</span>? &#123;</div><div class="line">    <span class="keyword">let</span> rowview = <span class="type">MyTableRowView</span>(frame: .zero)</div><div class="line">    <span class="keyword">return</span> rowview</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸¤ä¸ªä¸»è§†å›¾ä¹‹é—´çš„åˆ†éš”æ¡æ¯”è¾ƒç²—ï¼Œæ€»è®©äººè§‰å¾—ä¸ç¾ï¼Œè§£å†³æ–¹æ³•è¿˜æ˜¯è‡ªå®šä¹‰ã€‚è¦†ç›–NSSplitViewï¼Œè¦†ç›–å±æ€§<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> vardividerThickness:<span class="type">CGFloat</span>&#123;</div><div class="line">    <span class="keyword">get</span> &#123;return0.<span class="number">5</span>&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>å¦‚æœç”¨æˆ·æ„¿æ„åˆ†éš”æ¡è¿˜æ˜¯å¯ä»¥å·¦å³åŠ¨çš„ï¼Œæƒ³ç¦æ‰å·¦å³åŠ¨çš„åŠŸèƒ½ï¼Œå®ç°NSSplitViewçš„ä¸€ä¸ªä»£ç†æ–¹æ³•ï¼š<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">splitView</span><span class="params">(_ofDividerAtsplitView:NSSplitView, effectiveRect proposedEffectiveRect:NSRect, forDrawnRect drawnRect:NSRect, ofDividerAt dividerIndex:Int)</span></span> -&gt;<span class="type">NSRect</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">NSRect</span>.zero</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>ç»è¿‡è¿™ä¸€ç« èŠ‚ï¼Œä¸éš¾å‘ç°è¿˜æ˜¯ä»£ç é è°±(ğŸ˜)ã€‚ç»è¿‡ä¸Šé¢çš„è°ƒæ•´ï¼Œç•Œé¢çœ‹èµ·æ¥ç®€æ´ã€æ¸…çˆ½äº†ä¸å°‘ï¼Œå¯ä»¥ä»¥å‡ä¹±çœŸäº†ã€‚</p><p>å¸Œæœ›è¿™ä¸€ç« èŠ‚è®©å¤§å®¶æ˜ç™½ï¼Œæƒ³è¦åšå‡ºçœ‹èµ·æ¥ç¾çš„ä¸œè¥¿ï¼Œä¸€å®šè¦å»å¤§èƒ†åœ°æ›¿ä»£ç³»ç»Ÿçš„é»˜è®¤é€‰é¡¹ã€‚è€Œå…·ä½“çš„åšæ³•é€šå¸¸æ˜¯è¦†ç›–çˆ¶ç±»ä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œè®°å¾—è¦å°†ç»„ä»¶å’Œè‡ªå®šä¹‰çš„ç±»å…³è”èµ·æ¥ã€‚</p><p><img src="https://syy.freep.cn/588778/41854-3976993182ab74f9.jpeg" alt="ç¾åŒ–åçš„ç•Œé¢" title="ç¾åŒ–åçš„ç•Œé¢"></p><blockquote><p>ç¾åŒ–åçš„ç•Œé¢</p></blockquote><h1 id="ä¸€ä¸ªå‘"><a href="#ä¸€ä¸ªå‘" class="headerlink" title="ä¸€ä¸ªå‘"></a>ä¸€ä¸ªå‘</h1><p>è‡ªå®šä¹‰TableViewçš„Cellè¿‡ç¨‹ä¸­ï¼Œç”±äºæ–‡ç« çš„æ ‡é¢˜é€šå¸¸æ˜¯æ¯”è¾ƒé•¿çš„ï¼Œå› æ­¤ç”¨NSTextFieldæ— æ³•æ”¾ä¸‹ï¼Œå¿…é¡»ä½¿ç”¨NSTextViewï¼Œè€ŒNSTextViewé»˜è®¤æ˜¯å¯ä»¥ä¸Šä¸‹å·¦å³æ»‘åŠ¨çš„ï¼Œæ‰€ä»¥åœ¨æ–‡ç« åˆ—è¡¨ä¸­ä¸Šä¸‹æ»‘åŠ¨çš„æ—¶å€™ï¼Œæ¯å½“æ»‘åŠ¨åˆ°TextViewé‡Œï¼Œæ»‘åŠ¨äº‹ä»¶å°±ä¼šç™½TextViewæ•è·ï¼ŒTableViewä¸­çš„Scroll viewæ²¡æœ‰æœºä¼šæ•è·äº†ã€‚</p><p>è§£å†³çš„æ–¹æ³•å’Œä¸Šä¸€èŠ‚ä¸€æ ·ï¼Œé€šè¿‡è¦†ç›–cellé‡Œ(è¯·æ³¨æ„æ˜¯Cellï¼Œä¸æ˜¯tableview)çš„scroll viewï¼Œé‡å†™hitTestæ–¹æ³•</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">hitTest</span><span class="params">(_point:NSPoint)</span></span> -&gt;<span class="type">NSView</span>? &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å‘Šè¯‰cellï¼Œè¿™ä¸ªæ»‘åŠ¨äº‹ä»¶æˆ‘ä¸å¤„ç†äº†ï¼Œè¯·äº¤ç»™åˆ«äººå¤„ç†å§ã€‚</p><h1 id="NSTouchBar"><a href="#NSTouchBar" class="headerlink" title="NSTouchBar"></a>NSTouchBar</h1><p>ä¸ºäº†èµ¶æ—¶é«¦ï¼Œåº”ç”¨å†…åšäº†TouchBarå’Œé€šçŸ¥ä¸­å¿ƒçš„å†…å®¹ã€‚TouchBaréœ€è¦æ³¨æ„çš„æ˜¯NSWindowå’ŒNSViewControllerä¹‹é—´çš„è”åŠ¨ã€‚ä»NSWindowåˆ°NSViewController:<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myViewcontroller =<span class="keyword">self</span>.window?.contentViewControlleras!mainViewController</div></pre></td></tr></table></figure></p><p>ç›¸åçš„è¿‡ç¨‹:<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> mywindowController=<span class="type">NSApplication</span>.shared().windows[<span class="number">0</span>].windowControlleras?windowController</div></pre></td></tr></table></figure></p><p>è¿™æ ·å°±å¯ä»¥åšåˆ°åœ¨TouchBarä¸­æŒ‰äº†æŸä¸ªæŒ‰é’®ï¼Œåœ¨ä¸»ç•Œé¢é‡Œä¹Ÿå¯ä»¥çœ‹åˆ°æŒ‰é’®è¢«é€‰ä¸­çš„æ•ˆæœï¼Œæ»¡è¶³äº†ä¸€è‡´æ€§ã€‚</p><h1 id="Notification-Centerè§†å›¾"><a href="#Notification-Centerè§†å›¾" class="headerlink" title="Notification Centerè§†å›¾"></a>Notification Centerè§†å›¾</h1><p>é€šçŸ¥ä¸­å¿ƒåšçš„è›®ä¸‘çš„ï¼ŒçœŸçš„æ˜¯ä¸ºäº†å°è¯•ä¸€ä¸‹TodayExtensionçš„åŠŸèƒ½è€Œå·²ã€‚æ¨¡ä»¿çŸ¥äº†ï¼Œç›®å‰åŠŸèƒ½åªæ˜¯å±•ç¤ºäº†é¦–é¡µçš„æ–‡ç« åˆ—è¡¨ï¼Œç‚¹å‡»æ–‡ç« å¯ä»¥ç”¨ç³»ç»Ÿé»˜è®¤æµè§ˆå™¨æ‰“å¼€åŸæ–‡ã€‚å…¶å®è¿™ä¹Ÿå°±å¤Ÿäº†ï¼Œæ¯•ç«Ÿé€šçŸ¥ä¸­å¿ƒå°±æ˜¯ä¸ºäº†çœ‹ä¸ªå¤§æ¦‚ç”¨çš„ï¼Œè°ä¹Ÿä¸ä¼šç»å¸¸ç‚¹å¼€çœ‹ã€‚é€šçŸ¥ä¸­å¿ƒéœ€è¦æ³¨æ„çš„æ˜¯è¦è‡ªå®šä¹‰è§†å›¾çš„é«˜åº¦ï¼Œé€šè¿‡<br>self.preferredContentSize=CGSize(width:self.view.frame.size.width, height:xxx)<br>å®Œæˆã€‚<br>æœ€åè¦æ³¨æ„çš„æ˜¯ç”¨URLSessionè¯·æ±‚æ•°æ®ï¼Œå¯ä»¥é˜²æ­¢UIå¡é¡¿ï¼ŒUIå¡é¡¿ç»™ç”¨æˆ·å¸¦æ¥çš„æ„Ÿè§‰éå¸¸ç³Ÿç³•ã€‚<br><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">getData</span><span class="params">(with urlString:String,success:@escaping<span class="params">(Data?)</span></span></span>-&gt;<span class="type">Void</span>, failure: ((<span class="type">Error</span>)-&gt;<span class="type">Void</span>)? =<span class="literal">nil</span>) &#123;</div><div class="line"></div><div class="line">         <span class="keyword">guard</span> <span class="keyword">let</span> url =<span class="type">URL</span>(string: urlString)<span class="keyword">else</span>&#123;</div><div class="line"></div><div class="line">         <span class="keyword">return</span></div><div class="line"></div><div class="line">&#125;</div><div class="line">    <span class="keyword">let</span> task =<span class="type">URLSession</span>.shared.dataTask(with: url) &#123; (data:<span class="type">Data</span>?, response:<span class="type">URLResponse</span>?, error:<span class="type">Error</span>?)<span class="keyword">in</span></div><div class="line">    <span class="type">DispatchQueue</span>.main.async&#123;</div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> error = error &#123;</div><div class="line">                     failure?(error)</div><div class="line">    &#125;<span class="keyword">else</span>&#123;</div><div class="line">                      success(data)</div><div class="line">                 &#125;</div><div class="line">          &#125;</div><div class="line">      &#125;</div><div class="line">     task.resume()</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h1 id="æ–‡ç« å…·ä½“å†…å®¹è§†å›¾"><a href="#æ–‡ç« å…·ä½“å†…å®¹è§†å›¾" class="headerlink" title="æ–‡ç« å…·ä½“å†…å®¹è§†å›¾"></a>æ–‡ç« å…·ä½“å†…å®¹è§†å›¾</h1><p>é’èŠ’å›¢é˜Ÿæä¾›çš„APIé‡Œæœ‰web-contentè¿™ä¸€é¡¹ï¼Œåªè¦é€šè¿‡webviewåŒ…è£…ç„¶åloadä¸€ä¸‹å°±ä¼šå°†æ–‡å­—å’Œå›¾ç‰‡å±•ç¤ºå‡ºæ¥ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›ç»†èŠ‚éœ€è¦è€ƒè™‘åˆ°çš„ã€‚æ¯”å¦‚æœ‰äº›å›¾ç‰‡æ˜¯å¾ˆå¤§çš„ï¼Œè™½ç„¶é™åˆ¶äº†çª—å£ä¸å¾—å°äºä¸€ä¸ªå€¼ï¼Œä½†æœ‰äº›å›¾ç‰‡è¿˜æ˜¯è¿œè¶…äº†è¿™ä¸ªå¤§å°ã€‚web-contentæ˜¯æ²¡æœ‰æ ‡é¢˜çš„ï¼Œçœ‹èµ·æ¥ä¼šæ¯”è¾ƒçªå…€ï¼Œæ ‡é¢˜å’Œæ ‡é¢˜éœ€è¦ä½ æ‰‹åŠ¨åŠ ä¸Šã€‚å›¾ç‰‡è¿‡å¤§æ—¶ï¼Œçª—å£æ˜¯å¯ä»¥å·¦å³æ»‘åŠ¨çš„ï¼Œæ€ä¹ˆæŠŠä»–é™åˆ¶ä¸èƒ½æ»‘åŠ¨ã€‚å­—ä½“å¦‚ä½•è·Ÿå…¶ä»–éƒ¨åˆ†è§†å›¾çš„å­—ä½“åšåˆ°æ²¡æœ‰è¿å’Œæ„Ÿï¼Œéƒ½æ˜¯éœ€è¦è€ƒè™‘çš„é—®é¢˜ï¼Œè¿™äº›ç”¨å‰ç«¯é‡Œçš„CSSæ ·å¼å¯ä»¥æ§åˆ¶ï¼Œéœ€è¦å¼€å‘è€…æœ‰ä¸€å®šçš„å‰ç«¯å¼€ç»éªŒã€‚ç”±äºæœ¬å…¬ä¼—å·é‡å¿ƒåœ¨æœæ•™ï¼Œå› æ­¤è¿™é‡Œå°±ä¸å…·ä½“å±•å¼€å™è¿°äº†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥å‚è€ƒ<a href="https://github.com/zhihaozhang/qingmang-for-mac" target="_blank" rel="external">æˆ‘çš„github</a>ã€‚</p><h1 id="é’èŠ’çš„å®£ä¼ "><a href="#é’èŠ’çš„å®£ä¼ " class="headerlink" title="é’èŠ’çš„å®£ä¼ "></a>é’èŠ’çš„å®£ä¼ </h1><p>åšå®Œé’èŠ’ä¹‹åï¼Œè€ƒè™‘åˆ°æ•´ä¸ªé¡¹ç›®æ˜¯ç”¨æœ€æ–°çš„swift4å†™æˆï¼Œäºæ˜¯æˆ‘åœ¨å¾®åšä¸Š@äº†swiftLanguageï¼Œåšä¸»æ˜¯ä¸€ä¸ªä¸å¤§ä¸å°çš„Vï¼Œå…³æ³¨è€…å¤šæ˜¯å¯¹swiftæ„Ÿå…´è¶£çš„æˆ–ä»ä¸šäººå‘˜ã€‚çŸ­çŸ­ä¸¤å¤©ï¼Œè¯¥å¾®åšè·å¾—äº†1ä¸‡å¤šæ¬¡é˜…è¯»ï¼Œæœ€åæˆ‘æ¬£å–œçš„å‘ç°ï¼Œç‹ä¿Šç…œä¹Ÿç»™è¯¥å¾®åšç‚¹äº†èµï¼Œæ„Ÿè°¢ä¿Šæ˜±çš„é¼“åŠ±ä¸è‚¯å®šã€‚</p><p><img src="https://syy.freep.cn/588778/41854-9f58bf0f94c7afad.jpeg" alt="å¾®åšæˆªå›¾" title="å¾®åšæˆªå›¾"></p><blockquote><p>å¾®åšæˆªå›¾</p></blockquote><h1 id="ç»“æŸè¯­"><a href="#ç»“æŸè¯­" class="headerlink" title="ç»“æŸè¯­"></a>ç»“æŸè¯­</h1><p>é’èŠ’çš„å¼€å‘åªç”¨äº†ä¸¤å¤©ï¼Œå…¶å®å¯ä»¥åšçš„ä¸œè¥¿è¿˜æœ‰å¾ˆå¤šã€‚è¯•ç”¨è½¯ä»¶ä¹‹åå¦‚æœæ‚¨å¯¹è½¯ä»¶æœ‰ä»»ä½•çš„æ„è§ä¸å»ºè®®ï¼Œæ¬¢è¿ç•™è¨€ã€‚</p><p>å¦‚æœæ‚¨å–œæ¬¢è¿™æ¬¾è½¯ä»¶ï¼Œä¹Ÿæ¬¢è¿æ‚¨å°†å®ƒæ¨èç»™æ‚¨çš„æœ‹å‹ä»¬ã€‚è®©æˆ‘ä»¬ä¸€èµ·å°†é’èŠ’å˜å¾—æ›´å¥½ï¼</p><p>æˆ‘ä¼šåœ¨è®¢é˜…å·é‡Œä¸å®šæœŸåˆ†äº«æˆ‘ä¸ªäººçš„macOS/ioså¼€å‘å¿ƒå¾—å’Œå¼€å‘ç¬”è®°ï¼Œä¹Ÿä¼šåœ¨é‡Œé¢å‘è¡¨å¯¹äºè‹¹æœäº§å“/æ¡†æ¶/è¶‹åŠ¿çš„æ‹™è§ï¼Œå¸Œæœ›çˆ±å¥½ç§‘æŠ€äº§å“æˆ–è€…è‹¹æœç”Ÿæ€åœˆçš„å¼€å‘è€…å…³æ³¨ã€‚ç›¸ä¿¡æœ¬å…¬ä¼—å·ä¸€å®šèƒ½ç»™æ‚¨å¸¦æ¥æ”¶è·å’Œå¯å‘ã€‚<br>ã€æ¬¢è¿æ‰«ç å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ã€‘</p><p><img src="https://syy.freep.cn/588778/640.jpeg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å…³äºè½»èŠ’å’Œé’èŠ’&quot;&gt;&lt;a href=&quot;#å…³äºè½»èŠ’å’Œé’èŠ’&quot; class=&quot;headerlink&quot; title=&quot;å…³äºè½»èŠ’å’Œé’èŠ’&quot;&gt;&lt;/a&gt;å…³äºè½»èŠ’å’Œé’èŠ’&lt;/h1&gt;&lt;p&gt;è½»èŠ’é˜…è¯»æ˜¯æˆ‘æ¯å¤©éƒ½ä¼šæ‰“å¼€çš„appï¼Œåœ¨å®ƒæä¾›çš„ä¸¤ç™¾å¤šä¸ªchannelä¸­ï¼Œæˆ‘è®¢é˜…äº†å…¶ä¸­åå‡ ä¸ªchanne
      
    
    </summary>
    
      <category term="è‹¹æœå¼€å‘" scheme="http://zhihaozhang.github.io/categories/%E8%8B%B9%E6%9E%9C%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="macOSå¼€å‘" scheme="http://zhihaozhang.github.io/tags/macOS%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>è®©iMacä¸MacBooké«˜æ•ˆååŒå·¥ä½œâ€”â€”mouseSyncå¼€å‘å¿ƒå¾—</title>
    <link href="http://zhihaozhang.github.io/2017/09/23/%E8%AE%A9iMac%E4%B8%8EMacBook%E9%AB%98%E6%95%88%E5%8D%8F%E5%90%8C%E5%B7%A5%E4%BD%9C%E2%80%94%E2%80%94mouseSync%E5%BC%80%E5%8F%91%E5%BF%83%E5%BE%97/"/>
    <id>http://zhihaozhang.github.io/2017/09/23/è®©iMacä¸MacBooké«˜æ•ˆååŒå·¥ä½œâ€”â€”mouseSyncå¼€å‘å¿ƒå¾—/</id>
    <published>2017-09-23T11:49:34.000Z</published>
    <updated>2017-09-27T07:03:56.040Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¼€å‘mouseSyncçš„åˆè¡·"><a href="#å¼€å‘mouseSyncçš„åˆè¡·" class="headerlink" title="å¼€å‘mouseSyncçš„åˆè¡·"></a>å¼€å‘mouseSyncçš„åˆè¡·</h1><p>æˆ–è®¸æ˜¯ä¸æƒ³è®©ä¹°æ˜¾ç¤ºå™¨é€ä¸»æœºçš„ç¬‘è¯æˆçœŸï¼ŒAppleå°†iMac 2015ä¹‹åçš„ç‰ˆæœ¬å…³é—­äº†çº¯æ˜¾ç¤ºå™¨æ¨¡å¼ã€‚Apple storeé‡ŒLGçš„æ˜¾ç¤ºå™¨æŒºè´µçš„ï¼Œ27å¯¸5Kç‰ˆæœ¬å”®ä»·è¶…è¿‡äº†1ä¸‡å…ƒï¼Œè¡¬æ‰˜å‡ºäº†iMac 27å¯¸13000+çš„å®šä»·ä¹‹è‰¯å¿ƒã€‚è€ƒè™‘åˆ°ä¸¤è€…é¢œå€¼çš„å·®åˆ«ï¼Œåœ¨çœ‹è„¸çš„æ—¶ä»£ï¼ŒiMacçš„é”€é‡è¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚iMacçš„ç”¨æˆ·å¾ˆå¯èƒ½ä¹Ÿæ˜¯MacBookçš„ç”¨æˆ·ï¼Œå› æ­¤è®©iMacå’ŒMacBookååŒå·¥ä½œæ˜¯å¾ˆæœ‰æ„ä¹‰çš„ä¸€ä»¶äº‹ã€‚å½“ç„¶ï¼Œä¹ŸåŒæ ·é€‚ç”¨äºä¸¤å°MacBookä¹‹é—´çš„ååŒå·¥ä½œã€‚</p><p><img src="https://syy.freep.cn/588778/1.jpeg" alt="" title="è€ç‰ˆæœ¬iMacçš„Target Display æ¨¡å¼"></p><p> ä¸ºäº†è®©ä¸¤å°MacååŒå·¥ä½œï¼Œæˆ‘å‘ç°æœ€ç—›è‹¦çš„äº‹æƒ…è«è¿‡äºéœ€è¦ä¸¤å¥—è§¦æ‘¸æ¿(é¼ æ ‡)å’Œé”®ç›˜ã€‚åœ¨è°·æ­Œé‡Œæœäº†åŠå¤©ï¼Œå‘ç°äº†å¾ˆå¤šé€šè¿‡è“ç‰™å°†ä¸€å°macçš„é”®ç›˜ä½œä¸ºå¦ä¸€å°macé”®ç›˜çš„è½¯ä»¶ï¼Œä½†æ˜¯å°†ä¸€å°macçš„é¼ æ ‡ä½œä¸ºå¦ä¸€å°macçš„é¼ æ ‡çš„è½¯ä»¶å´å¾ˆå°‘ã€‚æ¯”è¾ƒçŸ¥åçš„è½¯ä»¶æ˜¯Synergyï¼Œä½†æ˜¯å®ƒçš„æ™®é€šç‰ˆå”®ä»·19åˆ€ã€proç‰ˆå”®ä»·29åˆ€ï¼Œä½œä¸ºä¸€ä¸ªå·¥ç¨‹å¸ˆçš„æˆ‘ä¸æ„¿æ„æè¿™é’±ï¼Œäºæ˜¯mouseSyncå‡ºç°äº†ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œå®ƒæ˜¯å¼€æºçš„ï¼Œæ‰˜ç®¡åœ¨githubä¸Šï¼Œåœ°å€æ˜¯ï¼š<a href="https://github.com/zhihaozhang/mouseSync" target="_blank" rel="external">https://github.com/zhihaozhang/mouseSync</a></p><h1 id="mouseSyncå¼€å‘æ­¥éª¤"><a href="#mouseSyncå¼€å‘æ­¥éª¤" class="headerlink" title="mouseSyncå¼€å‘æ­¥éª¤"></a>mouseSyncå¼€å‘æ­¥éª¤</h1><p>å¼€å‘ä»»ä½•ä¸œè¥¿ï¼Œæˆ‘é¦–å…ˆé—®è‡ªå·±çš„äº‹æƒ…ä¾¿æ˜¯:å¤§è±¡æ”¾è¿›å†°ç®±ä¸€å…±åˆ†å‡ æ­¥ï¼Ÿè¦æƒ³è®©ä¸€å°macçš„é¼ æ ‡äº‹ä»¶åŒæ­¥ç»™å¦ä¸€å°macï¼Œé¦–å…ˆéœ€è¦å°†ä¸¤å°ç”µè„‘è¿æ¥èµ·æ¥ï¼Œå»ºç«‹ä¸€æ¡ç¨³å®šçš„ä¸“ç”¨é€šé“ã€‚ç„¶åæ¯å½“å®¿ä¸»æœºå‘ç”Ÿç›¸åº”æ—¶é—´çš„æ—¶å€™ï¼Œå‘é€šçŸ¥ç»™å¦ä¸€å°Macï¼Œè®©å®ƒçš„é¼ æ ‡ä¹Ÿè·Ÿç€ç§»åŠ¨ã€‚</p><h2 id="ä¸ºä»€ä¹ˆé€‰ç”¨è“ç‰™"><a href="#ä¸ºä»€ä¹ˆé€‰ç”¨è“ç‰™" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰ç”¨è“ç‰™"></a>ä¸ºä»€ä¹ˆé€‰ç”¨è“ç‰™</h2><p>è€ƒè™‘åˆ°ååŒå·¥ä½œè‚¯å®šä¸¤å°ç”µè„‘é çš„å¾ˆè¿‘ï¼Œåœ¨è“ç‰™çš„æ¥æ”¶èŒƒå›´å†…ã€‚å†è€ƒè™‘åˆ°è“ç‰™4.0æ ‡å‡†çš„è€—ç”µé‡å¾ˆä½ï¼Œè€Œä¸”å³ä½¿åœ¨æ²¡æœ‰wifiçš„æƒ…å†µä¸‹ä¾ç„¶å¯ä»¥å·¥ä½œï¼Œå› æ­¤æˆ‘é€‰ç”¨äº†è“ç‰™æŠ€æœ¯æ¥å»ºç«‹ä¸“ç”¨é€šé“ã€‚è“ç‰™æ¡†æ¶ä¸­å€¼å¾—æ³¨æ„çš„æ¦‚å¿µå¤§çº¦æœ‰5ä¸ªã€‚æˆ‘æƒ³ä¸¾ä¸€ä¸ªæˆ‘ç”Ÿæ´»ä¸­çš„ä¾‹å­æ¥ä»‹ç»ä¸‹é¢çš„æ¦‚å¿µ:æˆ‘æ¯å¤©ä¼šç”¨ä¸€ä¸ªä½“é‡è®¡é‡ä¸€ä¸‹ä½“é‡ï¼Œç„¶åä½“é‡è®¡ä¼šé€šè¿‡è“ç‰™ä¼ åˆ°æˆ‘çš„æ‰‹æœºAppé‡Œï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥çŸ¥é“æˆ‘æ¯å¤©çš„ä½“é‡ä»¥åŠè¿‘æœŸä½“é‡çš„è¶‹åŠ¿ã€‚</p><ol><li>Central(æ•°æ®ä¸­å¿ƒ) ç”¨æ¥å±•ç¤ºä¿¡æ¯çš„è®¾å¤‡ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„æ‰‹æœºã€‚</li><li>Peripheral(å¤–å›´è®¾ç½®) åŸå§‹æ•°æ®é‡‡é›†ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„ä½“é‡è®¡ã€‚</li><li>Service(æœåŠ¡) æŒ‡å¤–å›´è®¾ç½®æä¾›çš„å„ç§èƒ½åŠ›ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­ä½“é‡è®¡ç§°é‡çš„èƒ½åŠ›ã€‚</li><li>Characteristic(ç‰¹å¾å€¼) æœåŠ¡ä¸­çš„æ•°æ®æˆä¸ºç‰¹å¾å€¼ï¼Œå¯¹åº”ä¸Šé¢ä¾‹å­ä¸­çš„ä½“é‡æ•°æ®ã€ä½“è´¨æ•°æ®ç­‰å…¶ä»–æ•°æ®ã€‚</li><li>UUID æœåŠ¡æˆ–ç‰¹å¾å€¼çš„å”¯ä¸€æ ‡å¿—ã€‚æ¯ä¸ªæœåŠ¡æˆ–ç‰¹å¾å€¼å‡æœ‰ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ã€‚æ¯”å¦‚æˆ‘çš„ä½“é‡è®¡ä¸ä»…èƒ½ç§°é‡ï¼Œè¿˜èƒ½æµ‹ä½“è„‚ã€æ°´åˆ†ç­‰ç‰¹å¾å€¼ï¼Œæ‰‹æœºAppç«¯èƒ½åŒºåˆ†ä½“é‡æ•°æ®å’Œæ°´åˆ†æ•°æ®ï¼Œå°±é UUIDã€‚å½“ç„¶ï¼ŒUUIDçš„å€¼éœ€è¦æ•°æ®ä¸­å¿ƒå’Œå¤–å›´è®¾ç½®é€šè®¯å‰å°±çº¦å®šå¥½ã€‚</li></ol><p><img src="https://syy.freep.cn/588778/2.jpeg" alt="" title="è“ç‰™é€šè®¯çš„æµç¨‹"></p><p>è“ç‰™é€šè®¯çš„æµç¨‹å›¾æ¸…æ¥šçš„è§£é‡Šäº†è“ç‰™é€šè®¯çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç±»ä¼¼TCP/IPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œä¸è¿‡æ²¡æœ‰é‚£ä¹ˆä¸¥æ ¼ã€‚ç®€å•çš„æ¥è¯´ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å¤–è®¾å°†è‡ªå·±çš„ç‰¹å¾å€¼é€šè¿‡æœåŠ¡çš„å½¢å¼æ‰“åŒ…å‘å¸ƒï¼Œé€šè¿‡å»ºç«‹èµ·æ¥çš„è“ç‰™é€šé“å¹¿æ’­ç»™æ•°æ®ä¸­å¿ƒã€‚é¦–å…ˆï¼Œæ•°æ®ä¸­å¿ƒæ‰«æè“ç‰™ä¿¡å·ï¼Œå‘ç°å¤–è®¾åï¼Œä¸å¤–è®¾å»ºç«‹èµ·é“¾æ¥ï¼Œè¯·æ±‚æœåŠ¡æºå¸¦çš„æ•°æ®ï¼Œä¸€æ¬¡æœ€åŸºæœ¬çš„è¯»å–æ•°æ®äº¤æ¢å°±ç®—æ˜¯å®Œæˆäº†ã€‚å½“ç„¶ï¼Œæ•°æ®ä¸­å¿ƒä¹Ÿå¯ä»¥å‘æŒ‡ä»¤ç»™å¤–è®¾ã€‚å¯¹äºç»å¸¸å˜åŒ–çš„ç‰¹å¾å€¼ï¼Œæ•°æ®ä¸­å¿ƒå¯ä»¥è®¢é˜…å®ƒï¼Œæ¯å½“å®ƒå‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥å®æ—¶é€šçŸ¥æ•°æ®ä¸­å¿ƒï¼Œä»¥ä¾¿æ•°æ®ä¸­å¿ƒåšå‡ºç›¸åº”å˜åŒ–ã€‚å…·ä½“åˆ°Cocoaæ¡†æ¶ï¼Œè“ç‰™çš„ç›¸å…³ç±»è§ä¸‹å›¾ã€‚</p><p><img src="https://syy.freep.cn/588778/3.jpeg" alt="" title=" è“ç‰™çš„ç›¸å…³ç±»"></p><h3 id="Peripheralç›¸å…³ç±»"><a href="#Peripheralç›¸å…³ç±»" class="headerlink" title="Peripheralç›¸å…³ç±»"></a>Peripheralç›¸å…³ç±»</h3><p>CBPeripheralManageræ˜¯ç®¡ç†å¤–è®¾çš„ï¼Œæä¾›äº†å‘å¸ƒæœåŠ¡ï¼Œå¹¿æ’­æ–¹æ³•ï¼ŒCBPeripheralManagerDelegateæ˜¯å®ƒçš„ä»£ç†æ–¹æ³•ï¼Œè€ƒè™‘åˆ°äº†å¤–è®¾å’Œæ•°æ®ä¸­å¿ƒä¹‹é—´æ•°æ®äº¤æ¢æ˜¯å¼‚æ­¥çš„ï¼Œå®ƒå®šä¹‰äº†ä¸€ç»„åè®®æ–¹æ³•ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€å‡ºå‘å›è°ƒä»£ç†æ–¹æ³•å®ŒæˆåŒæ–¹æ•°æ®äº¤æ¢ã€‚</p><p>CBPeripheralç±»æ˜¯å»ºç«‹è“ç‰™è¿æ¥åï¼Œç»™CBCentralè°ƒç”¨peripheralå¤–è®¾æä¾›çš„å¯¹è±¡ã€‚CBPeripheralDelegateæ˜¯å®ƒçš„ä»£ç†åè®®ï¼Œæä¾›è¾…åŠ©CBPeripheralå®ŒæˆæœåŠ¡å‘ç°ã€æ•°æ®è·å–ã€è®¢é˜…æ•°æ®åçš„å›è°ƒæ–¹æ³•ã€‚</p><h3 id="Centralç›¸å…³ç±»"><a href="#Centralç›¸å…³ç±»" class="headerlink" title="Centralç›¸å…³ç±»"></a>Centralç›¸å…³ç±»</h3><p>CBCentralæ˜¯æ•°æ®ä¸­å¿ƒç±»ï¼Œå®Œæˆè“ç‰™è®¾å¤‡å‘ç°ï¼Œå»ºç«‹è¿æ¥ï¼Œè¯·æ±‚æœåŠ¡æ•°æ®åŠŸèƒ½ã€‚CBCentralDelegateæ˜¯å®ƒçš„ä»£ç†åè®®ï¼Œè¾…åŠ©å®ƒcentralæä¾›Peripheralå‘ç°ï¼Œå»ºç«‹è¿æ¥åçš„å›è°ƒã€‚</p><h3 id="serviceç›¸å…³ç±»"><a href="#serviceç›¸å…³ç±»" class="headerlink" title="serviceç›¸å…³ç±»"></a>serviceç›¸å…³ç±»</h3><p>CBMutableServiceæ˜¯å¯å˜ç±»å‹çš„æœåŠ¡å¯¹è±¡ç±»ï¼ŒUUIDå’Œç‰¹å¾å€¼å¯ä»¥ä¿®æ”¹ã€‚ä¸å®ƒå¯¹åº”çš„æ˜¯CBServiceï¼Œå±æ€§ä¸å¯ä¿®æ”¹çš„æœåŠ¡å¯¹è±¡ç±»ã€‚</p><h3 id="characteristicç›¸å…³ç±»"><a href="#characteristicç›¸å…³ç±»" class="headerlink" title="characteristicç›¸å…³ç±»"></a>characteristicç›¸å…³ç±»</h3><p>CBMutableCharacteristicæ˜¯å¯å˜ç±»å‹çš„ç‰¹å¾å€¼å¯¹è±¡ç±»ï¼ŒUUIDã€propertieså±æ€§å¯ä»¥ä¿®æ”¹ã€‚ä¸å®ƒå¯¹åº”çš„æ˜¯CBCharacteristicç±»ï¼Œä¸Šè¿°å±æ€§ä¸èƒ½ä¿®æ”¹ã€‚</p><p><img src="https://syy.freep.cn/588778/4.jpeg" alt="" title="å¤–è®¾ã€æœåŠ¡ã€ç‰¹å¾é—´çš„å…³ç³»"></p><p>å›åˆ°mouseSync,ä¸¤å°Macä¸­ï¼Œè´Ÿè´£é‡‡é›†è§¦æ‘¸æ¿äº‹ä»¶çš„é‚£å°Macæ˜¯å¤–å›´è®¾ç½®ï¼Œå¦ä¸€å°Macæ˜¯æ•°æ®ä¸­å¿ƒã€‚å»ºç«‹èµ·è“ç‰™ç‰©ç†é€šé“ä¹‹åï¼Œæ¥ä¸‹æ¥è¦åšçš„äº‹æ˜¯ç›‘å¬å¤–å›´è®¾ç½®çš„è§¦æ‘¸æ¿äº‹ä»¶ï¼Œç„¶åé€šçŸ¥æ•°æ®ä¸­å¿ƒçš„è§¦æ‘¸æ¿è·Ÿç€è¯¥äº‹ä»¶è¿›è¡Œå“åº”ã€‚</p><h1 id="åœ¨å¤–å›´è®¾å¤‡ç«¯ç›‘å¬é¼ æ ‡äº‹ä»¶"><a href="#åœ¨å¤–å›´è®¾å¤‡ç«¯ç›‘å¬é¼ æ ‡äº‹ä»¶" class="headerlink" title="åœ¨å¤–å›´è®¾å¤‡ç«¯ç›‘å¬é¼ æ ‡äº‹ä»¶"></a>åœ¨å¤–å›´è®¾å¤‡ç«¯ç›‘å¬é¼ æ ‡äº‹ä»¶</h1><p>é¼ æ ‡äº‹ä»¶çš„ç›‘å¬åˆ†ä¸ºå…¨å±€ç›‘å¬å’Œåº”ç”¨å†…ç›‘å¬ï¼Œæ˜¾ç„¶å…¨å±€ç›‘å¬æ›´ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚å¯¹é”®ç›˜é¼ æ ‡äº‹ä»¶çš„ç›‘å¬ï¼Œä¸»è¦è°ƒç”¨çš„æ˜¯NSEvneté‡Œçš„addGlobalMonitorForEventsæ–¹æ³•ã€‚é¼ æ ‡äº‹ä»¶æœ‰å¾ˆå¤šç§ï¼Œè¿™é‡Œæˆ‘é€‰å–äº†æ¯”è¾ƒé‡è¦çš„å‡ ç§ï¼Œåˆ†åˆ«æ˜¯ç§»åŠ¨(.mouseMoved)ã€å•å‡»(.leftMouseDown/up)ã€åŒå‡»(ç‰¹æ®Šå¤„ç†)ã€å³å‡»(.rightMouseDonw/up)ã€è§¦æ‘¸æ¿çš„ä¸Šä¸‹å·¦å³æ»‘åŠ¨(.scrollWheel)å’Œé¼ æ ‡çš„ä¸Šä¸‹æ»‘åŠ¨ã€‚</p><h2 id="ç§»åŠ¨äº‹ä»¶"><a href="#ç§»åŠ¨äº‹ä»¶" class="headerlink" title="ç§»åŠ¨äº‹ä»¶"></a>ç§»åŠ¨äº‹ä»¶</h2><p>ç§»åŠ¨æ¯”è¾ƒå¥½å¤„ç†ï¼Œè¿™é‡Œæˆ‘å…³å¿ƒçš„æ˜¯å½“å‰ä½ç½®ç›¸æ¯”äºä¸Šä¸€ä¸ªä½ç½®xå’Œyæ–¹å‘çš„åæ ‡å˜åŠ¨æƒ…å†µï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªå˜é‡è®°å½•ä¸Šä¸€ä¸ªä½ç½®ï¼Œç„¶åå°†xå’Œyæ–¹å‘çš„å˜åŠ¨é€šè¿‡è“ç‰™å‘é€ç»™æ•°æ®ä¸­å¿ƒï¼Œè®©æ•°æ®ä¸­å¿ƒçš„é¼ æ ‡ä¹Ÿè¿›è¡Œç›¸åº”çš„å˜åŠ¨ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒMacçš„åæ ‡(0,0)ç‚¹åœ¨å·¦ä¸‹æ–¹ï¼Œå› æ­¤ç§»åŠ¨é¼ æ ‡çš„æ—¶å€™éœ€è¦è¿›è¡Œç›¸åº”çš„è½¬æ¢ã€‚</p><h2 id="å•å‡»äº‹ä»¶"><a href="#å•å‡»äº‹ä»¶" class="headerlink" title="å•å‡»äº‹ä»¶"></a>å•å‡»äº‹ä»¶</h2><p>å•å‡»äº‹ä»¶åˆ†æˆä¸¤ä¸ªæ­¥éª¤ï¼Œç¬¬ä¸€ä¸ªæ­¥éª¤æ˜¯å·¦é”®æŒ‰ä¸‹ï¼Œç¬¬äºŒä¸ªæ­¥éª¤æ˜¯å·¦é”®å¼¹èµ·æ¥ã€‚åªæœ‰ä¸¤ä¸ªäº‹ä»¶éƒ½å‘ç”Ÿï¼Œæˆ‘ä»¬æ‰è®¤ä¸ºæ•´ä¸ªå•å‡»çš„è¿‡ç¨‹å®Œæˆäº†ã€‚å•å‡»äº‹ä»¶å¹¶ä¸éœ€è¦ä¼ å¤–å›´è®¾ç½®çš„åæ ‡ç»™æ•°æ®ä¸­å¿ƒï¼Œç›´æ¥äººæ•°æ®ä¸­å¿ƒåœ¨å½“å‰çš„é¼ æ ‡ä½ç½®æ‰§è¡Œå•å‡»äº‹ä»¶å³å¯ã€‚</p><h2 id="åŒå‡»äº‹ä»¶"><a href="#åŒå‡»äº‹ä»¶" class="headerlink" title="åŒå‡»äº‹ä»¶"></a>åŒå‡»äº‹ä»¶</h2><p>åŒå‡»äº‹ä»¶å’Œå•å‡»äº‹ä»¶å¾ˆåƒï¼Œç›‘å¬äº‹ä»¶ä¼ å…¥çš„eventå¯¹è±¡æœ‰ä¸€ä¸ªclickCountå±æ€§ï¼Œå¦‚æœè¯¥å±æ€§çš„å€¼å¤§äºç­‰äº2ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå®ƒæ˜¯åŒå‡»äº‹ä»¶ã€‚åé¢çš„æ­¥éª¤è·Ÿå•å‡»äº‹ä»¶ä¸€æ ·ã€‚</p><h2 id="å³å‡»äº‹ä»¶"><a href="#å³å‡»äº‹ä»¶" class="headerlink" title="å³å‡»äº‹ä»¶"></a>å³å‡»äº‹ä»¶</h2><p>å³å‡»äº‹ä»¶è·Ÿå•å‡»äº‹ä»¶å°±æ›´åƒäº†ï¼Œåªæ˜¯å°†åç§°ç”±leftæ”¹æˆäº†rightã€‚</p><h2 id="æ»‘åŠ¨äº‹ä»¶"><a href="#æ»‘åŠ¨äº‹ä»¶" class="headerlink" title="æ»‘åŠ¨äº‹ä»¶"></a>æ»‘åŠ¨äº‹ä»¶</h2><p>æ»‘åŠ¨äº‹ä»¶åœ¨xå’Œyæ–¹å‘çš„å˜åŒ–å€¼åˆ†åˆ«å¯¹åº”çš„æ˜¯eventå¯¹è±¡é‡Œçš„deltaXå’ŒdeltaYï¼Œå°†è¿™ä¸¤ä¸ªå€¼ä¼ ç»™æ•°æ®ä¸­å¿ƒï¼Œå¹¶æœ‰æ•°æ®ä¸­å¿ƒè·Ÿç€è¿™ä¸¤ä¸ªå€¼è¿›è¡Œç›¸åº”çš„æ»‘åŠ¨å³å¯ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç”¨æˆ·åªä¼šåœ¨ä¸€ä¸ªæ–¹å‘ä¸Šè¿›è¡Œæ»‘åŠ¨(é¼ æ ‡åªèƒ½ä¸Šä¸‹æ»‘åŠ¨)ï¼Œå› æ­¤æˆ‘å°†é¼ æ ‡å·¦å³å’Œä¸Šä¸‹çš„æ»‘åŠ¨åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†è¿›è¡Œå¤„ç†ï¼Œä¼ é€’çš„æ—¶å€™åˆ¤æ–­å¤–å›´è®¾ç½®åœ¨å“ªä¸ªæ–¹å‘ä¸Šæ›´æ˜¾è‘—ï¼Œè®©æ•°æ®ä¸­å¿ƒè¿›è¡Œç›¸åº”çš„æ»‘åŠ¨ã€‚</p><h1 id="åœ¨æ•°æ®ä¸­å¿ƒç«¯æ¨¡æ‹Ÿé¼ æ ‡äº‹ä»¶"><a href="#åœ¨æ•°æ®ä¸­å¿ƒç«¯æ¨¡æ‹Ÿé¼ æ ‡äº‹ä»¶" class="headerlink" title="åœ¨æ•°æ®ä¸­å¿ƒç«¯æ¨¡æ‹Ÿé¼ æ ‡äº‹ä»¶"></a>åœ¨æ•°æ®ä¸­å¿ƒç«¯æ¨¡æ‹Ÿé¼ æ ‡äº‹ä»¶</h1><h2 id="å•å‡»ã€å³å‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ"><a href="#å•å‡»ã€å³å‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ" class="headerlink" title="å•å‡»ã€å³å‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ"></a>å•å‡»ã€å³å‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ</h2><p>å‰é¢æåˆ°è¿‡äº†ï¼Œå•å‡»å’Œå³å‡»äº‹ä»¶éå¸¸åƒï¼Œå› æ­¤ä¸¾åŒä¸€ä¸ªä¾‹å­å°±å¯ä»¥è¯´æ˜é—®é¢˜ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">mouseMoveAndClick</span><span class="params">(onPoint point: CGPoint)</span></span> &#123;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> moveEvent = <span class="type">CGEvent</span>(mouseEventSource: <span class="literal">nil</span>, mouseType: .mouseMoved, mouseCursorPosition: point, mouseButton: .<span class="keyword">left</span>) <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> downEvent = <span class="type">CGEvent</span>(mouseEventSource: <span class="literal">nil</span>, mouseType: .leftMouseDown, mouseCursorPosition: point, mouseButton: .<span class="keyword">left</span>) <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> upEvent = <span class="type">CGEvent</span>(mouseEventSource: <span class="literal">nil</span>, mouseType: .leftMouseUp, mouseCursorPosition: point, mouseButton: .<span class="keyword">left</span>) <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        moveEvent.post(tap: <span class="type">CGEventTapLocation</span>.cghidEventTap)</div><div class="line">        downEvent.post(tap: <span class="type">CGEventTapLocation</span>.cghidEventTap)</div><div class="line">        upEvent.post(tap: <span class="type">CGEventTapLocation</span>.cghidEventTap)</div><div class="line">    &#125;~~</div></pre></td></tr></table></figure><p>æ€è·¯æ˜¯é€šè¿‡CGEventåˆ›å»ºä¸€ä¸ªäº‹ä»¶ï¼Œç„¶åè°ƒç”¨è¯¥äº‹ä»¶çš„postæ–¹æ³•å‘Šè¯‰ç³»ç»Ÿï¼Œæ‰§è¡Œè¯¥äº‹ä»¶ã€‚</p><h2 id="é¼ æ ‡ç§»åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ"><a href="#é¼ æ ‡ç§»åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ" class="headerlink" title="é¼ æ ‡ç§»åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ"></a>é¼ æ ‡ç§»åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ</h2><p>ç§»åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿè·Ÿä¸Šé¢æ€è·¯ä¸€æ ·ï¼Œè¦æ³¨æ„çš„æ˜¯OS Xå±å¹•çš„åæ ‡ç³»ç»Ÿï¼Œxå’Œyæ–¹å‘çš„å˜åŒ–æ˜¯åŠ è¿˜æ˜¯å‡ã€‚</p><h2 id="åŒå‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ"><a href="#åŒå‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ" class="headerlink" title="åŒå‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ"></a>åŒå‡»äº‹ä»¶çš„æ¨¡æ‹Ÿ</h2><p>å¼€å§‹ä»¥ä¸ºåŒå‡»äº‹ä»¶çš„æ¨¡æ‹Ÿæ— éå°±æ˜¯æ¨¡æ‹Ÿä¸¤æ¬¡å•å‡»äº‹ä»¶ï¼Œè®©ä»–ä»¬ä¹‹é—´çš„æ—¶é—´é—´éš”éå¸¸å°ã€‚ä½†ç»è¿‡å°è¯•ï¼Œè¯¥æ–¹å¼è¡Œä¸é€šã€‚åœ¨ç½‘ä¸Šæœäº†ä¸€äº›solutionï¼Œæœ€åå±…ç„¶æ˜¯åœ¨æˆ‘æœ€å–œæ¬¢çš„ç‚‰çŸ³ä¼ è¯´çš„ä¸€ä¸ªæ’ä»¶é‡Œå‘ç°çš„ç­”æ¡ˆã€‚ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">`  <span class="function"><span class="keyword">func</span> <span class="title">doubleClick</span><span class="params">(at location: NSPoint)</span></span> &#123;</div><div class="line"> <span class="keyword">let</span> source = <span class="type">CGEventSource</span>(stateID: .privateState)</div><div class="line"> </div><div class="line"> <span class="keyword">var</span> click = <span class="type">CGEvent</span>(mouseEventSource: source, mouseType: .leftMouseDown,</div><div class="line"> mouseCursorPosition: location, mouseButton: .<span class="keyword">left</span>)</div><div class="line"> click?.setIntegerValueField(.mouseEventClickState, value: <span class="number">1</span>)</div><div class="line"> click?.post(tap: .cghidEventTap)</div><div class="line"> </div><div class="line"> <span class="keyword">var</span> release = <span class="type">CGEvent</span>(mouseEventSource: source, mouseType: .leftMouseUp,</div><div class="line">   mouseCursorPosition: location, mouseButton: .<span class="keyword">left</span>)</div><div class="line"> release?.setIntegerValueField(.mouseEventClickState, value: <span class="number">1</span>)</div><div class="line"> release?.post(tap: .cghidEventTap)</div><div class="line"> </div><div class="line"> click = <span class="type">CGEvent</span>(mouseEventSource: source, mouseType: .leftMouseDown,</div><div class="line"> mouseCursorPosition: location, mouseButton: .<span class="keyword">left</span>)</div><div class="line"> click?.setIntegerValueField(.mouseEventClickState, value: <span class="number">2</span>)</div><div class="line"> click?.post(tap: .cghidEventTap)</div><div class="line"> </div><div class="line"> release = <span class="type">CGEvent</span>(mouseEventSource: source, mouseType: .leftMouseUp,</div><div class="line">   mouseCursorPosition: location, mouseButton: .<span class="keyword">left</span>)</div><div class="line"> release?.setIntegerValueField(.mouseEventClickState, value: <span class="number">2</span>)</div><div class="line"> release?.post(tap: .cghidEventTap)</div><div class="line"> &#125;</div></pre></td></tr></table></figure><h2 id="æ»‘åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ"><a href="#æ»‘åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ" class="headerlink" title="æ»‘åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ"></a>æ»‘åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿ</h2><p>æ»‘åŠ¨äº‹ä»¶çš„æ¨¡æ‹Ÿï¼Œswiftç›®å‰æ”¯æŒçš„ä¸æ˜¯å¾ˆå¥½ï¼Œæˆ‘åœ¨Stack Overflowä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªæ¯”è¾ƒtrickyçš„æ–¹æ³•ã€‚éœ€è¦swiftå’ŒCæ··ç¼–ï¼Œå€ŸåŠ©Cæ¥å®Œæˆä»»åŠ¡ã€‚å…³äºswiftå’ŒC/OCçš„æ··ç¼–å†…å®¹æ¯”è¾ƒå¤šï¼Œè¿™é‡Œä¸å±•å¼€è®²äº†ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç ”ç©¶æˆ‘çš„å¼€æºä»£ç ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">` <span class="function"><span class="keyword">void</span> <span class="title">createScrollWheelEventY</span><span class="params">(<span class="keyword">float</span> x)</span> </span>&#123;</div><div class="line"> CGEventRef upEvent = CGEventCreateScrollWheelEvent(</div><div class="line"> <span class="literal">NULL</span>,</div><div class="line"> kCGScrollEventUnitPixel, <span class="number">2</span>, x*<span class="number">5</span>, <span class="number">0</span> );</div><div class="line">CGEventPost(kCGHIDEventTap, upEvent);</div><div class="line"> CFRelease(upEvent);</div><div class="line"> &#125;</div><div class="line"> </div><div class="line"> <span class="function"><span class="keyword">void</span> <span class="title">createScrollWheelEventX</span><span class="params">(<span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line"> CGEventRef upEvent = CGEventCreateScrollWheelEvent(</div><div class="line"> <span class="literal">NULL</span>,</div><div class="line"> kCGScrollEventUnitPixel, <span class="number">2</span>, <span class="number">0</span>, y*<span class="number">5</span>);</div><div class="line"> CGEventPost(kCGHIDEventTap, upEvent);</div><div class="line"> CFRelease(upEvent);</div><div class="line"> &#125;</div></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œé‡åˆ°äº†ä¸€ä¸ªè¯¡å¼‚çš„é—®é¢˜ï¼Œä¸Šä¸‹æ»‘åŠ¨å¯ä»¥å¾ˆå¥½çš„å·¥ä½œï¼Œä½†æ˜¯å·¦å³æ»‘åŠ¨æ­»æ´»ä¸èƒ½å’Œé¢„æœŸçš„ä¸€æ ·ï¼Œå•æ­¥è·Ÿè¸ªåå‘ç°ä¼ å…¥å‡½æ•°çš„ç¡®å®æ˜¯floatç±»å‹çš„æ­£ç¡®å€¼ï¼Œä½†æ˜¯åˆ›å»ºupEventçš„æ—¶å€™ï¼Œè¯¥å˜é‡çš„å€¼çªå˜äº†ã€‚åé¢å°†floatç±»å‹æ”¹æˆäº†intç±»å‹ï¼Œåˆå¯ä»¥æ­£å¸¸çš„å·¥ä½œäº†ã€‚å¦‚æœçŸ¥é“ä¸ºä»€ä¹ˆçš„åŒå­¦å¯ä»¥ç•™è¨€å‘Šè¯‰æˆ‘ã€‚</p><h1 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h1><p><img src="https://syy.freep.cn/588778/demo922.gif" alt=""><br><img src="https://syy.freep.cn/588778/demo1.gif" alt=""><br><img src="https://syy.freep.cn/588778/demo2.gif" alt=""></p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>å¼€å‘mouseSyncçš„è¿‡ç¨‹ä¸­ï¼Œè®©æˆ‘æ›´æ·±åˆ»çš„ç†è§£äº†Cocoaçš„è“ç‰™æ¡†æ¶ã€é”®ç›˜é¼ æ ‡äº‹ä»¶ã€‚çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œã€‚</p><p>å¦å¤–ï¼ŒmouseSyncçš„å¼€å‘è¿˜æ²¡æœ‰å®Œæˆï¼Œç›®å‰å­˜åœ¨çš„é—®é¢˜æ˜¯å¤–å›´è®¾å¤‡è¿™è¾¹çš„é¼ æ ‡å®¹æ˜“è¯¯æ“ä½œï¼Œå› æ­¤æˆ‘å‡†å¤‡å°†å¤–å›´è®¾å¤‡çš„é¼ æ ‡æ§åˆ¶åœ¨ä¸€ä¸ªwindowå†…ï¼Œä¸€æ—¦ç§»é™¤è¿™ä¸ªwindowï¼Œå°±å¼ºè¡Œå°†å…‰æ ‡ç§»åŠ¨å›windowä¸­å¿ƒã€‚é€šè¿‡å¿«æ·é”®æ§åˆ¶è½¯ä»¶çš„å¼€å¯å’Œå…³é—­ã€‚è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œé‚£å°±æ˜¯æˆ‘éå¸¸å–œçˆ±çš„ä¸‰æŒ‡æ‹–ç§»åŠŸèƒ½ï¼Œæ•¬è¯·æœŸå¾…ï¼</p><p><em>ä½ å¯¹mouseSyncçš„åŠŸèƒ½è¿˜æœ‰å“ªäº›æœŸå¾…æˆ–å»ºè®®å‘¢ï¼Ÿä¸å¦¨ç•™è¨€å‘Šè¯‰æˆ‘å§ï¼</em></p><p>å¼€å‘å’Œå†™æœ¬æ–‡è¿‡ç¨‹ä¸­å‚è€ƒäº†ä»¥ä¸‹èµ„æ–™ï¼Œåœ¨è¿™è¡¨ç¤ºæ„Ÿè°¢ï¼š<br>ã€1ã€‘ macOSåº”ç”¨å¼€å‘ï¼Œèµµå‰‘ å¼ å¸† åˆè‘—<br>ã€2ã€‘HSTrackerçš„githubå¼€æºä»£ç  <a href="https://github.com/HearthSim/HSTracker/blob/master/HSTracker/Utility/Automation.swift" target="_blank" rel="external">https://github.com/HearthSim/HSTracker/blob/master/HSTracker/Utility/Automation.swift</a><br>ã€3ã€‘Stack Overflow: <a href="https://stackoverflow.com/questions/42813264/cocoa-application-scroll-programmatically" target="_blank" rel="external">https://stackoverflow.com/questions/42813264/cocoa-application-scroll-programmatically</a><br>ã€4ã€‘ iosè“ç‰™æŠ€æœ¯ï¼š<a href="http://www.jianshu.com/p/c1154179da8a" target="_blank" rel="external">http://www.jianshu.com/p/c1154179da8a</a></p><p><em>æˆ‘ä¼šåœ¨å¾®ä¿¡å…¬ä¼—å·ã€éª¨ç°çº§æœç²‰ã€‘ä¸­ä¸å®šæœŸåˆ†äº«æˆ‘ä¸ªäººçš„macOS/ioså¼€å‘å¿ƒå¾—å’Œå¼€å‘ç¬”è®°ï¼Œä¹Ÿä¼šåœ¨é‡Œé¢å‘è¡¨å¯¹äºè‹¹æœäº§å“/æ¡†æ¶/è¶‹åŠ¿çš„æ‹™è§ï¼Œå¸Œæœ›çˆ±å¥½ç§‘æŠ€äº§å“æˆ–è€…è‹¹æœç”Ÿæ€åœˆçš„å¼€å‘è€…å…³æ³¨ã€‚ç›¸ä¿¡æœ¬å…¬ä¼—å·ä¸€å®šèƒ½ç»™æ‚¨å¸¦æ¥æ”¶è·å’Œå¯å‘ã€‚</em></p><p><img src="https://syy.freep.cn/588778/640.jpeg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å¼€å‘mouseSyncçš„åˆè¡·&quot;&gt;&lt;a href=&quot;#å¼€å‘mouseSyncçš„åˆè¡·&quot; class=&quot;headerlink&quot; title=&quot;å¼€å‘mouseSyncçš„åˆè¡·&quot;&gt;&lt;/a&gt;å¼€å‘mouseSyncçš„åˆè¡·&lt;/h1&gt;&lt;p&gt;æˆ–è®¸æ˜¯ä¸æƒ³è®©ä¹°æ˜¾ç¤ºå™¨é€ä¸»æœºçš„ç¬‘è¯æˆçœŸï¼ŒApp
      
    
    </summary>
    
      <category term="è‹¹æœå¼€å‘" scheme="http://zhihaozhang.github.io/categories/%E8%8B%B9%E6%9E%9C%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="macOSå¼€å‘" scheme="http://zhihaozhang.github.io/tags/macOS%E5%BC%80%E5%8F%91/"/>
    
  </entry>
  
  <entry>
    <title>æ•°æ®å¯è§†åŒ–ä¹‹æ•£ç‚¹å›¾</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8B%E6%95%A3%E7%82%B9%E5%9B%BE/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/æ•°æ®å¯è§†åŒ–ä¹‹æ•£ç‚¹å›¾/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-24T04:14:12.000Z</updated>
    
    <content type="html"><![CDATA[<p>D3.jsæ˜¯å½“ä¸‹æœ€ç«çš„å¯è§†åŒ–åº“ä¹‹ä¸€ï¼Œè¿™ç¯‡åšå®¢è®°å½•äº†å¦‚ä½•å®ç°ä¸€ä¸ªæœ€åŸºæœ¬çš„æ•£ç‚¹å›¾ï¼Œå¹¶ç”¨ä¸‰è§’å½¢è¡¨ç¤ºæ•°æ®ç‚¹ã€‚</p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;!DOCTYPE html\&gt;</div><div class="line">\&lt;html\&gt;</div><div class="line">\&lt;head lang=&quot;en&quot;\&gt;</div><div class="line">\&lt;meta charset=&quot;UTF-8&quot;\&gt;</div><div class="line">\&lt;title\&gt;\&lt;/title\&gt;</div><div class="line">\&lt;script type=&quot;text/javascript&quot; src=&quot;script/d3.v3.js&quot;\&gt; \&lt;/script\&gt;</div><div class="line">\&lt;/head\&gt;</div><div class="line">\&lt;style\&gt;</div><div class="line">body &#123;</div><div class="line">font: 10px sans-serif;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.axis path,</div><div class="line">.axis line &#123;</div><div class="line">fill: none;</div><div class="line">stroke: #000;</div><div class="line">shape-rendering: crispEdges;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.point &#123;</div><div class="line">fill: steelblue;</div><div class="line">stroke: #000;</div><div class="line">&#125;</div><div class="line"></div><div class="line">\&lt;/style\&gt;</div><div class="line">\&lt;body\&gt;</div><div class="line"></div><div class="line">\&lt;script\&gt;</div><div class="line"></div><div class="line">var margin = &#123;top:20,right:20,bottom:30,left:40&#125;,</div><div class="line">width = 960-margin.left-margin.right,</div><div class="line">height = 500-margin.top-margin.bottom;</div><div class="line"></div><div class="line">var x = d3.scale.linear().range([0,width]());</div><div class="line">var y = d3.scale.linear().range([height,0]());</div><div class="line"></div><div class="line">var svg = d3.select(&apos;body&apos;).append(&apos;svg&apos;).attr(&apos;width&apos;,width+margin.left+margin.right)</div><div class="line">.attr(&apos;height&apos;,height+margin.top+margin.bottom)</div><div class="line">.append(&apos;g&apos;)</div><div class="line">.attr(&apos;transform&apos;,&quot;translate(&quot;+margin.left+&quot;,&quot;+margin.top+&apos;)&apos;);</div><div class="line"></div><div class="line">d3.csv(&apos;tmp.csv&apos;,function(error,data)&#123;</div><div class="line">if(error) throw error;</div><div class="line"></div><div class="line">data.forEach(function(d)&#123;</div><div class="line">d.x=+d.x;</div><div class="line">d.y=+d.y;</div><div class="line">&#125;)</div><div class="line">//        console.log(data);</div><div class="line"></div><div class="line">x.domain(d3.extent(data,function(d)&#123;return d.x&#125;)).nice();</div><div class="line">y.domain(d3.extent(data,function(d)&#123;return d.y&#125;)).nice();</div><div class="line"></div><div class="line">svg.append(&apos;g&apos;)</div><div class="line">.attr(&apos;class&apos;,&apos;x axis&apos;)</div><div class="line">.attr(&apos;transform&apos;,&apos;translate(0,&apos;+height+&quot;)&quot;)</div><div class="line">.call(d3.svg.axis().scale(x).orient(&apos;bottom&apos;));</div><div class="line"></div><div class="line">svg.append(&apos;g&apos;)</div><div class="line">.attr(&apos;class&apos;,&apos;y axis&apos;)</div><div class="line">.call(d3.svg.axis().scale(y).orient(&apos;left&apos;));</div><div class="line"></div><div class="line">svg.selectAll(&apos;.point&apos;)</div><div class="line">.data(data).enter()</div><div class="line">.append(&apos;path&apos;)</div><div class="line">.attr(&apos;class&apos;,&apos;point&apos;)</div><div class="line">.attr(&apos;d&apos;,d3.svg.symbol().type(&apos;triangle-up&apos;))</div><div class="line">.attr(&apos;transform&apos;,function(d)&#123;return &quot;translate(&quot;+x(d.x)+&quot;,&quot;+y(d.y)+&quot;)&quot;&#125;);</div><div class="line"></div><div class="line"></div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">\&lt;/script\&gt;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">\&lt;/body\&gt;</div><div class="line">\&lt;/html\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>ä»£ç æœ¬èº«æ˜¯å¾ˆåŸºæœ¬çš„ï¼Œä¸è¿‡ä»£ç é‡Œé¢æœ‰ä¸€äº›å¯ä»¥å­¦ä¹ çš„å¥½ä¹ æƒ¯ï¼Œæ¯”å¦‚ï¼š</p><ol><li><p>ä½¿ç”¨var margin = {top:20,right:20,bottom:30,left:40}å˜é‡æ¥è¡¨ç¤ºè·ç¦»ä¸Šä¸‹å·¦å³çš„è·ç¦»ï¼Œè¿™æ ·ç»Ÿä¸€ç®¡ç†ï¼Œåªæœ‰ä¸€ä¸ªå˜é‡ã€‚</p></li><li><p>data.forEach(function(d){<br> d.x=+d.x;<br> d.y=+d.y;<br> })<br>ä½¿ç”¨è¿™ç§æ–¹å¼ç›´æ¥è½¬æ¢æˆæ•°å€¼å‹çš„å˜é‡ï¼Œå…å»äº†ä½¿ç”¨å…¶ä»–å‡½æ•°çš„éº»çƒ¦ã€‚</p></li><li>.nice()å‡½æ•°çš„ä½¿ç”¨ï¼Œå¯ä»¥é€‚å½“æ‰©å¤§extentçš„èŒƒå›´ï¼Œè¿™æ ·æœ€å¤§æœ€å°å€¼åœ¨åæ ‡è½´ä¸Šçœ‹èµ·æ¥ä¸ä¼šåœ¨æç«¯çš„ä½ç½®ä¸Šã€‚</li><li>.attr(â€˜dâ€™,d3.svg.symbol().type(â€˜triangle-upâ€™)) ä½¿ç”¨ä¸å±€é™äºcircleçš„å›¾å½¢æ¥è¡¨ç¤ºä¸€ä¸ªç‚¹</li><li>svg.append(â€˜gâ€™).attr(â€˜classâ€™,â€™y axisâ€™).call(d3.svg.axis().scale(y).orient(â€˜leftâ€™));<br>  ä¸€å¥è¯é‡ŒæŒ‡å®šè¦ç»˜åˆ¶åæ ‡è½´éœ€è¦çš„æ‰€æœ‰ä¸œè¥¿ã€‚</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;D3.jsæ˜¯å½“ä¸‹æœ€ç«çš„å¯è§†åŒ–åº“ä¹‹ä¸€ï¼Œè¿™ç¯‡åšå®¢è®°å½•äº†å¦‚ä½•å®ç°ä¸€ä¸ªæœ€åŸºæœ¬çš„æ•£ç‚¹å›¾ï¼Œå¹¶ç”¨ä¸‰è§’å½¢è¡¨ç¤ºæ•°æ®ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;d
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>polybrush in d3</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/polybrush%20in%20d3/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/polybrush in d3/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-25T07:02:00.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://i3.piimg.com/0e2d18cf43f9f605.png" alt=""></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½ æ˜¯å¦ä¹Ÿåƒæˆ‘ä¸€æ ·ï¼ŒåŒå€¦äº†d3é»˜è®¤çš„çŸ©å½¢çš„brushï¼Œæˆ–è€…ä½ å‘ç°çŸ©å½¢çš„brushå·²ç»ä¸èƒ½æ»¡è¶³ä½ çš„éœ€è¦äº†;åˆæˆ–è€…ä½ åªæ˜¯å•çº¯çš„è¢«ä¸Šé¢çš„å›¾ç‰‡æ‰€å¸å¼•ã€‚ä¸ç®¡æ€æ ·ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸€ä¸‹polybrushã€‚</p><p>è¿™ç¯‡åšå®¢çš„åå­—å«polybrush in d3ï¼Œç°åœ¨æƒ³æ¥ï¼Œå¥½åƒæœ‰ç‚¹é”™è¯¯ï¼Œå› ä¸ºpolybrushå¹¶ä¸æ˜¯d3å†…ç½®çš„ï¼Œå®ƒæ˜¯ç”±Geoffrey T. Bellåœ¨2012å¹´å¼€å‘çš„d3æ’ä»¶ï¼Œå› å…¶æ–¹ä¾¿ã€å¥½ç”¨ï¼Œæ‰€ä»¥å¹¿å—å¥½è¯„ã€‚</p><p>ä½†æ— å¥ˆç›®å‰ä¸­æ–‡çš„ç›¸å…³èµ„æ–™å’Œåšå®¢å‡ ä¹æ²¡æœ‰ï¼Œå› æ­¤æˆ‘æ¥è¯•ç€å†™ä¸€ä¸‹å¦‚ä½•ä½¿ç”¨å®ƒï¼Œä»¥åŠå®ƒçš„åŸç†ï¼Œè¿˜ä¼šåŒ…å«æºç ç²—ç•¥è§£è¯»ï¼Œpolybrush.jsçš„githubå‚è€ƒé¡¹ç›®ä¸‹è½½åœ°å€æ˜¯ï¼š<a href="https://gist.github.com/GerHobbelt/3732612" target="_blank" rel="external">https://gist.github.com/GerHobbelt/3732612</a></p><p>å­¦ä¹ ä¸€ä¸ªä¸œè¥¿ï¼Œå¤§æŠµæœ‰ä¸‰å±‚å¢ƒç•Œï¼Œç¬¬ä¸€ï¼Œä¼šä½¿ç”¨å®ƒï¼Œç¬¬äºŒï¼ŒçŸ¥é“ä»–çš„åŸç†ï¼Œç¬¬ä¸‰ï¼ŒçŸ¥å…¶ç„¶ä¹ŸçŸ¥å…¶æ‰€ä»¥ç„¶ã€‚è¿™ä¹Ÿæ˜¯æœ¬æ–‡æ¥ä¸‹æ¥ä¸‰ç« çš„ç»„ç»‡æ–¹å¼ï¼Œé¦–å…ˆï¼Œä»‹ç»æœ€åŸºæœ¬çš„å¦‚ä½•ä½¿ç”¨ï¼Œå†å»è¯•ç€è§£é‡ŠåŸç†ï¼Œæœ€åæ·±å…¥åˆ°ä»£ç çº§ã€‚</p><h1 id="å¦‚ä½•ä½¿ç”¨"><a href="#å¦‚ä½•ä½¿ç”¨" class="headerlink" title="å¦‚ä½•ä½¿ç”¨"></a>å¦‚ä½•ä½¿ç”¨</h1><h2 id="ä¸brushç›¸åŒçš„åœ°æ–¹"><a href="#ä¸brushç›¸åŒçš„åœ°æ–¹" class="headerlink" title="ä¸brushç›¸åŒçš„åœ°æ–¹"></a>ä¸brushç›¸åŒçš„åœ°æ–¹</h2><p>ä½¿ç”¨polybrushï¼Œå‡ ä¹å’Œä½¿ç”¨d3å†…ç½®çš„brushä¸€æ ·æ–¹ä¾¿ï¼Œä»…éœ€ä¸€è¡Œå°±å¯ä»¥å»ºç«‹ä¸€ä¸ªpolybrushçš„é€‰æ‹©é›†ï¼švar brush = d3.svg.polybrush();  è¿™å’Œbrushå‡ ä¹æ˜¯ä¸€æ ·çš„ï¼›<br>åŒæ ·ç›¸åŒçš„è¿˜æœ‰brushçš„ä¸‰ä¸ªè¿‡ç¨‹ï¼šbrush(),brushStart(),burshFinished() ï¼Œåœ¨è¿™ä¸‰ä¸ªè¿‡ç¨‹ä¸­æ·»åŠ ç›¸åº”çš„å¤„ç†é€»è¾‘çš„ä»£ç ï¼Œå®ŒæˆæŒ‡å®šçš„actionã€‚ä¸ç†Ÿæ‚‰çš„å¯ä»¥å»çœ‹æˆ‘ä¹‹å‰å†™çš„brushçš„åšå®¢ã€‚</p><h2 id="ä¸brushä¸åŒçš„åœ°æ–¹"><a href="#ä¸brushä¸åŒçš„åœ°æ–¹" class="headerlink" title="ä¸brushä¸åŒçš„åœ°æ–¹"></a>ä¸brushä¸åŒçš„åœ°æ–¹</h2><p>ä¸brushä¸åŒçš„åœ°æ–¹ä¹Ÿå¾ˆæ˜¾ç„¶ï¼Œå°±æ˜¯å¦‚ä½•åˆ¤å®šä¸€ä¸ªå…ƒç´ åœ¨è¿˜æ˜¯ä¸åœ¨é€‰æ‹©é›†åˆä¸­ã€‚ä¹‹å‰çš„brushå‡ºæ¥çš„å½¢çŠ¶æ˜¯ä¸€ä¸ªçŸ©å½¢ï¼ŒçŸ©å½¢çš„å››ä¸ªè§’çš„åæ ‡éƒ½æœ‰ï¼Œåˆ¤æ–­å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¥å®Œæˆï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">  var extent = brush.extent();</div><div class="line">var xmin = extent[0]()[0]();</div><div class="line">var xmax = extent[1]()[0]();</div><div class="line">var ymin = extent[0]()[1]();</div><div class="line">var ymax = extent[1]()[1]();</div><div class="line"></div><div class="line"> if(d[0]()\&gt;=xmin &amp;&amp; d[0]()\&lt;=xmax &amp;&amp; d[1]()\&gt;=ymin &amp;&amp; d[1]()\&lt;=ymax)&#123;</div><div class="line">//åœ¨brushçš„åŒºåŸŸå†…</div><div class="line">&#125;else&#123;</div><div class="line">//ä¸åœ¨brushçš„åŒºåŸŸå†…</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure><br>é‚£ç°åœ¨æˆ‘ä»¬brushå‡ºæ¥çš„é‚£ä¸ªå¥‡æ€ªçš„å½¢çŠ¶è¯¥å¦‚ä½•æ¥åˆ¤å®šå‘¢ï¼Ÿè¿˜å¥½ï¼ŒGeoffrey T. Bellæ›¿ä½ å®Œæˆäº†è¿™éƒ¨åˆ†çš„åˆ¤å®šï¼Œä½ åªéœ€è¦è°ƒç”¨if(brush.isWithinExtent(x,y))å°±å¯ä»¥äº†ï¼è‡³æ­¤ï¼Œä½ è¾¾åˆ°äº†polybrushçš„ç¬¬ä¸€å±‚å¢ƒç•Œï¼Œå³å­¦ä¼šäº†ä½¿ç”¨å®ƒã€‚å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥éœ€è¦ä»‹ç»çš„æ˜¯å¦‚ä½•åˆ¤æ–­ç‚¹åœ¨è¿˜æ˜¯ä¸åœ¨polybrushé€‰ä¸­çš„é‚£å—åŒºåŸŸé‡Œé¢ã€‚</p><h2 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h2><p>æˆ‘è¿™å®ç°äº†ä¸€ä¸ªä½¿ç”¨polybrushçš„æœ€ç®€å•çš„ä¾‹å­ï¼Œåœ¨å‰é¢åšå®¢ä¸­å†™åˆ°çš„æ•£ç‚¹å›¾çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†polybrushçš„æ“ä½œã€‚</p><blockquote><p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯åˆ¤æ–­æ˜¯å¦åœ¨brushçš„åŒºåŸŸå†…ï¼Œä¼ å…¥çš„å‚æ•°ä¸æ˜¯dã€0ã€‘å’Œdã€1ã€‘, è€Œæ˜¯åæ ‡ï¼Œx(d.x),y(d.y),å› ä¸ºä¼ å…¥çš„d.x d.yå·²ç»ç»è¿‡äº†å˜æ¢äº†ã€‚</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;!DOCTYPE html\&gt;</div><div class="line">\&lt;html\&gt;</div><div class="line">\&lt;head lang=&quot;en&quot;\&gt;</div><div class="line">\&lt;meta charset=&quot;UTF-8&quot;\&gt;</div><div class="line">\&lt;script type=&quot;text/javascript&quot; src=&quot;script/d3.v3.js&quot;\&gt; \&lt;/script\&gt;</div><div class="line">\&lt;script src=&quot;polybrush.js&quot;\&gt;\&lt;/script\&gt;</div><div class="line">\&lt;title\&gt;\&lt;/title\&gt;</div><div class="line">\&lt;style type=&quot;text/css&quot;\&gt;</div><div class="line"></div><div class="line">.brush .extent &#123;</div><div class="line">stroke: #000;</div><div class="line">stroke-width: 1.5px;</div><div class="line">fill: #000;</div><div class="line">fill-opacity: 0.3;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.point.selected &#123;</div><div class="line">fill: red;</div><div class="line">stroke: darkred;</div><div class="line">stroke-width: 2;</div><div class="line">&#125;</div><div class="line">.point &#123;</div><div class="line">fill: steelblue;</div><div class="line">/*stroke: #000;*/</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">.axis path,</div><div class="line">.axis line &#123;</div><div class="line">fill: none;</div><div class="line">stroke: #000;</div><div class="line">shape-rendering: crispEdges;</div><div class="line">&#125;</div><div class="line"></div><div class="line">\&lt;/style\&gt;</div><div class="line">\&lt;/head\&gt;</div><div class="line">\&lt;body\&gt;</div><div class="line"></div><div class="line">\&lt;script\&gt;</div><div class="line"></div><div class="line">var margin = &#123;top:20,right:20,bottom:20,left:20&#125;;</div><div class="line">var width= 960-margin.left-margin.right;</div><div class="line">var height = 500-margin.top-margin.bottom;</div><div class="line"></div><div class="line">var x = d3.scale.linear().range([0,width]());</div><div class="line">var y = d3.scale.linear().range([height,0]());</div><div class="line"></div><div class="line">var svg = d3.select(&apos;body&apos;).append(&apos;svg&apos;).attr(&apos;width&apos;,width+margin.left+margin.right).attr(&apos;height&apos;,height+margin.top+margin.bottom)</div><div class="line">.append(&apos;g&apos;)</div><div class="line">.attr(&apos;transform&apos;,&quot;translate(&quot;+margin.left+&quot;,&quot;+margin.top+&quot;)&quot;);</div><div class="line"></div><div class="line">d3.csv(&apos;tmp.csv&apos;,function(error,data)&#123;</div><div class="line"></div><div class="line">if(error) throw  error;</div><div class="line"></div><div class="line">data.forEach(function(d)&#123;</div><div class="line">d.x=+d.x;</div><div class="line">d.y=+d.y;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">x.domain(d3.extent(data,function(d)&#123;return d.x&#125;)).nice();</div><div class="line">y.domain(d3.extent(data,function(d)&#123;return d.y&#125;)).nice();</div><div class="line"></div><div class="line">svg.append(&apos;g&apos;)</div><div class="line">.attr(&apos;class&apos;,&apos;x axis&apos;)</div><div class="line">.attr(&apos;transform&apos;,&apos;translate(0,&apos;+height+&quot;)&quot;)</div><div class="line">.call(d3.svg.axis().scale(x).orient(&apos;bottom&apos;));</div><div class="line"></div><div class="line">svg.append(&apos;g&apos;)</div><div class="line">.attr(&quot;class&quot;,&apos;y axis&apos;)</div><div class="line">.call(d3.svg.axis().scale(y).orient(&apos;left&apos;));</div><div class="line"></div><div class="line">svg.selectAll(&apos;.point&apos;)</div><div class="line">.data(data).enter()</div><div class="line">.append(&apos;circle&apos;)</div><div class="line">.attr(&apos;class&apos;,&apos;point&apos;)</div><div class="line">//                .attr(&apos;d&apos;,d3.svg.symbol().type(&apos;triangle-up&apos;))</div><div class="line">.attr(&apos;cx&apos;, function(d) &#123; return d[0](); &#125;)</div><div class="line">.attr(&apos;cy&apos;, function(d) &#123; return d[1](); &#125;)</div><div class="line">.attr(&apos;r&apos;, 15)</div><div class="line">.attr(&apos;transform&apos;,function(d)&#123;return &quot;translate(&quot; +</div><div class="line">&quot;&quot;+x(d.x)+&quot;,&quot;+y(d.y)+&quot;)&quot;&#125;);</div><div class="line"></div><div class="line"></div><div class="line">var brush = d3.svg.polybrush()</div><div class="line">.x(d3.scale.linear().range([0,width]()))</div><div class="line">.y(d3.scale.linear().range([0,height]()))</div><div class="line">.on(&apos;brushstart&apos;,function()&#123;</div><div class="line">svg.selectAll(&apos;.point&apos;).classed(&apos;selected&apos;,false);</div><div class="line">&#125;)</div><div class="line">.on(&apos;brush&apos;,function()&#123;</div><div class="line">svg.selectAll(&apos;.point&apos;).classed(&apos;selected&apos;,function(d)&#123;</div><div class="line">console.log(d);</div><div class="line">if(brush.isWithinExtent(x(d.x), y(d.y)))</div><div class="line">&#123;</div><div class="line">console.log(&apos;helo&apos;)</div><div class="line">return true;</div><div class="line">&#125;else&#123;</div><div class="line">console.log(&apos;no&apos;)</div><div class="line">return false;</div><div class="line">&#125;</div><div class="line">&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line">svg.append(&apos;svg:g&apos;)</div><div class="line">.attr(&apos;class&apos;,&apos;brush&apos;)</div><div class="line">.call(brush);</div><div class="line"></div><div class="line"></div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line">\&lt;/script\&gt;</div><div class="line"></div><div class="line">\&lt;/body\&gt;</div><div class="line">\&lt;/html\&gt;</div><div class="line"></div></pre></td></tr></table></figure><h1 id="Ray-casting-algorithm"><a href="#Ray-casting-algorithm" class="headerlink" title="Ray casting algorithm"></a>Ray casting algorithm</h1><p>åˆ¤æ–­æŸä¸ªç‚¹åœ¨è¿˜æ˜¯ä¸åœ¨polybrushé€‰ä¸­çš„åŒºåŸŸä¸­ï¼Œç”¨çš„æ˜¯å›¾å½¢å­¦ä¸­çš„Ray castingç®—æ³•ã€‚å®ƒçš„æ€æƒ³å¾ˆç®€å•ï¼Œä½œä¸€æ¡ä»¥ç‚¹ä¸ºèµ·ç‚¹ï¼Œä¸”å¹³è¡Œäºxè½´çš„çº¿ï¼Œæ•°ä¸brushäº§ç”Ÿçš„å‡¹å¤šè¾¹å½¢è¾¹ç›¸äº¤çš„æ¬¡æ•°nï¼Œæ ¹æ®nçš„å¥‡å¶æ€§æ¥åˆ¤æ–­ç‚¹æ˜¯åœ¨é‡Œé¢è¿˜æ˜¯åœ¨å¤–é¢ã€‚å¦‚æœåœ¨é‡Œé¢ï¼Œnæ˜¯å¥‡æ•°ï¼Œåä¹‹åˆ™ä¸ºå¶æ•°ã€‚<br>å¯ä»¥å€ŸåŠ©ä¸‹é¢çš„è¿™å¹…å›¾æ¥å¾ˆå¥½çš„ç†è§£è¿™ä¸ªç®—æ³•ï¼š<br><img src="http://i2.piimg.com/d26d48e5812578c8.png" alt=""></p><h1 id="æ·±å…¥æºç "><a href="#æ·±å…¥æºç " class="headerlink" title="æ·±å…¥æºç "></a>æ·±å…¥æºç </h1><p>ç»ˆäºåˆ°ç¬¬ä¸‰å±‚å¢ƒç•Œï¼Œä¹Ÿæ˜¯æœ€éš¾å•ƒçš„ä¸€å—ç¡¬éª¨å¤´äº†ã€‚é¦–å…ˆï¼Œä½œä¸ºä¸€ä¸ªd3çš„æ’ä»¶ï¼Œéœ€è¦ç”¨å¦‚ä¸‹çš„ä»£ç æ¥åŒ…ä½æ•´ä¸ªçš„ä»£ç å—ï¼Œè¿™æ˜¯jsç§çš„ç«‹å³å‡½æ•°ï¼Œå¼•å…¥ä»£ç æ®µä¹‹åä¼šç«‹å³æ‰§è¡Œï¼Œå¹¶return ç›¸åº”çš„ç»“æœã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">(function(d3) &#123;</div><div class="line">  d3.svg.polybrush = function() &#123;</div><div class="line">â€¦</div><div class="line">&#125;)(d3)</div><div class="line"></div></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥å®šä¹‰äº†ä¸€ä¸ªç±»ä¼¼å¹¿æ’­çš„dispatchï¼Œå®šä¹‰äº†ä¸‰ç§ç±»ä¼¼brushä¸­å¯ä»¥ç›‘å¬çš„è¡Œä¸ºï¼Œbrush start,brush,brushed,è¿™æ ·å°±å¯ä»¥ç”¨.on(â€œbrushâ€,function(){})æ¥è¿›è¡Œç›‘å¬å¹¶æä¾›å¤„ç†çš„å‡½æ•°äº†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"> var dispatch = d3.dispatch(&quot;brushstart&quot;, &quot;brush&quot;, &quot;brushend&quot;),</div><div class="line">x = null,</div><div class="line">y = null,</div><div class="line">extent = [](),</div><div class="line">firstClick = true,</div><div class="line">firstTime = true,</div><div class="line">wasDragged = false,</div><div class="line">origin = null,</div><div class="line">line = d3.svg.line()</div><div class="line">  .x(function(d) &#123;</div><div class="line">return d[0]();</div><div class="line">  &#125;)</div><div class="line">  .y(function(d) &#123;</div><div class="line">return d[1]();</div><div class="line">  &#125;);</div><div class="line"></div><div class="line"> d3.rebind(brush, dispatch, &quot;on&quot;);</div><div class="line"></div></pre></td></tr></table></figure><p>è¿˜å®šä¹‰äº†ä¸€äº›å˜é‡ï¼Œx,y,extent,ç­‰ï¼Œè¿™äº›å˜é‡éƒ½æ˜¯ä¸ºäº†é…åˆä¸‹é¢çš„æ“ä½œè®¾ç«‹çš„ï¼Œä»åå­—å°±å¯ä»¥çœ‹å‡ºä¸€äº›å˜é‡çš„ä½œç”¨ã€‚<br>lineæ˜¯ç”±èµ·ç‚¹å’Œç»ˆç‚¹ç»„æˆçš„ï¼Œè€Œç‰¹å®šç‚¹çš„xï¼Œyåæ ‡åœ¨è¿™æ®µä»£ç ä¸­è¢«åˆ†åˆ«æŒ‡å®šå¥½ã€‚</p><p>brushå‡½æ•°ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">var brush = function(g) &#123;</div><div class="line">  g.each(function() &#123;</div><div class="line">var bg, e, fg;</div><div class="line">g = d3.select(this);</div><div class="line">bg = g.selectAll(&quot;.background&quot;).data([0]());</div><div class="line">fg = g.selectAll(&quot;.extent&quot;).data([extent]());</div><div class="line">g.style(&quot;pointer-events&quot;, &quot;all&quot;).on(&quot;click.brush&quot;, addAnchor);</div><div class="line">bg.enter().append(&quot;rect&quot;).attr(&quot;class&quot;, &quot;background&quot;).style(&quot;visibility&quot;, &quot;hidden&quot;).style(&quot;cursor&quot;, &quot;crosshair&quot;);</div><div class="line">fg.enter().append(&quot;path&quot;).attr(&quot;class&quot;, &quot;extent&quot;).style(&quot;cursor&quot;, &quot;move&quot;);</div><div class="line">if (x) &#123;</div><div class="line">  e = scaleExtent(x.range());</div><div class="line">  bg.attr(&quot;x&quot;, e[0]()).attr(&quot;width&quot;, e[1]() - e[0]());</div><div class="line">&#125;</div><div class="line">if (y) &#123;</div><div class="line">  e = scaleExtent(y.range());</div><div class="line">  bg.attr(&quot;y&quot;, e[0]()).attr(&quot;height&quot;, e[1]() - e[0]());</div><div class="line">&#125;</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div></pre></td></tr></table></figure><br>é€‰å‡ºå‰æ™¯èƒŒæ™¯ï¼Œå¹¶æ·»åŠ å¯¹åº”çš„classï¼Œä½¿å¾—å‰æ™¯å’ŒèƒŒæ™¯åŒºåˆ†å¼€ã€‚è¿˜æ·»åŠ äº†å¯¹å‰æ™¯èƒŒæ™¯ç§»åŠ¨æ—¶çš„é‡æ–°åˆ¤æ–­ã€‚<br>ç›‘å¬brushè¿‡ç¨‹ä¸­çš„ç‚¹å‡»äº‹ä»¶ï¼Œè¿›è¡Œæ·»åŠ é”šç‚¹addAnchorçš„æ“ä½œã€‚<br>æ¥ä¸‹æ¥æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç»˜åˆ¶å·²æœ‰çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªæ˜¯å°†domainçš„startå’ŒstopæŒ‰ç…§ä»å°åˆ°å¤§çš„é¡ºåºæ’å¥½ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">var drawPath = function() &#123;</div><div class="line">  return d3.selectAll(&quot;g.brush path&quot;).attr(&quot;d&quot;, function(d) &#123;</div><div class="line"></div><div class="line">return line(d) + &quot;Z&quot;;</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line">var scaleExtent = function(domain) &#123;</div><div class="line">  var start, stop;</div><div class="line">  start = domain[0]();</div><div class="line">  stop = domain[domain.length - 1]();</div><div class="line">  if (start \&lt; stop) &#123;</div><div class="line">return [start, stop]();</div><div class="line">  &#125; else &#123;</div><div class="line">return [stop, start]();</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div></pre></td></tr></table></figure></p><p>ä¸‹é¢è¿˜æœ‰ä¸€äº›è¾…åŠ©å‡½æ•°ï¼Œä»å‡½æ•°çš„åå­—ä¸Šå°±å¯ä»¥å¾ˆæ¸…æ¥šçš„çŸ¥é“å‡½æ•°çš„ä½œç”¨ï¼Œè¿™é‡Œä¸å¤šåšè§£é‡Šäº†ï¼Œæ²¡æœ‰å¤ªå¤šå€¼å¾—è¯´çš„ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">var withinBounds = function(point) &#123;</div><div class="line">  var rangeX, rangeY, \_x,Â \_y;</div><div class="line">  rangeX = scaleExtent(x.range());</div><div class="line">  rangeY = scaleExtent(y.range());</div><div class="line">  \_x = Math.max(rangeX[0](), Math.min(rangeX[1](), point[0]()));</div><div class="line">  \_y = Math.max(rangeY[0](), Math.min(rangeY[1](), point[1]()));</div><div class="line">  return point[0]() === \_x &amp;&amp; point[1]() ===Â \_y;</div><div class="line">&#125;;</div><div class="line">var moveAnchor = function(target) &#123;</div><div class="line">  var moved, point;</div><div class="line">  point = d3.mouse(target);</div><div class="line">  if (firstTime) &#123;</div><div class="line">extent.push(point);</div><div class="line">firstTime = false;</div><div class="line">  &#125; else &#123;</div><div class="line">if (withinBounds(point)) &#123;</div><div class="line">  extent.splice(extent.length - 1, 1, point);</div><div class="line">&#125;</div><div class="line">drawPath();</div><div class="line">dispatch.brush();</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line">var closePath = function() &#123;</div><div class="line">  var w;</div><div class="line">  w = d3.select(window);</div><div class="line">  w.on(&quot;dblclick.brush&quot;, null).on(&quot;mousemove.brush&quot;, null);</div><div class="line">  firstClick = true;</div><div class="line">  if (extent.length === 2 &amp;&amp; extent[0]()[0]() === extent[1]()[0]() &amp;&amp; extent[0]()[1]() === extent[1]()[1]()) &#123;</div><div class="line">extent.splice(0, extent.length);</div><div class="line">  &#125;</div><div class="line">  d3.select(&quot;.extent&quot;).on(&quot;mousedown.brush&quot;, moveExtent);</div><div class="line">  return dispatch.brushend();</div><div class="line">&#125;;</div><div class="line">var addAnchor = function() &#123;</div><div class="line">  var g, w,</div><div class="line">\_this = this;</div><div class="line">  g = d3.select(this);</div><div class="line">  w = d3.select(window);</div><div class="line">  firstTime = true;</div><div class="line">  if (wasDragged) &#123;</div><div class="line">wasDragged = false;</div><div class="line">return;</div><div class="line">  &#125;</div><div class="line">  if (firstClick) &#123;</div><div class="line">extent.splice(0, extent.length);</div><div class="line">firstClick = false;</div><div class="line">d3.select(&quot;.extent&quot;).on(&quot;mousedown.brush&quot;, null);</div><div class="line">w.on(&quot;mousemove.brush&quot;, function() &#123;</div><div class="line">  return moveAnchor(\_this);</div><div class="line">&#125;).on(&quot;dblclick.brush&quot;, closePath);</div><div class="line">dispatch.brushstart();</div><div class="line">  &#125;</div><div class="line">  if (extent.length \&gt; 1) &#123;</div><div class="line">extent.pop();</div><div class="line">  &#125;</div><div class="line">  extent.push(d3.mouse(this));</div><div class="line">  return drawPath();</div><div class="line">&#125;;</div><div class="line">var dragExtent = function(target) &#123;</div><div class="line">  var checkBounds, fail, p, point, scaleX, scaleY, updateExtentPoint, \_i,Â \_j,Â \_len,Â \_len1;</div><div class="line">  point = d3.mouse(target);</div><div class="line">  scaleX = point[0]() - origin[0]();</div><div class="line">  scaleY = point[1]() - origin[1]();</div><div class="line">  fail = false;</div><div class="line">  origin = point;</div><div class="line">  updateExtentPoint = function(p) &#123;</div><div class="line">p[0]() += scaleX;</div><div class="line">p[1]() += scaleY;</div><div class="line">  &#125;;</div><div class="line">  for (\_i = 0,Â \_len = extent.length;Â \_i \&lt;Â \_len; \_i++) &#123;</div><div class="line">p = extent[\_i]();</div><div class="line">updateExtentPoint(p);</div><div class="line">  &#125;</div><div class="line">  checkBounds = function(p) &#123;</div><div class="line">if (!withinBounds(p)) &#123;</div><div class="line">  fail = true;</div><div class="line">&#125;</div><div class="line">return fail;</div><div class="line">  &#125;;</div><div class="line">  for (\_j = 0,Â \_len1 = extent.length;Â \_j \&lt;Â \_len1; \_j++) &#123;</div><div class="line">p = extent[\_j]();</div><div class="line">checkBounds(p);</div><div class="line">  &#125;</div><div class="line">  if (fail) &#123;</div><div class="line">return;</div><div class="line">  &#125;</div><div class="line">  drawPath();</div><div class="line">  return dispatch.brush(&#123;</div><div class="line">mode: &quot;move&quot;</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line">var dragStop = function() &#123;</div><div class="line">  var w;</div><div class="line">  w = d3.select(window);</div><div class="line">  w.on(&quot;mousemove.brush&quot;, null).on(&quot;mouseup.brush&quot;, null);</div><div class="line">  wasDragged = true;</div><div class="line">  return dispatch.brushend();</div><div class="line">&#125;;</div><div class="line">var moveExtent = function() &#123;</div><div class="line">  var \_this = this;</div><div class="line">  d3.event.stopPropagation();</div><div class="line">  d3.event.preventDefault();</div><div class="line">  if (firstClick &amp;&amp; !brush.empty()) &#123;</div><div class="line">d3.select(window).on(&quot;mousemove.brush&quot;, function() &#123;</div><div class="line">  return dragExtent(\_this);</div><div class="line">&#125;).on(&quot;mouseup.brush&quot;, dragStop);</div><div class="line">origin = d3.mouse(this);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div></pre></td></tr></table></figure></p><p>æœ€åéœ€è¦è¯´ä¸€ä¸‹çš„æ˜¯isWithinExtentå‡½æ•°ï¼Œåº”è¯¥å¯ä»¥ç®—ä½œæ˜¯ä¸Šä¸€ç« èŠ‚ä¸­æåˆ°çš„ray castingç®—æ³•çš„ä¸€ä¸ªjsç‰ˆæœ¬çš„å®ç°ã€‚å…¶ä¸­ï¼Œæ•°å¥‡å¶æ˜¯ç”±retæ¥å®Œæˆçš„ã€‚åªä¸è¿‡å®ç°ä¸­ï¼Œä»–æ˜¯ç”¨å–åæ“ä½œ!æ¥å®Œæˆçš„ï¼Œæ²¡æœ‰ç”¨è‡ªå¢++æ“ä½œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">brush.clear = function() &#123;</div><div class="line">  extent.splice(0, extent.length);</div><div class="line">  return brush;</div><div class="line">&#125;;</div><div class="line">brush.empty = function() &#123;</div><div class="line">  return extent.length === 0;</div><div class="line">&#125;;</div><div class="line"></div></pre></td></tr></table></figure><p>clearå‡½æ•°æ˜¯ç”¨æ¥æ¸…ç©ºbrushçš„åŒºåŸŸçš„ï¼Œemptyæ˜¯ç”¨æ¥åˆ¤æ–­æ˜¯å¦æœ‰åŒºåŸŸè¢«brushäº†ã€‚å’Œä¸Šé¢çš„é‚£äº›æ²¡æœ‰ç‰¹åˆ«è¯´æ˜çš„å‡½æ•°ä¸€æ ·ï¼Œè¿™äº›æ˜¯è¾…åŠ©å®Œæˆpolybrushæ“ä½œçš„å‡½æ•°ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯è¾…åŠ©å‡½æ•°ã€‚</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è‡³æ­¤ï¼Œç®—æ˜¯ç²—ç•¥çš„å®Œæˆäº†polybrushç›¸å…³çš„ä»‹ç»ï¼Œä»å¼€å§‹çš„å¦‚ä½•ä½¿ç”¨ï¼Œåˆ°å®ƒä¸brushçš„å¼‚åŒç‚¹ï¼Œåˆ°æœ€åçš„æºä»£ç çš„æ³›è¯»ã€‚å¸Œæœ›æœ¬æ–‡èƒ½å¯¹è¯»è€…æœ‰æ‰€å¸®åŠ©ï¼Œé‚£ä¼šæ˜¯æˆ‘æœ€å¤§çš„æ¬£æ…°ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;http://i3.piimg.com/0e2d18cf43f9f605.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ä½ æ˜¯å¦
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>D3 on Angular(2)</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/D3%20on%20Angular(2)/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/D3 on Angular(2)/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-24T04:15:24.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="More-Dynamic-visualizations"><a href="#More-Dynamic-visualizations" class="headerlink" title="More Dynamic visualizations"></a>More Dynamic visualizations</h1><p>ä¸Šä¸€ç¯‡åšå®¢ä»‹ç»äº†å¦‚ä½•å€ŸåŠ©Angularæ¥å®Œæˆä¸€ä¸ªæŒ‡ä»¤ï¼Œè¾¾åˆ°å¯å¤ç”¨ç›®çš„ï¼Œä½†æ˜¯ä¼¼ä¹ä¾ç„¶ä¸å¤ŸåŠ¨æ€ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æå‰è¾“å…¥æƒ³è¦å±•ç¤ºçš„æ•°ç»„ã€‚<br>Angularçš„æœ€å¤§çš„ç‰¹ç‚¹æ˜¯åŒå‘æ•°æ®ç»‘å®šï¼Œæˆ‘ä»¬èƒ½å¦å€ŸåŠ©è¿™ä¸ªç‰¹æ€§æ¥å®Œæˆæ›´åŠ¨æ€çš„å¯è§†åŒ–å›¾å‘¢ï¼Ÿè®©Angularå¸®æˆ‘ä»¬ç›¯ç€æ•°æ®ï¼Œä¸€æ—¦æ•°æ®æ”¹å˜äº†ï¼Œå°±æ›´æ–°DOMå…ƒç´ ã€‚è¿™ä¸€åˆ‡éƒ½æ˜¯Angularå¸®æˆ‘ä»¬å®Œæˆçš„ï¼Œæˆ‘ä»¬å”¯ä¸€éœ€è¦åšçš„æ˜¯æŒ‡å®šæ•°æ®å’ŒDOMå…ƒç´ ä¹‹é—´çš„å…³ç³»ï¼Œä¸éœ€è¦å†™å¾ˆå¤šçš„ä»£ç ã€‚</p><h1 id="åŒå‘æ•°æ®ç»‘å®š"><a href="#åŒå‘æ•°æ®ç»‘å®š" class="headerlink" title="åŒå‘æ•°æ®ç»‘å®š"></a>åŒå‘æ•°æ®ç»‘å®š</h1><p>å…ˆæ¥ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥å±•ç¤ºä¸€ä¸‹Angularå¸®æˆ‘ä»¬å®Œæˆçš„åŒå‘æ•°æ®ç»‘å®šï¼Œè¿™é‡Œç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥å±•ç¤ºä¸€ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//\&lt;body ng-app\&gt;</div><div class="line">//\&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt; </div><div class="line">//\&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt;</div><div class="line">// \&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt; </div><div class="line">//\&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt;</div><div class="line">//\&lt;/body\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†å››æ ¹sliders,å½“æˆ‘ä»¬ä»»æ„æ»‘åŠ¨ä¸€ä¸ªsliderï¼Œå…¶ä»–çš„ä¸‰ä¸ªä¹Ÿä¼šè·Ÿç€ä¸€èµ·åŠ¨ã€‚<br>è¿™ç§è‡ªåŠ¨æ›´æ–°å‘ç”Ÿåœ¨å«åšscopeçš„å˜é‡ä¸­ï¼Œä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œng-modelæŒ‡ä»¤åœ¨scopeåˆ›å»ºäº†ä¸€ä¸ªå«ourRangeValueçš„å˜é‡ï¼Œè€Œä¸”å½“ourRangeValueæ”¹å˜çš„æ—¶å€™ï¼Œä¼šå¤„ç†\<input\>çš„æ›´æ–°ã€‚å¦‚æœæˆ‘ä»¬åœ¨ä¸€ä¸ªæ–°çš„DOMå…ƒç´ ä¸Šåˆ›å»ºä¸€ä¸ªscopeï¼Œå®ƒæ‰€æœ‰çš„å­DOMå…ƒç´ éƒ½å¯ä»¥æ‹¿è¿™ä¸ªscopeï¼Œæœ€é¡¶å±‚çš„scopeæ˜¯root scopeã€‚æœ€ç®€å•çš„åˆ›å»ºscopeçš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªcontrollerï¼ˆæ§åˆ¶å™¨ï¼‰ã€‚</input\></p><h2 id="ä¸¤ç§å˜ä½“"><a href="#ä¸¤ç§å˜ä½“" class="headerlink" title="ä¸¤ç§å˜ä½“"></a>ä¸¤ç§å˜ä½“</h2><p>å˜ä½“1ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//\&lt;body ng-app=&quot;myApp&quot;\&gt;</div><div class="line">//  \&lt;div ng-controller=&quot;HelloController&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt;</div><div class="line">//  \&lt;/div\&gt;</div><div class="line">//  \&lt;div ng-controller=&quot;HelloController&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;ourRangeValue&quot;\&gt;</div><div class="line">//  \&lt;/div\&gt;</div><div class="line">//\&lt;/body\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>å˜ä½“2ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//\&lt;body ng-app=&quot;myApp&quot; ng-init=&quot;foobar = &#123; value: 50 &#125;&quot;\&gt;</div><div class="line">//  \&lt;div ng-controller=&quot;HelloController&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;foobar.value&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;foobar.value&quot;\&gt;</div><div class="line">//  \&lt;/div\&gt;</div><div class="line">//  \&lt;div ng-controller=&quot;HelloController&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;foobar.value&quot;\&gt;</div><div class="line">//    \&lt;input type=&quot;range&quot; ng-model=&quot;foobar.value&quot;\&gt;</div><div class="line">//  \&lt;/div\&gt;</div><div class="line">//    \&lt;/body\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>è¿™ä¸¤ç§å˜ä½“æ ¼å„è‡ªçš„ç»“æœæ˜¯ä»€ä¹ˆï¼Œè¿™åº”è¯¥æ˜¯Angularçš„åŸºç¡€çŸ¥è¯†ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±å»å°è¯•ä¸€ä¸‹ã€‚ç¬¬ä¸€ç§æƒ…å†µæ”¹å˜ç¬¬ä¸€ä¸ªHelloControllerçš„foobaræ—¶å€™ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„scope1.foobaræ›¿ä»£rootScope.foobarã€‚è€Œç¬¬äºŒç§æƒ…å†µï¼Œæ˜¯ä½¿ç”¨äº†å¦ä¸€ä¸ªobjectåŒ…è£…äº†ä¸€ä¸‹ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…è¦†ç›–æ‰çˆ¶scopeçš„å±æ€§ã€‚è¿™æ ·æˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šä¸€ä¸ªæ–°çš„å€¼ç»™foobarï¼Œæ‰€ä»¥å­scopeä¸éœ€è¦é‡æ–°åˆ›å»ºæ–°çš„objectã€‚</p><h1 id="Make-visualizations-dynamic-with-watch"><a href="#Make-visualizations-dynamic-with-watch" class="headerlink" title="Make visualizations dynamic with $watch"></a>Make visualizations dynamic with $watch</h1><h2 id="scope-watch"><a href="#scope-watch" class="headerlink" title="$scope.watch"></a>$scope.watch</h2><p>ä½¿ç”¨Angularå†…ç½®çš„æŒ‡ä»¤ä½¿å¾—ç»‘å®šä¸€ä¸ªå€¼çš„å˜åŒ–åˆ°å¦ä¸€ä¸ªè§†å›¾ä¸­çš„å˜åŒ–å˜å¾—å¼‚å¸¸ç®€å•ï¼Œä¸è¿‡å¯¹äºç¨å¾®å¤æ‚ç‚¹çš„å¯è§†åŒ–å…ƒç´ ï¼Œæˆ‘ä»¬å°±éœ€è¦å‰ªå­è‡ªå·±çš„æŒ‡ä»¤å¹¶ç›‘å¬scopeå†…å€¼çš„å˜åŒ–å¹¶ä¸”æ›´æ–°ä»–ä»¬çš„å†…å®¹ã€‚Angularé‡Œç›‘å¬çš„å‡½æ•°æ˜¯$scope.watchå‡½æ•°ã€‚<br>ä¸‹é¢å±•ç¤ºä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;!-- scope.$watch(&apos;progress&apos;,function(progress)&#123;  </div><div class="line"> rect.attr(&#123;x: 0, y: 0, width: width \*Â progress / 100, height: height &#125;);  &#125;);  --\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>æ¯æ¬¡å½“sliderè¢«æ‹–åŠ¨ï¼Œä¸‹é¢çš„è¿›åº¦æ¡ä¼šè·Ÿç€åŠ¨ï¼Œå› ä¸ºæ­¤æ—¶scope.$watch()å‡½æ•°è¢«è§¦å‘äº†ã€‚</p><h2 id="ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­"><a href="#ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­"></a>ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­</h2><p>æˆ‘ä»¬å°†ä½¿ç”¨ä¸Šä¸€ç¯‡åšå®¢ä¸­ä½¿ç”¨çš„donut chartçš„ä¾‹å­ã€‚ä¸€ç§é”™è¯¯çš„åšæ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//\&lt;body ng-app=&quot;myApp&quot; ng-init=&quot;chart=[10, 20, 30]()&quot;\&gt;</div><div class="line">//  \&lt;input type=&quot;range&quot; ng-model=&quot;chart[0]()&quot;\&gt;</div><div class="line">//  \&lt;br\&gt;</div><div class="line">//  \&lt;input type=&quot;range&quot; ng-model=&quot;chart[1]()&quot;\&gt;</div><div class="line">//  \&lt;br\&gt;</div><div class="line">//  \&lt;input type=&quot;range&quot; ng-model=&quot;chart[2]()&quot;\&gt;</div><div class="line">//  \&lt;br\&gt;</div><div class="line">//  \&lt;donut-chart data=&quot;chart&quot;\&gt;\&lt;/donut-chart\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>å¥½åƒæ²¡æœ‰æŒ‰ç…§æˆ‘ä»¬é¢„æƒ³çš„å»åšï¼Œå› ä¸ºæ²¡æœ‰watchdata scopeå˜é‡çš„å˜åŒ–ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;!--  scope.$watch(&apos;data&apos;,function(data)&#123;</div><div class="line">   console.log(&quot;an element within `data` changed!&quot;);</div><div class="line">   console.log(data);</div><div class="line"> &#125;,true);</div><div class="line"> --\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>ä¸€ä¸ªå¾ˆå¤§çš„ä¸åŒæ˜¯æˆ‘ä»¬$watchå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯trueï¼Œtrueå‘Šè¯‰äº†watchå‡½æ•°ï¼Œå¦‚æœæ•°ç»„é‡Œé¢çš„å€¼å‘ç”Ÿäº†æ”¹å˜ä¹Ÿä¼šè§¦å‘ï¼Œfalseä¸ä¼šè§¦å‘ï¼Œå› ä¸ºæ•°ç»„è¿˜æ˜¯3ä¸ªå€¼ï¼Œå®ƒä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´å¹¶æ²¡å˜ã€‚<br>å®Œæ•´çš„ä»£ç ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//\&lt;!DOCTYPE html\&gt;</div><div class="line">//\&lt;html\&gt;</div><div class="line">//\&lt;head\&gt;</div><div class="line">//  \&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular.min.js&quot;\&gt;\&lt;/script\&gt;</div><div class="line">//  \&lt;script src=&quot;http://d3js.org/d3.v3.min.js&quot; charset=&quot;utf-8&quot;\&gt;\&lt;/script\&gt;</div><div class="line">//\&lt;/head\&gt;</div><div class="line">//\&lt;body ng-app=&quot;myApp&quot; ng-init=&quot;chart=[10, 20, 30]()&quot;\&gt;</div><div class="line">//  \&lt;input type=&quot;range&quot; ng-model=&quot;chart[0]()&quot;\&gt;</div><div class="line">//  \&lt;br\&gt;</div><div class="line">//  \&lt;input type=&quot;range&quot; ng-model=&quot;chart[1]()&quot;\&gt;</div><div class="line">//  \&lt;br\&gt;</div><div class="line">//  \&lt;input type=&quot;range&quot; ng-model=&quot;chart[2]()&quot;\&gt;</div><div class="line">//  \&lt;br\&gt;</div><div class="line">//  \&lt;donut-chart data=&quot;chart&quot;\&gt;\&lt;/donut-chart\&gt;</div><div class="line">//  \&lt;script\&gt;</div><div class="line">//    var myApp = angular.module(&apos;myApp&apos;, []());</div><div class="line">//    myApp.directive(&apos;donutChart&apos;, function()&#123;</div><div class="line">//      function link(scope, el, attr)&#123;</div><div class="line">//        var color = d3.scale.category10();</div><div class="line">//        var data = scope.data;</div><div class="line">//        var width = 300;</div><div class="line">//        var height = 300;</div><div class="line">//        var min = Math.min(width, height);</div><div class="line">//        var svg = d3.select(el[0]()).append(&apos;svg&apos;);</div><div class="line">//        var pie = d3.layout.pie().sort(null);</div><div class="line">//        var arc = d3.svg.arc()</div><div class="line">//          .outerRadius(min / 2 \*Â 0.9)</div><div class="line">//          .innerRadius(min / 2 \*Â 0.5);</div><div class="line">//  </div><div class="line">//        svg.attr(&#123;width: width, height: height&#125;);</div><div class="line">//        var g = svg.append(&apos;g&apos;)</div><div class="line">//          // center the donut chart</div><div class="line">//          .attr(&apos;transform&apos;, &apos;translate(&apos; + width / 2 + &apos;,&apos; + height / 2 + &apos;)&apos;);</div><div class="line">//  </div><div class="line">//        // add the \&lt;path\&gt;s for each arc slice</div><div class="line">//        var arcs = g.selectAll(&apos;path&apos;).data(pie(data))</div><div class="line">//          .enter().append(&apos;path&apos;)</div><div class="line">//            .style(&apos;stroke&apos;, &apos;white&apos;)</div><div class="line">//            .attr(&apos;fill&apos;, function(d, i)&#123; return color(i) &#125;);</div><div class="line">//</div><div class="line">//        scope.$watch(&apos;data&apos;, function()&#123;</div><div class="line">//          arcs.data(pie(data)).attr(&apos;d&apos;, arc);</div><div class="line">//        &#125;, true);</div><div class="line">//      &#125;</div><div class="line">//      return &#123;</div><div class="line">//        link: link,</div><div class="line">//        restrict: &apos;E&apos;,</div><div class="line">//        scope: &#123; data: &apos;=&apos; &#125;</div><div class="line">//      &#125;;</div><div class="line">//    &#125;);</div><div class="line">//  \&lt;/script\&gt;</div><div class="line">//\&lt;/body\&gt;</div><div class="line">//\&lt;/html\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>æˆ‘ä»¬çš„Donut chartçœ‹èµ·æ¥ä¸é”™ï¼Œä¼šéšç€sliderçš„å˜åŒ–è€Œå‘ç”Ÿå˜åŒ–äº†ï¼Œä½†æ˜¯ä¸€ç›´åªæœ‰ä¸‰ä¸ªsliderï¼Œè¿™ç¨å¾®æœ‰ç‚¹ä¸çˆ½ã€‚ä¸‹é¢æˆ‘ä»¬å°±å¢åŠ ä¸¤ä¸ªæŒ‰é’®ï¼Œä¸€ä¸ªæ˜¯å¢åŠ ä¸€ä¸ªå˜é‡ï¼Œä¸€ä¸ªæ˜¯å‡å°‘ä¸€ä¸ªå˜é‡ã€‚å…¶å®å‘¢ï¼Œå°±æ˜¯ç»™chartæ•°ç»„é‡Œpushä¸€ä¸ªæ•°æˆ–è€…popå‡ºä¸€ä¸ªæ•°ã€‚è€Œä¸ºäº†è®©sliderçš„æ•°ç›®ä¹Ÿéšç€æ•°ç»„çš„å˜åŒ–è€Œå˜åŒ–ï¼Œè¿™å°±éœ€è¦å€ŸåŠ©ng-repeatæŒ‡ä»¤ã€‚<br>\<inputtype="range" ng-model="slice" ng-repeat="slice in chart" \=""><br>è‡³æ­¤æˆ‘ä»¬å®Œæˆäº†æ‰€æœ‰çš„ä»»åŠ¡,å®Œæ•´ä»£ç å¦‚ä¸‹ã€‚</inputtype="range"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//\&lt;!DOCTYPE html\&gt;</div><div class="line">//\&lt;html\&gt;</div><div class="line">//\&lt;head\&gt;</div><div class="line">//  \&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular.js&quot;\&gt;\&lt;/script\&gt;</div><div class="line">//  \&lt;script src=&quot;http://d3js.org/d3.v3.js&quot; charset=&quot;utf-8&quot;\&gt;\&lt;/script\&gt;</div><div class="line">//\&lt;/head\&gt;</div><div class="line">//\&lt;body ng-app=&quot;myApp&quot; ng-init=&quot;chart=[&#123;value: 10&#125;, &#123;value: 20&#125;, &#123;value: 30&#125;]()&quot;\&gt;</div><div class="line">//  \&lt;donut-chart data=&quot;chart&quot; style=&quot;float:right&quot;\&gt;\&lt;/donut-chart\&gt;</div><div class="line">//  \&lt;button ng-click=&quot;chart.push(&#123;value: 10&#125;)&quot;\&gt;add slice\&lt;/button\&gt;</div><div class="line">//  \&lt;button ng-click=&quot;chart.pop()&quot;\&gt;remove slice\&lt;/button\&gt;</div><div class="line">//  \&lt;input type=&quot;range&quot; ng-model=&quot;slice.value&quot; ng-repeat=&quot;slice in chart track by $index&quot;\&gt;</div><div class="line">//  \&lt;script\&gt;</div><div class="line">//    var myApp = angular.module(&apos;myApp&apos;, []());</div><div class="line">//    myApp.directive(&apos;donutChart&apos;, function()&#123;</div><div class="line">//      function link(scope, el, attr)&#123;</div><div class="line">//        var color = d3.scale.category10();</div><div class="line">//        var width = 200;</div><div class="line">//        var height = 200;</div><div class="line">//        var min = Math.min(width, height);</div><div class="line">//        var svg = d3.select(el[0]()).append(&apos;svg&apos;);</div><div class="line">//        var pie = d3.layout.pie().sort(null);</div><div class="line">//        var arc = d3.svg.arc()</div><div class="line">//          .outerRadius(min / 2 \*Â 0.9)</div><div class="line">//          .innerRadius(min / 2 \*Â 0.5);</div><div class="line">//</div><div class="line">//        pie.value(function(d)&#123; return d.value; &#125;);</div><div class="line">//  </div><div class="line">//        svg.attr(&#123;width: width, height: height&#125;);</div><div class="line">//        var g = svg.append(&apos;g&apos;)</div><div class="line">//          // center the donut chart</div><div class="line">//          .attr(&apos;transform&apos;, &apos;translate(&apos; + width / 2 + &apos;,&apos; + height / 2 + &apos;)&apos;);</div><div class="line">//  </div><div class="line">//        // add the \&lt;path\&gt;s for each arc slice</div><div class="line">//        var arcs = g.selectAll(&apos;path&apos;);</div><div class="line">//</div><div class="line">//        scope.$watch(&apos;data&apos;, function(data)&#123;</div><div class="line">//          arcs = arcs.data(pie(data));</div><div class="line">//          arcs.enter().append(&apos;path&apos;)</div><div class="line">//            .style(&apos;stroke&apos;, &apos;white&apos;)</div><div class="line">//            .attr(&apos;fill&apos;, function(d, i)&#123; return color(i) &#125;);</div><div class="line">//          arcs.exit().remove();</div><div class="line">//          arcs.attr(&apos;d&apos;, arc);</div><div class="line">//        &#125;, true);</div><div class="line">//      &#125;</div><div class="line">//      return &#123;</div><div class="line">//        link: link,</div><div class="line">//        restrict: &apos;E&apos;,</div><div class="line">//        scope: &#123; data: &apos;=&apos; &#125;</div><div class="line">//      &#125;;</div><div class="line">//    &#125;);</div><div class="line">//  \&lt;/script\&gt;</div><div class="line">//\&lt;/body\&gt;</div><div class="line">//\&lt;/html\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>åŸºç¡€çŸ¥è¯†å°±ä»‹ç»åˆ°è¿™é‡Œï¼Œä¸‹é¢ä¼šä»‹ç»ä¸€ä¸ªç¨å¾®éš¾ä¸€äº›çš„ä¾‹å­ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;More-Dynamic-visualizations&quot;&gt;&lt;a href=&quot;#More-Dynamic-visualizations&quot; class=&quot;headerlink&quot; title=&quot;More Dynamic visualizations&quot;&gt;&lt;/a&gt;More 
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>D3 on Angular</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/D3%20on%20Angular/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/D3 on Angular/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-24T04:15:19.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Angularä¸D3"><a href="#Angularä¸D3" class="headerlink" title="Angularä¸D3"></a>Angularä¸D3</h1><p>å‰é¢å†™äº†å‡ ç¯‡åˆ†åˆ«ä»‹ç»AngularJSå’ŒD3çš„åšå®¢ï¼Œä»–ä»¬å„å¸å…¶èŒï¼Œéƒ½åœ¨å„è‡ªçš„ä¸€äº©ä¸‰åˆ†åœ°é‡Œå¤‡å—å¥½è¯„ï¼Œé‚£ä¹ˆï¼Œä»–ä»¬ä¹‹é—´èƒ½å¦å®Œæˆåˆä½œï¼Œå®ç°å…±èµ¢å‘¢ï¼Ÿè¿™ç¯‡åšå®¢å°±æ¥ä»‹ç»å¦‚ä½•å°†å®ƒä»¬ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œä½¿å¾—æˆ‘ä»¬çš„å¯è§†åŒ–èƒ½å¤Ÿæ›´å…·æœ‰<strong>æ¨¡å—åŒ–</strong>ã€<strong>æ–¹ä¾¿å¤ç”¨</strong>ã€<strong>å…·æœ‰äº¤äº’æ€§</strong>ã€‚</p><h1 id="Why-Angular"><a href="#Why-Angular" class="headerlink" title="Why Angular"></a>Why Angular</h1><p>ä½¿ç”¨Angularåšå¯è§†åŒ–æœ‰å¾ˆå¤šåŸå› ï¼Œä½†å…¶ä¸­æœ€ä¸»è¦çš„åŸå› è¿˜æ˜¯<em>directives(æŒ‡ä»¤)</em>ã€‚ æŒ‡ä»¤ä½¿å¾—åšå¯å¤ç”¨çš„å¯è§†åŒ–æ›´å®¹æ˜“ï¼Œå¯ä»¥ä½¿å¾—æˆ‘ä»¬åšçš„å¯è§†åŒ–çš„æ—¶å€™å°±åƒä½¿ç”¨å†…ç½®çš„HTMLé‚£ä¹ˆç®€å•ï¼Œæ¯”å¦‚æˆ‘éœ€è¦ä¸€ä¸ªçƒ­åŠ›å›¾ï¼ˆåé¢å†™åšå®¢æ€ä¹ˆåšï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»…ä»…éœ€è¦ç”¨\<heatmap\>\</heatmap\>å°±å¯ä»¥äº†ï¼Œæƒ³æƒ³è¿™ç§é…¸çˆ½çš„æ»‹å‘³å§ã€‚å³ä½¿ä½ ä¸çŸ¥é“çƒ­åŠ›å›¾æ˜¯æ€ä¹ˆåšçš„ï¼Œä½†æ˜¯ä½ ç”¨directiveå°±å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨ä»–ã€‚</p><p>å¦å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„åŸå› ï¼Œæ¯”å¦‚æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Angularæä¾›çš„å…¶ä»–å†…ç½®çš„æŒ‡ä»¤æ¥å·¥ä½œäº†ï¼Œæ¯”å¦‚ä½¿ç”¨ng-switchæ¥ä½¿å¾—åœ¨ç‰¹å®šæ¡ä»¶ä¸‹æ‰å±•ç¤ºå¯è§†åŒ–å›¾ï¼›å¦‚æœæˆ‘æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œç”¨ng-repeatæŒ‡ä»¤å¯ä»¥ç»˜åˆ¶å¾ˆå¤šä¸ªå›¾ï¼Œè¿™äº›éƒ½æ˜¯Angularå¯ä»¥æ›¿ä½ å®Œæˆçš„ã€‚</p><p>æœ€åä¸€ä¸ªä¼˜åŠ¿æ˜¯ï¼ŒAngularJSè®©å»ºç«‹associateæ›´æ–°æ›´å®¹æ˜“çš„ã€‚å°±åƒä¹‹å‰çš„associate brushé‚£ç¯‡åšå®¢å†™çš„é‚£æ ·ï¼Œæ²¡æœ‰AngularJSï¼Œæˆ‘ä¸å¾—ä¸æ‰¾ä¸€ä¸ªidæ¥ä½¿å¾—Radvizå’Œscatterplot matrixè”ç³»èµ·æ¥ï¼Œä¸è¿‡æœ‰äº†AngularJSï¼Œæˆ‘ä»¬åªéœ€è¦å¤„ç†å¥½scopeé‡Œæ•°æ®çš„æ›´æ–°å³å¯ã€‚</p><p>å¤§éƒ¨åˆ†çš„webæ¡†æ¶å»ºè®®å¼€å‘è€…ä½¿ç”¨MVCè®¾è®¡æ¨¡å¼ï¼Œåœ¨Angularä¸­ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼ŒVå’ŒMæ˜¯è‡ªåŠ¨è”ç³»èµ·æ¥çš„ï¼Œè¿™ç§åŒå‘ç»‘å®šå°±å‘ç”Ÿåœ¨scopeé‡Œã€‚åªè¦æ”¹å˜scopeé‡Œçš„å˜é‡ï¼Œå®ƒçš„å˜åŒ–ä¼šè¢«è‡ªåŠ¨å‘é€åˆ°DOMï¼Œå› æ­¤Angularå¹¶ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„MVCï¼Œè€Œæ˜¯Model,View,Whatever.</p><h1 id="ç†è§£directives"><a href="#ç†è§£directives" class="headerlink" title="ç†è§£directives"></a>ç†è§£directives</h1><p>æŒ‡ä»¤é€šè¿‡ç»™æˆ‘ä»¬æƒé™å»å»ºç«‹è‡ªå·±çš„HTML tagsæ¥å®ç°å¤ç”¨ã€‚åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œä½ å·²ç»åœ¨ç”¨æŒ‡ä»¤äº†ï¼Œæ¯”å¦‚\<input\>\</input\>å°±æ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œä»–ä»¬ç”±å‡ ä¸ªUIå…ƒç´ çš„ç»„åˆè€Œæˆï¼Œä¸è¿‡é€šè¿‡html5å±•ç°ç»™ä½ çš„å°±æ˜¯ä¸€ä¸ªç®€å•çš„APIï¼Œæˆ‘ä»¬ä¸éœ€è¦çŸ¥é“ä»–ä»¬å†…éƒ¨æ˜¯å¦‚ä½•å®ç°çš„ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨å®ƒåœ¨ä¸åŒçš„æƒ…å†µä¸‹è®©ç”¨æˆ·æ¥è¾“å…¥ç”µå­é‚®ä»¶ï¼Œæ—¥æœŸï¼Œæ•°å€¼ç­‰ç­‰ã€‚ã€‚<br>ä¸‹é¢æˆ‘ä»¬æ¥å®Œæˆä¸€ä¸ªè‡ªå·±çš„directive,åŠŸèƒ½è®©è¿™ä¸ªæŒ‡å®šè¯´hello worldå§ã€‚å…ˆå»ºç«‹è‡ªå·±çš„æ¨¡å—myApp,ç„¶ååœ¨è¿™ä¸ªæ¨¡å—ä¸­å»ºç«‹æŒ‡ä»¤helloWorldã€‚<br>å¦‚æœä½ ç†Ÿæ‚‰é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼Œåº”è¯¥ç†Ÿæ‚‰æ„é€ å‡½æ•°ï¼Œåœ¨æŒ‡ä»¤ä¸­ï¼Œæ„é€ å‡½æ•°å°±æ˜¯<strong>linkå‡½æ•°</strong>ï¼Œè¿™ä¸ªå‡½æ•°ä¸­åŒ…å«äº†è¿™ä¸ªå…ƒç´ å‡ºç°åœ¨HTMLæ—¶ï¼Œæ‰€æœ‰åº”è¯¥å‘ç”Ÿçš„äº‹æƒ…ã€‚<br>restrictæœ‰ACMEï¼Œè¿™äº›éƒ½æ˜¯Angularçš„åŸºç¡€ï¼Œè¿™é‡Œä¸å¤šä»‹ç»äº†ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨Eã€‚å®Œæ•´çš„ä»£ç å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//  \&lt;html\&gt;</div><div class="line">//  \&lt;head lang=&quot;en&quot;\&gt;</div><div class="line">//    \&lt;meta charset=&quot;UTF-8&quot;\&gt;</div><div class="line">//    \&lt;script src=&quot;./d3.js&quot;\&gt;\&lt;/script\&gt;</div><div class="line">//    \&lt;script src=&quot;./angular.js&quot;\&gt;\&lt;/script\&gt;</div><div class="line">//    \&lt;script src=&quot;./sc.js&quot;\&gt;</div><div class="line">//      var myApp = angular.module(&apos;myApp&apos;,[]());</div><div class="line">//  </div><div class="line">//      myApp.directive(&apos;helloWorld&apos;,function()&#123;</div><div class="line">//  </div><div class="line">//        function link(scope,element,attr)&#123;</div><div class="line">//          element.text=&apos;hello world!&apos;;</div><div class="line">//        &#125;</div><div class="line">//        return &#123;</div><div class="line">//          link:link,</div><div class="line">//          restrict:&apos;E&apos;</div><div class="line">//        &#125;</div><div class="line">//  </div><div class="line">//      &#125;)</div><div class="line">//  </div><div class="line">//    \&lt;/script\&gt;</div><div class="line">//    \&lt;title\&gt;\&lt;/title\&gt;</div><div class="line">//  \&lt;/head\&gt;</div><div class="line">//  \&lt;body ng-app=&quot;myApp&quot;\&gt;</div><div class="line">//    \&lt;hello-world\&gt;hello world!\&lt;/hello-world\&gt;</div><div class="line">//  </div><div class="line">//  </div><div class="line">//  \&lt;/body\&gt;</div><div class="line">//  \&lt;/html\&gt;</div><div class="line"></div></pre></td></tr></table></figure><h1 id="reusable-visualization-directive"><a href="#reusable-visualization-directive" class="headerlink" title="reusable visualization directive"></a>reusable visualization directive</h1><p>ä¸Šé¢å±•ç¤ºçš„ä¾‹å­è™½ç„¶æ­£ç¡®ï¼Œä½†æ˜¯å´æ²¡ä»€ä¹ˆç”¨ï¼Œè¿™èŠ‚å°±å®Œæˆä¸€ä¸ªå¯å¤ç”¨çš„donut chartæŒ‡ä»¤ã€‚é¦–å…ˆç”¨d3ç»˜åˆ¶ä¸€ä¸ªï¼Œä»£ç å¦‚ä¸‹:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//    \&lt;script\&gt;</div><div class="line">//      var color = d3.scale.category10();</div><div class="line">//      var data =[10,20,30]();</div><div class="line">//      var width =300;</div><div class="line">//      var height = 300;</div><div class="line">//      var min = Math.min(width,height);</div><div class="line">//      var svg = d3.select(&apos;body&apos;).append(&apos;svg&apos;);</div><div class="line">//      var pie = d3.layout.pie().sort(null);</div><div class="line">//  </div><div class="line">//      var arc = d3.svg.arc().outerRadius(min/2*0.9).innerRadius(min/2*0.5);</div><div class="line">//  </div><div class="line">//      svg.attr(&#123;width:width,height:height&#125;);</div><div class="line">//  </div><div class="line">//      var g = svg.append(&apos;g&apos;)</div><div class="line">//          .attr(&apos;transform&apos;,&apos;translate(&apos;+width/2+&apos;,&apos;+height/2+&apos;)&apos;);</div><div class="line">//  </div><div class="line">//      g.selectAll(&apos;path&apos;).data(pie(data))</div><div class="line">//          .enter().append(&apos;path&apos;)</div><div class="line">//          .style(&apos;stroke&apos;,&apos;white&apos;)</div><div class="line">//          .attr(&apos;d&apos;,arc)</div><div class="line">//          .attr(&apos;fill&apos;,function(d,i)&#123;return color(i)&#125;)</div><div class="line">//  </div><div class="line">//  </div><div class="line">//    \&lt;/script\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>å’Œä¸Šé¢çš„hello worldä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦åœ¨moduleé‡Œè®¾ç½®æ–°çš„æŒ‡ä»¤,ä¸åŒä¹‹å¤„æ˜¯å°†åå­—æ”¹æˆäº†donutChartäº†ã€‚åœ¨linkå‡½æ•°é‡Œï¼Œæˆ‘ä»¬å°†ä¸Šé¢çš„d3ä»£ç å…¨éƒ¨æ‹·è´è¿›å»ï¼Œä¸è¿‡æœ‰äº›åœ°æ–¹ä¹Ÿå¾—<strong>å˜ä¸€ä¸‹</strong>ï¼Œæˆ‘ä»¬éœ€è¦å°†d3.select(â€˜bodyâ€™)æ”¹æˆd3.select(element<a href="">0</a>),ä»å…¨å±€çš„domæ”¹æˆäº†ç›¸å¯¹çš„ã€‚ä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨elementå‘¢ï¼Ÿå› ä¸ºelementæ˜¯ä¸€ä¸ªjQueryçš„selectionï¼Œä¸æ˜¯ä¸€ä¸ªDOMå…ƒç´ ã€‚<br>å¦‚æœé¡ºåˆ©ï¼Œå°†ä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœã€‚<br><img src="http://i13.tietuku.cn/bf49b11d65040556.jpg" alt=""></p><p>æˆåŠŸäº†ï¼Œæˆ‘ä»¬å®Œæˆäº†å¯è§†åŒ–å›¾çš„å¤ç”¨ï¼</p><h1 id="Isolate-scope"><a href="#Isolate-scope" class="headerlink" title="Isolate scope"></a>Isolate scope</h1><p>ä½†æ˜¯èªæ˜çš„ä½ å¾ˆå¿«å°±å‘ç°äº†é—®é¢˜ï¼Œæˆ‘ä»¬çš„å¯è§†åŒ–å›¾æ— è®ºä½•æ—¶éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™å¯ä¸è¡Œï¼æˆ‘ä»¬å¸Œæœ›å¯ä»¥è‡ªå·±ä¼ ä¸€äº›æ•°æ®ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ªå›¾æ˜¯1ï¼Œ2ï¼Œ3ï¼Œ4ï¼›ç¬¬äºŒä¸ªå›¾æ˜¯2ï¼Œ3ï¼Œ4ï¼Œ5ï¼›è¿™æ ·æ‰å‹‰å¼ºå¯ä»¥ã€‚<br>ä¸ºäº†è¾¾åˆ°è¿™æ ·çš„ç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ªå«isolate scopeçš„ä¸œè¥¿ã€‚å®ƒå…è®¸æˆ‘ä»¬ä½¿ç”¨attributeä¼ é€’æ•°æ®åˆ°æŒ‡ä»¤ä¸­ã€‚å‘Šè¯‰Angularæˆ‘ä»¬çš„æŒ‡ä»¤éœ€è¦æœ‰ä¸€ä¸ªisolate scopeçš„æ–¹æ³•å¾ˆç®€å•ï¼Œæˆ‘ä»¬åªéœ€ä»æŒ‡ä»¤å£°æ˜çš„è¿”å›å¤„å¢åŠ ä¸€ä¸ªscopeå±æ€§å³å¯ã€‚ åœ¨restrictä¸‹é¢å¢åŠ ä¸€è¡Œscope:{data:â€™=},åœ¨linkå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç”¨scope.dataäº†ã€‚<br>å½“æˆ‘ä»¬ä½¿ç”¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;bodyng-app=&quot;myApp&quot;ng-init=&quot;ourSharedData=[8,2,9]()&quot;\&gt; </div><div class="line">\&lt;donut-chart data=&quot;ourSharedData&quot;\&gt;\&lt;/donut-chart\&gt; </div><div class="line">\&lt;donut-chart data=&quot;ourSharedData&quot;\&gt;\&lt;/donut-chart\&gt; </div><div class="line">\&lt;donut-chart data=&quot;ourSharedData&quot;\&gt;\&lt;/donut-chart\&gt; </div><div class="line"></div></pre></td></tr></table></figure><br>æ—¶å€™ï¼Œç¡®å®è¾¾åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚</p><p><strong>æœªå®Œå¾…ç»­â€¦</strong> </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Angularä¸D3&quot;&gt;&lt;a href=&quot;#Angularä¸D3&quot; class=&quot;headerlink&quot; title=&quot;Angularä¸D3&quot;&gt;&lt;/a&gt;Angularä¸D3&lt;/h1&gt;&lt;p&gt;å‰é¢å†™äº†å‡ ç¯‡åˆ†åˆ«ä»‹ç»AngularJSå’ŒD3çš„åšå®¢ï¼Œä»–ä»¬å„å¸å…¶èŒï¼Œéƒ½åœ¨å„è‡ªçš„
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>associate brush</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/associate%20brush/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/associate brush/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-24T04:14:34.000Z</updated>
    
    <content type="html"><![CDATA[<p>è¿™ç¯‡åšå®¢è®°å½•äº†åœ¨ä¸Šä¸€ç¯‡åšå®¢åŠ å…¥scatterplot matrixçš„åŸºç¡€ä¸Šï¼Œå®ç°äº†associate brushçš„æ“ä½œï¼Œå³ï¼Œä»RadVizä¸­brushä¸€å—åŒºåŸŸï¼Œå³è¾¹16ä¸ªscatterploté‡Œå¯¹åº”çš„ç‚¹éƒ½ä¼šé«˜äº®å‡ºæ¥ï¼Œå…¶ä»–çš„ç‚¹å°†æš—æ·¡ä¸‹å»ï¼›åŒæ ·çš„ï¼Œä»å³è¾¹16ä¸ªscatterplot matrixé‡Œä»»ä¸€scatterplot cellé‡Œbrushä¸€äº›ç‚¹ï¼Œå¦å¤–15ä¸ªcellä»¥åŠå·¦è¾¹çš„RadVizé‡Œç›¸åº”çš„ç‚¹éƒ½ä¼šè¢«highlightå‡ºæ¥ã€‚å…·ä½“çš„æ•ˆæœå¦‚ä¸‹å›¾ï¼š<br><img src="http://i12.tietuku.cn/c8876c3f133891c5.jpg" alt=""></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div><div class="line">461</div><div class="line">462</div><div class="line">463</div><div class="line">464</div><div class="line">465</div><div class="line">466</div><div class="line">467</div><div class="line">468</div><div class="line">469</div><div class="line">470</div><div class="line">471</div><div class="line">472</div><div class="line">473</div><div class="line">474</div><div class="line">475</div><div class="line">476</div><div class="line">477</div><div class="line">478</div><div class="line">479</div><div class="line">480</div><div class="line">481</div><div class="line">482</div><div class="line">483</div><div class="line">484</div><div class="line">485</div><div class="line">486</div><div class="line">487</div><div class="line">488</div><div class="line">489</div><div class="line">490</div><div class="line">491</div><div class="line">492</div><div class="line">493</div><div class="line">494</div><div class="line">495</div><div class="line">496</div><div class="line">497</div><div class="line">498</div><div class="line">499</div><div class="line">500</div><div class="line">501</div><div class="line">502</div><div class="line">503</div><div class="line">504</div><div class="line">505</div><div class="line">506</div><div class="line">507</div><div class="line">508</div><div class="line">509</div><div class="line">510</div><div class="line">511</div><div class="line">512</div><div class="line">513</div><div class="line">514</div><div class="line">515</div><div class="line">516</div><div class="line">517</div><div class="line">518</div><div class="line">519</div><div class="line">520</div><div class="line">521</div><div class="line">522</div><div class="line">523</div><div class="line">524</div><div class="line">525</div><div class="line">526</div><div class="line">527</div><div class="line">528</div><div class="line">529</div><div class="line">530</div><div class="line">531</div><div class="line">532</div><div class="line">533</div><div class="line">534</div><div class="line">535</div><div class="line">536</div><div class="line">537</div><div class="line">538</div><div class="line">539</div><div class="line">540</div><div class="line">541</div><div class="line">542</div><div class="line">543</div><div class="line">544</div><div class="line">545</div><div class="line">546</div><div class="line">547</div><div class="line">548</div><div class="line">549</div><div class="line">550</div><div class="line">551</div><div class="line">552</div><div class="line">553</div><div class="line">554</div><div class="line">555</div><div class="line">556</div><div class="line">557</div><div class="line">558</div><div class="line">559</div><div class="line">560</div><div class="line">561</div><div class="line">562</div><div class="line">563</div><div class="line">564</div><div class="line">565</div><div class="line">566</div><div class="line">567</div><div class="line">568</div><div class="line">569</div><div class="line">570</div><div class="line">571</div><div class="line">572</div><div class="line">573</div><div class="line">574</div><div class="line">575</div><div class="line">576</div><div class="line">577</div><div class="line">578</div><div class="line">579</div><div class="line">580</div><div class="line">581</div><div class="line">582</div><div class="line">583</div><div class="line">584</div><div class="line">585</div><div class="line">586</div><div class="line">587</div><div class="line">588</div><div class="line">589</div><div class="line">590</div><div class="line">591</div><div class="line">592</div><div class="line">593</div><div class="line">594</div><div class="line">595</div><div class="line">596</div><div class="line">597</div><div class="line">598</div><div class="line">599</div><div class="line">600</div><div class="line">601</div><div class="line">602</div><div class="line">603</div><div class="line">604</div><div class="line">605</div><div class="line">606</div><div class="line">607</div><div class="line">608</div><div class="line">609</div><div class="line">610</div><div class="line">611</div><div class="line">612</div><div class="line">613</div><div class="line">614</div><div class="line">615</div><div class="line">616</div><div class="line">617</div><div class="line">618</div><div class="line">619</div><div class="line">620</div><div class="line">621</div><div class="line">622</div><div class="line">623</div><div class="line">624</div><div class="line">625</div><div class="line">626</div><div class="line">627</div><div class="line">628</div><div class="line">629</div><div class="line">630</div><div class="line">631</div><div class="line">632</div><div class="line">633</div><div class="line">634</div><div class="line">635</div><div class="line">636</div><div class="line">637</div><div class="line">638</div><div class="line">639</div><div class="line">640</div><div class="line">641</div><div class="line">642</div><div class="line">643</div><div class="line">644</div><div class="line">645</div><div class="line">646</div><div class="line">647</div><div class="line">648</div><div class="line">649</div><div class="line">650</div><div class="line">651</div><div class="line">652</div><div class="line">653</div><div class="line">654</div><div class="line">655</div><div class="line">656</div><div class="line">657</div><div class="line">658</div><div class="line">659</div><div class="line">660</div><div class="line">661</div><div class="line">662</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;!DOCTYPE html\&gt;</div><div class="line">\&lt;html\&gt;</div><div class="line">\&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=gbk&quot;\&gt;</div><div class="line">\&lt;meta name=&quot;author&quot; content=&quot;oscar999&quot;\&gt;</div><div class="line">\&lt;head\&gt;</div><div class="line">\&lt;script type=&quot;text/javascript&quot; src=&quot;script/d3.v3.js&quot;\&gt; \&lt;/script\&gt;</div><div class="line">\&lt;style\&gt;</div><div class="line">body &#123;</div><div class="line">width: 1440px;</div><div class="line">margin: 15px auto 0;</div><div class="line">background: #fff;</div><div class="line">&#125;</div><div class="line"># RadViz&#123;</div><div class="line">float:left;margin-top:20px;margin-left:10px;width:510px; height:510px;  border-width:1px; border-style:solid; border-color:#bfb7b0;</div><div class="line">&#125;</div><div class="line">\&lt;/style\&gt;</div><div class="line">\&lt;title\&gt;RadViz\&lt;/title\&gt;</div><div class="line">\&lt;/head\&gt;</div><div class="line"></div><div class="line">\&lt;body\&gt;</div><div class="line">\&lt;div id=&quot;RadViz&quot;\&gt; \&lt;/div\&gt;</div><div class="line">\&lt;script src=&quot;kNN.js&quot;\&gt;\&lt;/script\&gt;</div><div class="line">\&lt;script src=&quot;dunnsIndex.js&quot;\&gt;\&lt;/script\&gt;</div><div class="line">\&lt;style\&gt;</div><div class="line">svg &#123;</div><div class="line">font: 10px sans-serif;</div><div class="line">padding: 10px;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.axis,</div><div class="line">.frame &#123;</div><div class="line">shape-rendering: crispEdges;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.axis line &#123;</div><div class="line">stroke: #ddd;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.axis path &#123;</div><div class="line">display: none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.cell text &#123;</div><div class="line">font-weight: bold;</div><div class="line">text-transform: capitalize;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.frame &#123;</div><div class="line">fill: none;</div><div class="line">stroke: #aaa;</div><div class="line">&#125;</div><div class="line"></div><div class="line">circle &#123;</div><div class="line">fill-opacity: .7;</div><div class="line">&#125;</div><div class="line"></div><div class="line">circle.hidden &#123;</div><div class="line">fill: #ccc !important;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.extent &#123;</div><div class="line">fill: #000;</div><div class="line">fill-opacity: .125;</div><div class="line">stroke: #fff;</div><div class="line">&#125;</div><div class="line">\&lt;/style\&gt;</div><div class="line"></div><div class="line"></div><div class="line">\&lt;script type=&quot;text/javascript&quot;\&gt;</div><div class="line">var DimNum = 4;                  //ç»´åº¦æ•°</div><div class="line">var ordertxt = [1,2,3,4]();        //orderé¡ºåº</div><div class="line">var orderNum = ordertxt.length;  //orderçš„ä¸ªæ•°</div><div class="line">var UnitRadius=360/orderNum;     //æ¯ä¸ªå•å…ƒçš„è§’åº¦</div><div class="line"></div><div class="line">var centerX=240.0;               //åœ†å¿ƒ</div><div class="line">var centerY=270.0;</div><div class="line">var r = 190;                     //åŠå¾„</div><div class="line">var outerRadius = r+10;           //å†…åŠå¾„</div><div class="line">var innerRadius = r-10;           //å¤–åŠå¾„</div><div class="line"></div><div class="line">var DimPoint = new Array();</div><div class="line">var Radius = new Array();</div><div class="line"></div><div class="line">var NodePoint =new Array();</div><div class="line"></div><div class="line">//compute DimPoint</div><div class="line">for(var i=0;i\&lt;orderNum;i++)&#123;</div><div class="line">DimPoint[i]()=new Array();</div><div class="line">&#125;</div><div class="line">for(var i=0; i\&lt;orderNum;i++)&#123;</div><div class="line">Radius[i]() = (UnitRadius*i)*Math.PI/180;</div><div class="line">DimPoint[i]()[0]()=r\*Math.cos(Radius[i]());  //DAçš„xåæ ‡</div><div class="line">DimPoint[i]()[1]()=r\*Math.sin(Radius[i]());  //DAçš„yåæ ‡</div><div class="line">DimPoint[i]()[2]()=ordertxt[i]();            //DAçš„å€¼</div><div class="line">&#125;</div><div class="line">//compute Data Point</div><div class="line">d3.csv(&quot;iris-normalization.csv&quot;,function(RecordData)&#123;</div><div class="line">for(var i=0;i\&lt;RecordData.length;i++)&#123;</div><div class="line">NodePoint[i]()=new Array();</div><div class="line">&#125;</div><div class="line">for(var i=0;i\&lt;RecordData.length;i++)&#123;</div><div class="line">var tt=RecordData[i]().dimData;</div><div class="line">var t1=tt.split(&quot;,&quot;);</div><div class="line">for(var j=0;j\&lt;t1.length;j++)&#123;</div><div class="line">t1[j]()=parseFloat(t1[j]());</div><div class="line">&#125;</div><div class="line">var t2=new Array(t1.length);</div><div class="line">for(var k=1;k\&lt;=ordertxt.length;k++)</div><div class="line">&#123;</div><div class="line">t2[k-1]()=t1[ordertxt[k-1]()-1];</div><div class="line">&#125;</div><div class="line">//        console.log(t2)</div><div class="line">//        console.log(t1+&quot; ---&quot;)</div><div class="line">RecordData[i]().dimData = t2;</div><div class="line">&#125;</div><div class="line">var dataStr = &quot;&quot;;</div><div class="line">for(var i=0;i\&lt;RecordData.length;i++)&#123;</div><div class="line">var SumDown = getSumDown(RecordData[i]().dimData,orderNum);</div><div class="line">var SumUpX = getSumUpX(RecordData[i]().dimData,Radius,orderNum);</div><div class="line">var SumUpY = getSumUpY(RecordData[i]().dimData,Radius,orderNum);</div><div class="line">var CoordX = SumUpX/SumDown;</div><div class="line">var CoordY = SumUpY/SumDown;</div><div class="line">NodePoint[i]()[0]() = CoordX+centerX;</div><div class="line">NodePoint[i]()[1]() = CoordY+centerY;</div><div class="line">NodePoint[i]()[2]() = RecordData[i]().classId;</div><div class="line">NodePoint[i]()[3]() = RecordData[i]().id;</div><div class="line">dataStr = dataStr+NodePoint[i]()[3]()+&quot;,&quot;+NodePoint[i]()[0]()+&quot;,&quot;+NodePoint[i]()[1]()+&quot;,&quot;+NodePoint[i]()[2]()+&quot;\n&quot;;</div><div class="line">&#125;</div><div class="line">//                console.log(dataStr);</div><div class="line">//              console.log(dataStr);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">var width = 600, height = 500;</div><div class="line"></div><div class="line">var svg = d3.select(RadViz).append(&quot;svg&quot;).attr(&quot;width&quot;,width).attr(&quot;height&quot;, height) ;</div><div class="line"></div><div class="line">var xScale = d3.scale.linear().domain([10,510]())</div><div class="line">.range([10,510]());</div><div class="line"></div><div class="line">var yScale = d3.scale.linear().domain([10,510]())</div><div class="line">.range([20,510-20]());</div><div class="line"></div><div class="line">var brush = d3.svg.brush()</div><div class="line">.x(xScale)</div><div class="line">.y(yScale)</div><div class="line">.extent([0,0](),[0,0]())</div><div class="line">.on(&apos;brush&apos;,brushed)</div><div class="line">.on(&apos;brushstart&apos;,brushstart)</div><div class="line">.on(&apos;brushend&apos;,brushend);</div><div class="line"></div><div class="line">function brushstart()&#123;</div><div class="line"> d3.select(&apos;body&apos;).selectAll(&apos;.cell&apos;).selectAll(&apos;circle&apos;)</div><div class="line">//                 .style(&apos;fill&apos;,&apos;#ccc&apos;);</div><div class="line">.classed(&apos;hidden&apos;,true);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">function brushend()&#123;</div><div class="line">if (brush.empty()) &#123;</div><div class="line">d3.select(&apos;body&apos;).selectAll(&apos;.cell&apos;).selectAll(&apos;circle&apos;)</div><div class="line">.classed(&apos;hidden&apos;, function () &#123;</div><div class="line"></div><div class="line">return false;</div><div class="line"></div><div class="line">&#125;);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function brushed()&#123;</div><div class="line"></div><div class="line">var extent = brush.extent();</div><div class="line">var xmin = extent[0]()[0]();</div><div class="line">var xmax = extent[1]()[0]();</div><div class="line">var ymin = extent[0]()[1]();</div><div class="line">var ymax = extent[1]()[1]();</div><div class="line">//        console.log(xmax + &quot; &quot; + xmin);</div><div class="line">//        console.log(ymax + &quot; &quot; + ymin);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"> Nodes.style(&quot;fill&quot;,function(d, i) &#123;</div><div class="line"></div><div class="line"></div><div class="line">var color;</div><div class="line">//         console.log(d);</div><div class="line"></div><div class="line">//         d3.select(&apos;body&apos;).selectAll(&apos;.cell&apos;).selectAll(&apos;circle&apos;)</div><div class="line">//                 .style(&apos;fill&apos;,&apos;#ccc&apos;);</div><div class="line"></div><div class="line"> if(d[0]()\&gt;=xmin &amp;&amp; d[0]()\&lt;=xmax &amp;&amp; d[1]()\&gt;=ymin &amp;&amp; d[1]()\&lt;=ymax)&#123;</div><div class="line"></div><div class="line"> d3.select(&apos;body&apos;).selectAll(&apos;.cell&apos;).selectAll(&apos;circle&apos;)</div><div class="line"> .filter(function(dd)&#123;return dd.id==d[3]();&#125;)</div><div class="line"> .classed(&apos;hidden&apos;,false);</div><div class="line"></div><div class="line"></div><div class="line"> return &apos;red&apos;;</div><div class="line"></div><div class="line"> &#125;else&#123;</div><div class="line"></div><div class="line">//             return color(d[2]());</div><div class="line"></div><div class="line">if (d[2]() == &quot;1&quot;)</div><div class="line">color = &quot;#ffc2ce&quot;;</div><div class="line">else if (d[2]() == &quot;2&quot;)</div><div class="line">color = &quot;#0ffa1d&quot;;</div><div class="line">else if (d[2]() == &quot;3&quot;)</div><div class="line">color = &quot;#fee905&quot;;</div><div class="line">return color;</div><div class="line">&#125;</div><div class="line"> &#125;);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">svg.append(&apos;g&apos;).call(brush)</div><div class="line">.selectAll(&apos;rect&apos;)</div><div class="line">.style(&apos;fill-opacity&apos;,0.3);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">var dimdata = []();</div><div class="line">for ( var i = 0; i \&lt; DimNum; i++) &#123;</div><div class="line">dimdata[i]() = 1;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">//draw arc</div><div class="line">var pie = d3.layout.pie().sort(null);</div><div class="line">var arc = d3.svg.arc()</div><div class="line">.startAngle(function(d,i)&#123;</div><div class="line">return (UnitRadius*i+90-0.5*UnitRadius+1)\*Â Math.PI/180&#125;)</div><div class="line">.endAngle(function(d,i)&#123;return (UnitRadius*i+90+0.5*UnitRadius)\*Math.PI/180&#125;)</div><div class="line">.innerRadius(innerRadius)</div><div class="line">.outerRadius(outerRadius)</div><div class="line">;</div><div class="line">var arcs = svg.selectAll(&quot;g.arc&quot;).data(pie(dimdata)).enter()</div><div class="line">.append(&quot;g&quot;).attr(&quot;class&quot;, &quot;arc&quot;).attr(&quot;transform&quot;,</div><div class="line">&quot;translate(&quot; + centerX + &quot;,&quot; + centerY + &quot;)&quot;)</div><div class="line">;</div><div class="line">arcs.append(&quot;path&quot;)</div><div class="line">//.style(&quot;stroke&quot;,&quot;red&quot;)</div><div class="line">//.style(&quot;stroke-opacity&quot;,0)</div><div class="line">//  .style(&quot;stroke-width&quot;,0)</div><div class="line">.attr(&quot;fill&quot;,function(d, i) &#123;</div><div class="line">var color1=[&quot;#006650&quot;,&quot;#f5ab00&quot;,&quot;#db4527&quot;,&quot;#005687&quot;]();</div><div class="line">return color1[i]();</div><div class="line">&#125;)</div><div class="line">.attr(&quot;d&quot;, arc);</div><div class="line">//show Dimension Point</div><div class="line">svg.selectAll(&quot;circle&quot;)</div><div class="line">.data(DimPoint)</div><div class="line">.enter()</div><div class="line">.append(&quot;circle&quot;)</div><div class="line">.attr(&quot;cx&quot;, function(d) &#123;</div><div class="line">return d[0]()+centerX;</div><div class="line">&#125;)</div><div class="line">.attr(&quot;cy&quot;, function(d) &#123;</div><div class="line">return d[1]()+centerY;</div><div class="line">&#125;).attr(&quot;r&quot;, 4)</div><div class="line">.attr(&quot;opacity&quot;,0.8);</div><div class="line"></div><div class="line">svg.selectAll(&quot;text&quot;)</div><div class="line">.data(DimPoint)</div><div class="line">.enter()</div><div class="line">.append(&quot;text&quot;)</div><div class="line">.text(function(d) &#123;</div><div class="line">return d[2]();</div><div class="line">&#125;)</div><div class="line">.attr(&quot;x&quot;, function(d) &#123;</div><div class="line">return d[0]()+centerX ;</div><div class="line">&#125;).attr(&quot;y&quot;, function(d) &#123;</div><div class="line">return d[1]()+centerY;</div><div class="line">&#125;).attr(&quot;font-family&quot;, &quot;sans-serif&quot;)</div><div class="line">.attr(&quot;font-size&quot;, 15)</div><div class="line">.attr(&quot;stroke-width&quot;,2)</div><div class="line">.attr(&quot;fill&quot;, &quot;black&quot;);</div><div class="line"></div><div class="line"></div><div class="line">//show data point</div><div class="line">var Nodes = svg.selectAll(&quot;RadViz&quot;)</div><div class="line">.data(NodePoint)</div><div class="line">.enter()</div><div class="line">.append(&quot;circle&quot;)</div><div class="line">.attr(&quot;class&quot;, &quot;node&quot;)</div><div class="line">.attr(&quot;id&quot;,function(d,i)&#123;return i;&#125;)</div><div class="line">.attr(&quot;cx&quot;,function(d,i)&#123; return d[0](); &#125;)</div><div class="line">.attr(&quot;cy&quot;,function(d,i)&#123;return d[1]();&#125;)</div><div class="line">.attr(&quot;r&quot;, 4.5)</div><div class="line">.attr(&quot;class&quot;,&quot;nodes&quot;)</div><div class="line">.style(&quot;opacity&quot;,0.8)</div><div class="line">.style(&quot;fill&quot;,function(d, i) &#123;</div><div class="line">var color;</div><div class="line">if (d[2]() == &quot;1&quot;)</div><div class="line">color = &quot;#ffc2ce&quot;;</div><div class="line">else if (d[2]() == &quot;2&quot;)</div><div class="line">color = &quot;#0ffa1d&quot;;</div><div class="line">else if (d[2]() == &quot;3&quot;)</div><div class="line">color = &quot;#fee905&quot;;</div><div class="line">return color;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Nodes.on(&quot;mouseenter&quot;,function()&#123;d3.select(this).style(&apos;fill&apos;,&apos;red&apos;)</div><div class="line"></div><div class="line">var x = d3.select(this).attr(&apos;cx&apos;);</div><div class="line">var y = d3.select(this).attr(&apos;cy&apos;);</div><div class="line"></div><div class="line">//                    alert(x+&quot; &quot;+y)</div><div class="line">//                    var sequence = new Array();</div><div class="line">sequence = kNN(NodePoint,[x,y](),5);</div><div class="line">var NN=  Nodes.filter(function(d,i)&#123;</div><div class="line">var flag=false;</div><div class="line">for(var i=0;i\&lt;sequence.length;i++)</div><div class="line">&#123;</div><div class="line">if(d[3]()==sequence[i]())&#123;</div><div class="line">flag=true;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">return flag;</div><div class="line">&#125;).style(&apos;fill&apos;,&apos;red&apos;)</div><div class="line"></div><div class="line">&#125;)</div><div class="line">.on(&apos;mouseleave&apos;,function(d,i)&#123;Nodes.style(&quot;fill&quot;,function(d, i) &#123;</div><div class="line">var color;</div><div class="line">if (d[2]() == &quot;1&quot;)</div><div class="line">color = &quot;#ffc2ce&quot;;</div><div class="line">else if (d[2]() == &quot;2&quot;)</div><div class="line">color = &quot;#0ffa1d&quot;;</div><div class="line">else if (d[2]() == &quot;3&quot;)</div><div class="line">color = &quot;#fee905&quot;;</div><div class="line">return color;</div><div class="line">&#125;)&#125;)</div><div class="line"></div><div class="line">.style(&quot;stroke&quot;, &quot;black&quot;)</div><div class="line">.style(&quot;stroke-width&quot;, 0.8)</div><div class="line">.append(&quot;title&quot;)</div><div class="line">.text(function(d) &#123; return &quot;point&quot;+d[3]()+&quot;-class:&quot;+d[2](); &#125;)</div><div class="line"></div><div class="line">Nodes.on(&apos;click&apos;,function(d,i)&#123;</div><div class="line"></div><div class="line">//                   var x = d3.select(this).attr(&apos;cx&apos;)</div><div class="line">//                   var y = d3.select(this).attr(&apos;cy&apos;)</div><div class="line"></div><div class="line">var x = d[0]();</div><div class="line">var y = d[1]();</div><div class="line"></div><div class="line">//                    alert(x+&quot; &quot;+y)</div><div class="line">//                    var sequence = new Array();</div><div class="line">sequence = kNN(NodePoint,[x,y](),5);</div><div class="line">//                    alert(sequence);</div><div class="line">var Str=&quot;&quot;;</div><div class="line">for(var kk=0;kk\&lt;sequence.length;kk++)&#123;</div><div class="line">Str=Str+NodePoint[sequence[kk]()][2]()+&quot;  &quot;;</div><div class="line">&#125;</div><div class="line">alert(Str);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;)</div><div class="line"></div><div class="line">var KNum =15;</div><div class="line">var right = 0;</div><div class="line">for(var i=0;i\&lt;NodePoint.length;i++) &#123;</div><div class="line">var tmp = new Array();</div><div class="line">tmp = [NodePoint[i]()[0](), NodePoint[i]()[1]()];</div><div class="line">//                    console.log(tmp);</div><div class="line"></div><div class="line">sequence = kNN(NodePoint, tmp, KNum);</div><div class="line">var count1 = 0;</div><div class="line">var count2 = 0;</div><div class="line">var count3 = 0;</div><div class="line">for (var kk = 0; kk \&lt; sequence.length; kk++) &#123;</div><div class="line">if (NodePoint[sequence[kk]()][2]() == 1) &#123;</div><div class="line">count1++;</div><div class="line">&#125; else if (NodePoint[sequence[kk]()][2]() == 2) &#123;</div><div class="line">count2++;</div><div class="line">&#125; else if (NodePoint[sequence[kk]()][2]() == 3) &#123;</div><div class="line">count3++;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">var max = Math.max(count1, Math.max(count2, count3))</div><div class="line">var predict = 0;</div><div class="line">if (count1 == max) &#123;</div><div class="line">predict = 1;</div><div class="line">&#125; else if (count2 == max) &#123;</div><div class="line">predict = 2;</div><div class="line">&#125; else if (count3 == max) &#123;</div><div class="line">predict = 3;</div><div class="line">&#125;</div><div class="line">if (NodePoint[i]()[2]() == predict) &#123;</div><div class="line">right++;</div><div class="line">&#125; else &#123;</div><div class="line">console.log(&quot;predict is &quot; + predict + &quot; NodePoint is &quot; + NodePoint[i]()[2]())</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">console.log(right);</div><div class="line"></div><div class="line">var dunnsindex = (dunnsIndex(3,NodePoint));</div><div class="line"></div><div class="line">svg.append(&apos;text&apos;)</div><div class="line">.text(&apos;Dunns Index: &apos;+dunnsindex.toFixed(3))</div><div class="line">.attr(&apos;x&apos;,width)</div><div class="line">.attr(&apos;y&apos;,height)</div><div class="line">.attr(&apos;dx&apos;,-250)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">&#125;);//.data</div><div class="line"></div><div class="line">function getSumUpX(RecordData,Radius,orderNum)&#123;</div><div class="line">var TempUpX=0;</div><div class="line">for(var i=0;i\&lt;orderNum;i++)&#123;</div><div class="line">TempUpX=TempUpX+r*RecordData[i]()*Math.cos(Radius[i]());</div><div class="line">&#125;</div><div class="line">return TempUpX;</div><div class="line">&#125;</div><div class="line">function getSumUpY(RecordData,Radius,orderNum)&#123;</div><div class="line">var TempUpY=0;</div><div class="line">for(var i=0;i\&lt;orderNum;i++)&#123;</div><div class="line">TempUpY=TempUpY+r*RecordData[i]()*Math.sin(Radius[i]());</div><div class="line">&#125;</div><div class="line">return TempUpY;</div><div class="line">&#125;</div><div class="line">function getSumDown(RecordData,orderNum)&#123;</div><div class="line">var TempDown=0;</div><div class="line">for(var i=0;i\&lt;orderNum;i++)&#123;</div><div class="line">TempDown =TempDown+RecordData[i]();</div><div class="line">&#125;</div><div class="line">return TempDown;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">\&lt;/script\&gt;</div><div class="line"></div><div class="line">\&lt;style\&gt;</div><div class="line"></div><div class="line">svg &#123;</div><div class="line">font: 10px sans-serif;</div><div class="line">padding: 10px;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.axis,</div><div class="line">.frame &#123;</div><div class="line">shape-rendering: crispEdges;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.axis line &#123;</div><div class="line">stroke: #ddd;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.axis path &#123;</div><div class="line">display: none;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.cell text &#123;</div><div class="line">font-weight: bold;</div><div class="line">text-transform: capitalize;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.frame &#123;</div><div class="line">fill: none;</div><div class="line">stroke: #aaa;</div><div class="line">&#125;</div><div class="line"></div><div class="line">circle &#123;</div><div class="line">fill-opacity: .7;</div><div class="line">&#125;</div><div class="line"></div><div class="line">circle.hidden &#123;</div><div class="line">fill: #ccc !important;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.extent &#123;</div><div class="line">fill: #000;</div><div class="line">fill-opacity: .125;</div><div class="line">stroke: #fff;</div><div class="line">&#125;</div><div class="line"></div><div class="line">\&lt;/style\&gt;</div><div class="line"></div><div class="line"></div><div class="line">\&lt;script\&gt;</div><div class="line"></div><div class="line">var width = 960,</div><div class="line">size = 130,</div><div class="line">padding = 20;</div><div class="line"></div><div class="line">var x = d3.scale.linear()</div><div class="line">.range([padding / 2, size - padding / 2]());</div><div class="line"></div><div class="line">var y = d3.scale.linear()</div><div class="line">.range([size - padding / 2, padding / 2]());</div><div class="line"></div><div class="line">var xAxis = d3.svg.axis()</div><div class="line">.scale(x)</div><div class="line">.orient(&quot;bottom&quot;)</div><div class="line">.ticks(6);</div><div class="line"></div><div class="line">var yAxis = d3.svg.axis()</div><div class="line">.scale(y)</div><div class="line">.orient(&quot;left&quot;)</div><div class="line">.ticks(6);</div><div class="line"></div><div class="line">var color = d3.scale.category10();</div><div class="line"></div><div class="line">d3.csv(&quot;flowers.csv&quot;, function(error, data) &#123;</div><div class="line">if (error) throw error;</div><div class="line"></div><div class="line">var domainByTrait = &#123;&#125;,</div><div class="line">traits = d3.keys(data[0]()).filter(function(d) &#123; return d !== &quot;species&quot;&amp;&amp;d!=&quot;id&quot;; &#125;),</div><div class="line">n = traits.length;</div><div class="line"></div><div class="line">traits.forEach(function(trait) &#123;</div><div class="line">domainByTrait[trait]() = d3.extent(data, function(d) &#123; return d[trait](); &#125;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">xAxis.tickSize(size \*Â n);</div><div class="line">yAxis.tickSize(-size \*Â n);</div><div class="line"></div><div class="line">var brush = d3.svg.brush()</div><div class="line">.x(x)</div><div class="line">.y(y)</div><div class="line">.on(&quot;brushstart&quot;, brushstart)</div><div class="line">.on(&quot;brush&quot;, brushmove)</div><div class="line">.on(&quot;brushend&quot;, brushend);</div><div class="line"></div><div class="line">var svg = d3.select(&quot;body&quot;).append(&quot;svg&quot;)</div><div class="line">.attr(&quot;width&quot;, size \*Â n + padding)</div><div class="line">.attr(&quot;height&quot;, size \*Â n + padding)</div><div class="line">.append(&quot;g&quot;)</div><div class="line">.attr(&quot;transform&quot;, &quot;translate(&quot; + padding + &quot;,&quot; + padding / 2 + &quot;)&quot;);</div><div class="line"></div><div class="line">svg.selectAll(&quot;.x.axis&quot;)</div><div class="line">.data(traits)</div><div class="line">.enter().append(&quot;g&quot;)</div><div class="line">.attr(&quot;class&quot;, &quot;x axis&quot;)</div><div class="line">.attr(&quot;transform&quot;, function(d, i) &#123; return &quot;translate(&quot; + (n - i - 1) \*Â size + &quot;,0)&quot;; &#125;)</div><div class="line">.each(function(d) &#123; x.domain(domainByTrait[d]()); d3.select(this).call(xAxis); &#125;);</div><div class="line"></div><div class="line">svg.selectAll(&quot;.y.axis&quot;)</div><div class="line">.data(traits)</div><div class="line">.enter().append(&quot;g&quot;)</div><div class="line">.attr(&quot;class&quot;, &quot;y axis&quot;)</div><div class="line">.attr(&quot;transform&quot;, function(d, i) &#123; return &quot;translate(0,&quot; + i \*Â size + &quot;)&quot;; &#125;)</div><div class="line">.each(function(d) &#123; y.domain(domainByTrait[d]()); d3.select(this).call(yAxis); &#125;);</div><div class="line"></div><div class="line">var cell = svg.selectAll(&quot;.cell&quot;)</div><div class="line">.data(cross(traits, traits))</div><div class="line">.enter().append(&quot;g&quot;)</div><div class="line">.attr(&quot;class&quot;, &quot;cell&quot;)</div><div class="line">.attr(&quot;transform&quot;, function(d) &#123; return &quot;translate(&quot; + (n - d.i - 1) *Â size + &quot;,&quot; + d.jÂ * size + &quot;)&quot;; &#125;)</div><div class="line">.each(plot);</div><div class="line"></div><div class="line">// Titles for the diagonal.</div><div class="line">cell.filter(function(d) &#123; return d.i === d.j; &#125;).append(&quot;text&quot;)</div><div class="line">.attr(&quot;x&quot;, padding)</div><div class="line">.attr(&quot;y&quot;, padding)</div><div class="line">.attr(&quot;dy&quot;, &quot;.71em&quot;)</div><div class="line">.text(function(d) &#123; return d.x; &#125;);</div><div class="line"></div><div class="line">cell.call(brush);</div><div class="line"></div><div class="line">function plot(p) &#123;</div><div class="line">var cell = d3.select(this);</div><div class="line"></div><div class="line">x.domain(domainByTrait[p.x]());</div><div class="line">y.domain(domainByTrait[p.y]());</div><div class="line"></div><div class="line">cell.append(&quot;rect&quot;)</div><div class="line">.attr(&quot;class&quot;, &quot;frame&quot;)</div><div class="line">.attr(&quot;x&quot;, padding / 2)</div><div class="line">.attr(&quot;y&quot;, padding / 2)</div><div class="line">.attr(&quot;width&quot;, size - padding)</div><div class="line">.attr(&quot;height&quot;, size - padding);</div><div class="line"></div><div class="line">cell.selectAll(&quot;circle&quot;)</div><div class="line">.data(data)</div><div class="line">.enter().append(&quot;circle&quot;)</div><div class="line">.attr(&quot;cx&quot;, function(d) &#123; return x(d[p.x]()); &#125;)</div><div class="line">.attr(&quot;cy&quot;, function(d) &#123; return y(d[p.y]()); &#125;)</div><div class="line">.attr(&quot;r&quot;, 4)</div><div class="line">.style(&quot;fill&quot;, function(d) &#123;</div><div class="line">return color(d.species);</div><div class="line">&#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">var brushCell;</div><div class="line"></div><div class="line">// Clear the previously-active brush, if any.</div><div class="line">function brushstart(p) &#123;</div><div class="line">if (brushCell !== this) &#123;</div><div class="line">d3.select(brushCell).call(brush.clear());</div><div class="line">x.domain(domainByTrait[p.x]());</div><div class="line">y.domain(domainByTrait[p.y]());</div><div class="line">brushCell = this;</div><div class="line">&#125;</div><div class="line">d3.select(&apos;#RadViz&apos;).selectAll(&apos;.nodes&apos;)</div><div class="line">.classed(&apos;hidden&apos;,true);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">// Highlight the selected circles.</div><div class="line">function brushmove(p) &#123;</div><div class="line">var e = brush.extent();</div><div class="line">svg.selectAll(&quot;circle&quot;).classed(&quot;hidden&quot;, function(d) &#123;</div><div class="line"></div><div class="line"></div><div class="line">if( e[0]()[0]() \&gt; d[p.x]() || d[p.x]() \&gt; e[1]()[0]()</div><div class="line">|| e[0]()[1]() \&gt; d[p.y]() || d[p.y]() \&gt; e[1]()[1]())&#123;</div><div class="line">return true;</div><div class="line">&#125;else&#123;</div><div class="line">//                    console.log(d);</div><div class="line">d3.select(&apos;#RadViz&apos;).selectAll(&apos;.nodes&apos;)</div><div class="line">.filter(function(dd)&#123;</div><div class="line"></div><div class="line">return d.id==dd[3]();</div><div class="line">&#125;)</div><div class="line">.classed(&apos;hidden&apos;,false);</div><div class="line"></div><div class="line">return false;</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">// If the brush is empty, select all circles.</div><div class="line">function brushend() &#123;</div><div class="line">if (brush.empty())</div><div class="line">&#123;</div><div class="line">svg.selectAll(&quot;.hidden&quot;).classed(&quot;hidden&quot;, false);</div><div class="line">d3.select(&apos;#RadViz&apos;).selectAll(&apos;.nodes&apos;)</div><div class="line">.classed(&apos;hidden&apos;,false);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">d3.select(self.frameElement).style(&quot;height&quot;, size \*Â n + padding + 20 + &quot;px&quot;);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">function cross(a, b) &#123;</div><div class="line">var c = [](), n = a.length, m = b.length, i, j;</div><div class="line">for (i = -1; ++i \&lt; n;) for (j = -1; ++j \&lt; m;) c.push(&#123;x: a[i](), i: i, y: b[j](), j: j&#125;);</div><div class="line">return c;</div><div class="line">&#125;</div><div class="line"></div><div class="line">\&lt;/script\&gt;</div><div class="line"></div><div class="line"></div><div class="line">\&lt;/body\&gt;</div><div class="line">\&lt;/html\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>è¿™æ¬¡å®ç°çš„associate brushæ“ä½œï¼Œæœ‰ä¸‹é¢éœ€è¦æ³¨æ„å’Œå€¼å¾—æ€»ç»“çš„åœ°æ–¹ï¼š</p><ol><li>é¦–å…ˆè€ƒè™‘çš„æ˜¯ï¼Œæ—¢ç„¶éœ€è¦å®ç°associateï¼Œå°±å¿…é¡»è¦æœ‰å°†ä¸¤ä¸ªviewè”ç³»èµ·æ¥çš„ä¸œè¥¿ï¼Œå¯ä»¥ç±»æ¯”æ•°æ®åº“è¡¨ä¸­çš„å¤–é”®ï¼Œä¸¤ä¸ªè¡¨éƒ½æœ‰è¿™ä¸ªé”®ï¼Œå°±å¯ä»¥è”ç³»èµ·æ¥ã€‚</li><li>ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯brushedã€brushstartå’Œbrushendè¿™ä¸‰ä¸ªå‡½æ•°ï¼Œå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç‚¹åœ¨brushçš„åŒºåŸŸé‡Œé¢è¿˜æ˜¯å¤–é¢ï¼Œä»¥åŠå¦‚ä½•åœ¨brushåŠ¨ä½œå®Œæˆä¹‹åï¼Œç»§ç»­ä¿æŒbrushç‚¹çš„highlightï¼Œéœ€è¦åŠ ä¸€å¥åˆ¤æ–­ifï¼ˆbrush.emtpy()ï¼‰ã€‚</li><li>æ§åˆ¶æ˜¯å¦é«˜äº®ï¼Œå¯ä»¥ç»™circleåŠ ä¸€ä¸ªclass .hidden,è¿™æ ·çš„è¯å¯ä»¥æ–¹ä¾¿çš„ç»™circleåŠ ä¸Šè¿™ä¸ªclassï¼Œä¹Ÿæ–¹ä¾¿åé¢ä¸è¦è¿™ä¸ªclassçš„æ—¶å€™å»æ‰ï¼Œåˆšå¼€å§‹å®ç°çš„æ—¶å€™è¿˜åŠ äº†å¯¹åŸæ¥é¢œè‰²çš„åˆ¤æ–­ï¼Œå¾ˆéº»çƒ¦ï¼Œè€Œå¼•å…¥äº†.hidden classåï¼Œæƒ³åŠ ä¸Šè¿™ä¸ªclassçš„æ—¶å€™å°±ä¸€å¥ .classed(â€˜hiddenâ€™,true)å°±å¯ä»¥äº†ï¼Œä¸æƒ³è¦çš„æ—¶å€™ï¼Œç”¨.classed(â€˜hiddenâ€™,false)å°±å»æ‰äº†è¿™ä¸ªåŒ…è¢±ï¼Œéå¸¸æ–¹ä¾¿ã€‚</li><li>å…³äºhiddenè¿™ä¸ªclassï¼Œè¿˜é‡åˆ°äº†ä¸€ä¸ªå¤§å‘ã€‚åœ¨å‰ç«¯æµ‹è¯•å¯ä»¥é€šè¿‡ï¼Œä½†æ˜¯åŠ å…¥äº†node.jsçš„åç«¯ä¹‹åï¼Œå§‹ç»ˆæµ‹è¯•æ— æ³•é€šè¿‡ï¼Œå‡ºç°äº†hiddençš„ç±»å®Œå…¨æ¶ˆå¤±äº†çš„æƒ…å†µï¼Œå…¶ä»–åœ°æ–¹æ€ä¹ˆæ‰¾ä¹Ÿæ‰¾ä¸åˆ°é—®é¢˜ï¼Œå¯èƒ½æ˜¯hidden classæ˜¯nodeçš„ä¿ç•™classï¼Ÿå°†hiddenæ”¹æˆhidden1ä¹‹åé—®é¢˜å°±è§£å†³äº†ï¼Œä»¥åè¿™ç§æ•æ„Ÿçš„è¯å‰é¢è¿˜æ˜¯åŠ ä¸Šmyçš„å¥½ï¼Œå¦‚myHiddenâ€¦</li></ol><p>å‘ç°ä¸€ä¸ªbugï¼Œå°±æ˜¯brushä¹‹åï¼Œå¦‚æœå†æ¬¡resize brushçš„æ¡†ï¼Œå¯¹åº”çš„å·²ç»ç€è‰²äº†çš„å…¶ä»–ç‚¹ä¸ä¼šç›¸åº”çš„å˜åŒ–ï¼Œéœ€è¦ä¿®æ”¹brushmoveå‡½æ•°ä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">function brushmove(p) &#123;</div><div class="line">var e = brush.extent();</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">svg.selectAll(&quot;circle&quot;).classed(&quot;hidden&quot;, function(d) &#123;</div><div class="line"></div><div class="line"></div><div class="line">if( e[0]()[0]() \&gt; d[p.x]() || d[p.x]() \&gt; e[1]()[0]()</div><div class="line">|| e[0]()[1]() \&gt; d[p.y]() || d[p.y]() \&gt; e[1]()[1]())&#123;</div><div class="line"></div><div class="line">d3.select(&apos;#RadViz&apos;).selectAll(&apos;.nodes&apos;)</div><div class="line">.filter(function(dd)&#123;</div><div class="line">return d.id==dd[3]()</div><div class="line">&#125;).classed(&apos;hidden&apos;,true);</div><div class="line"></div><div class="line">return true;</div><div class="line">&#125;else&#123;</div><div class="line">//                    console.log(d);</div><div class="line">d3.select(&apos;#RadViz&apos;).selectAll(&apos;.nodes&apos;)</div><div class="line">.filter(function(dd)&#123;</div><div class="line"></div><div class="line">return d.id==dd[3]();</div><div class="line">&#125;)</div><div class="line">.classed(&apos;hidden&apos;,false);</div><div class="line"></div><div class="line"></div><div class="line">return false;</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;è¿™ç¯‡åšå®¢è®°å½•äº†åœ¨ä¸Šä¸€ç¯‡åšå®¢åŠ å…¥scatterplot matrixçš„åŸºç¡€ä¸Šï¼Œå®ç°äº†associate brushçš„æ“ä½œï¼Œå³ï¼Œä»RadVizä¸­brushä¸€å—åŒºåŸŸï¼Œå³è¾¹16ä¸ªscatterploté‡Œå¯¹åº”çš„ç‚¹éƒ½ä¼šé«˜äº®å‡ºæ¥ï¼Œå…¶ä»–çš„ç‚¹å°†æš—æ·¡ä¸‹å»ï¼›åŒæ ·çš„ï¼Œä»å³è¾¹16ä¸ªscatterpl
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>drop and drag in d3</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/drop%20and%20drag%20in%20d3js/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/drop and drag in d3js/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-23T11:40:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Behavior-in-d3"><a href="#Behavior-in-d3" class="headerlink" title="Behavior in d3"></a>Behavior in d3</h1><p>åœ¨d3ä¸­ï¼Œè¡Œä¸ºè¢«è®¾è®¡æˆäº†ä¸€ç§ç»„ä»¶ï¼Œå¯ä»¥åˆ›å»ºä¸€ç³»åˆ—çš„äº‹ä»¶ï¼Œå¹¶ç»‘å®šåˆ°è°ƒç”¨è¿™äº›è¡Œä¸ºçš„å…ƒç´ ä¸Šã€‚æœ€å¸¸è§çš„è¡Œä¸ºæœ‰æ‹–æ‹½ä¸ç¼©æ”¾ï¼Œä½¿ç”¨è¿™äº›è¡Œä¸ºå¯ä»¥å¾ˆæ–¹ä¾¿åœ°åœ¨æ‹–æ‹½æˆ–è€…ç¼©æ”¾çš„å¼€å§‹ã€è¿‡ç¨‹ä¸­ä»¥åŠç»“æŸæ—¶è¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚</p><p>è¿™ç¯‡åšå®¢ä¸­ï¼Œå°±ä»¥æ‹–æ‹½ä¸ºä¾‹ï¼Œå¹¶å€ŸåŠ©ä¹‹å‰å®ç°çš„çƒ­åŠ›å›¾ï¼Œå®ç°æ‹–æ‹½dimensionçš„labelä»¥è¾¾åˆ°reoderç»´åº¦çš„æ•ˆæœã€‚ä¸ºäº†ä½¿ç”¨ä¸‰ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬ä¼šè®©å¼€å§‹æ‹–æ‹½çš„æ—¶å€™ï¼Œç»´åº¦åå˜æˆçº¢è‰²ã€å­—ä½“å˜å¤§æ¥è¡¨ç¤ºå¼ºè°ƒçš„æ•ˆæœï¼›åœ¨æ‹–æ‹½è¿‡ç¨‹ä¸­ï¼Œè®©labelç´§è·Ÿé¼ æ ‡çš„ä½ç½®ï¼›å¹¶ä¸”åˆ¤æ–­æœ€ç»ˆçš„ä½ç½®ï¼Œäº¤æ¢ä¸¤ä¸ªç»´åº¦ï¼Œå¹¶é‡æ–°ç»˜åˆ¶æ•´ä¸ªçƒ­åŠ›å›¾ã€‚</p><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œå¼€å§‹ç§»åŠ¨çš„æ—¶å€™çš„ï¼Œè¿è¡Œæƒ…å†µåº”è¯¥åƒä¸‹é¢è¿™æ ·ã€‚<br><img src="http://i3.piimg.com/20f52681eff4f677.jpg" alt=""></p><h1 id="drag"><a href="#drag" class="headerlink" title="drag"></a>drag</h1><p>åˆ›å»ºä¸€ä¸ªæ–°çš„æ‹–æ‹½è¡Œä¸ºéå¸¸ç®€å•ï¼Œvar drag = d3.behavior.drag()å°±åˆ›å»ºå¥½äº†ã€‚åœ¨è¿™ä¸ªè¡Œä¸ºä¸Šï¼Œå¯ä»¥æŒ‡å®šæ‹–æ‹½äº‹ä»¶ç±»å‹çš„ç›‘å¬å™¨ï¼Œæ”¯æŒçš„äº‹ä»¶ç±»å‹æœ‰ä¸‰ç§ï¼Œ<strong>dragstart/drag/dragend</strong>ï¼Œåˆ†åˆ«æ˜¯ä¸Šé¢æåˆ°çš„æ‹–åŠ¨å¼€å§‹æ—¶è§¦å‘çš„å‡½æ•°ï¼Œæ‹–åŠ¨æ—¶è§¦å‘å’Œæ‹–åŠ¨ç»“æŸæ—¶è§¦å‘ã€‚<br>å¯¹åº”åˆ°ä¸Šé¢çš„è¦æ±‚ï¼Œç»´åº¦åå˜æˆçº¢è‰²ã€å­—ä½“å˜å¤§æ¥è¡¨ç¤ºå¼ºè°ƒçš„æ•ˆæœï¼ˆå¼€å§‹æ‹–æ‹½æ—¶ï¼‰ï¼Œè®©labelç´§è·Ÿé¼ æ ‡çš„ä½ç½®ï¼ˆæ‹–æ‹½è¿‡ç¨‹ä¸­ï¼‰ï¼Œå¹¶ä¸”åˆ¤æ–­æœ€ç»ˆçš„ä½ç½®ï¼Œäº¤æ¢ä¸¤ä¸ªç»´åº¦ï¼Œå¹¶é‡æ–°ç»˜åˆ¶æ•´ä¸ªçƒ­åŠ›å›¾ï¼ˆæ‹–æ‹½ç»“æŸåï¼‰ã€‚</p><h1 id="å®ç°çš„ç»†èŠ‚"><a href="#å®ç°çš„ç»†èŠ‚" class="headerlink" title="å®ç°çš„ç»†èŠ‚"></a>å®ç°çš„ç»†èŠ‚</h1><p>éœ€è¦æ³¨æ„çš„æœ‰å‡ ç‚¹ï¼Œ</p><ol><li>ç”±äºçƒ­åŠ›å›¾çš„å®ç°æ–¹å¼ï¼Œæ¨ªç€çš„dimensionå’Œç«–ç€çš„dimensionçš„dragæ˜¯ä¸åŒçš„ã€‚ä½†æ˜¯ä»–ä»¬ä¹Ÿæœ‰å¯ä»¥å…±ç”¨çš„åœ°æ–¹ï¼ŒdragEndæ˜¯å¯ä»¥å…±ç”¨çš„ï¼Œä½†æ˜¯å¦å¤–ä¸¤ä¸ªæ˜¯ä¸å¯ä»¥çš„ï¼Œæ‰€ä»¥éœ€è¦å»ºç«‹ä¸¤ä¸ªdragçš„äº‹ä»¶ã€‚</li><li>é‡æ–°ç»˜åˆ¶æ¶‰åŠåˆ°äº†è¡Œå’Œåˆ—ï¼Œå˜æ¢æ˜¯éœ€è¦è€ƒè™‘å¦‚ä½•å®ç°çš„ã€‚</li><li>å¦‚ä½•åˆ¤æ–­labelæ‹–æ‹½ä¹‹åæ˜¯åˆ°å“ªé‡Œäº†ï¼Œæ˜¯å¦è¶…å‡ºäº†è¾¹ç•Œ(è¶…è¿‡ä¸Šç•Œè®¤ä¸ºå’Œç¬¬ä¸€ä¸ªæ¢ï¼Œè¶…è¿‡ä¸‹ç•Œè®¤ä¸ºè®¤ä¸ºå’Œæœ€åä¸€ä¸ªæ¢ã€‚) æŸ¥çœ‹è¾…åŠ©å‡½æ•°changeLabelOrder()</li><li>çœŸæ­£æ„ä¹‰ä¸Šçš„äº¤æ¢ï¼Œä¸ä»…ä»…æ˜¯ä¸¤ä¸ªlabelä¹‹é—´çš„äº¤æ¢ï¼Œè¿˜æœ‰ç›¸å…³æ€§çš„äº¤æ¢ã€‚</li><li>Math.ceil()å’ŒMath.floor()çš„åŒºåˆ«ã€‚</li></ol><p>ä»£ç è§æ–‡æœ«çš„é™„å½•ã€‚</p><h1 id="å°é¢èµ„åŠ©"><a href="#å°é¢èµ„åŠ©" class="headerlink" title="å°é¢èµ„åŠ©"></a>å°é¢èµ„åŠ©</h1><p>å¦‚æœæœ¬æ–‡å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç”¨æ”¯ä»˜å®æ‰«ç å°é¢èµåŠ©æˆ‘ï¼Œè°¢è°¢ï¼<br><img src="http://i13.tietuku.cn/eec06685d2e66e2c.png" alt=""></p><h1 id="é™„å½•ï¼ˆä»£ç ï¼‰"><a href="#é™„å½•ï¼ˆä»£ç ï¼‰" class="headerlink" title="é™„å½•ï¼ˆä»£ç ï¼‰"></a>é™„å½•ï¼ˆä»£ç ï¼‰</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">  var colorScales = d3.scale.linear()</div><div class="line">.domain([-1,0,1]())</div><div class="line">.range([&quot;#31a354&quot;,&quot;#ffffff&quot;,&quot;#e6550d&quot;]());</div><div class="line"></div><div class="line">var w = element[0]().offsetWidth;</div><div class="line">var h = element[0]().offsetHeight;</div><div class="line">var width = w - options.margin.left - options.margin.right;</div><div class="line">var height = h - options.margin.top - options.margin.bottom;</div><div class="line"></div><div class="line">d3.select(element[0]()).select(&quot;svg&quot;).remove();</div><div class="line"></div><div class="line">var svg = d3.select(element[0]()).append(&quot;svg&quot;)</div><div class="line">.attr(&quot;width&quot;, width*2 + options.margin.left + options.margin.right)</div><div class="line">.attr(&quot;height&quot;, height + options.margin.top + options.margin.bottom)</div><div class="line">.append(&quot;g&quot;)</div><div class="line">.attr(&apos;class&apos;,&apos;heat&apos;)</div><div class="line">.attr(&quot;transform&quot;, &quot;translate(&quot; + options.margin.left + &quot;,&quot; + options.margin.top + &quot;)&quot;)</div><div class="line">//                        .append(&apos;g&apos;)</div><div class="line">//                        .attr(&apos;class&apos;,&apos;rad&apos;);</div><div class="line"></div><div class="line">var xu = &#123;&#125;;</div><div class="line">var x = []();</div><div class="line">var yu = &#123;&#125;;</div><div class="line">var y = []();</div><div class="line"></div><div class="line">var theLabel = 0;</div><div class="line"></div><div class="line">for (var i in scope.data) &#123;</div><div class="line">if (typeof(xu[scope.data\[i]().x]) == &quot;undefined&quot;) &#123;</div><div class="line">x.push(scope.data[i]().x);</div><div class="line">&#125;</div><div class="line">xu[scope.data\[i]().x] = 0;</div><div class="line">if (typeof(yu[scope.data\[i]().y]) == &quot;undefined&quot;) &#123;</div><div class="line">y.push(scope.data[i]().y);</div><div class="line">&#125;</div><div class="line">yu[scope.data\[i]().y] = 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line">for (d in scope.data) &#123;</div><div class="line">scope.data[d]().xIndex = x.indexOf(scope.data[d]().x);</div><div class="line">scope.data[d]().yIndex = y.indexOf(scope.data[d]().y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">var drag = d3.behavior.drag()</div><div class="line">.on(&apos;drag&apos;,dragText)</div><div class="line">.on(&apos;dragstart&apos;,dragStart)</div><div class="line">.on(&apos;dragend&apos;,dragEnd);</div><div class="line"></div><div class="line">var dragX = d3.behavior.drag()</div><div class="line">.on(&apos;drag&apos;,dragTextX)</div><div class="line">.on(&apos;dragstart&apos;,dragStartX)</div><div class="line">.on(&apos;dragend&apos;,dragEnd);</div><div class="line"></div><div class="line">function dragStartX () &#123;</div><div class="line">d3.select(this).attr(&apos;fill&apos;, &apos;red&apos;).attr(&apos;font-weight&apos;, &apos;900&apos;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">function dragTextX (d,i)&#123;</div><div class="line">//                        console.log(i);</div><div class="line"></div><div class="line">var y=   d3.event.x-i*xGridSize;</div><div class="line">var x=  -d3.event.y;</div><div class="line">//                        console.log(&quot;d3.event.y:&quot;+d3.event.y);</div><div class="line">//                        console.log(&quot;d3.event.x:&quot;+d3.event.x);</div><div class="line">//                        console.log(xGridSize+&quot;  == &quot;+yGridSize);</div><div class="line"></div><div class="line">//                        var tmp=(d3.event.x-xGridSize/2)/xGridSize;</div><div class="line">var tmp = Math.ceil(d3.event.x/xGridSize)-1;</div><div class="line">//                        console.log(tmp+&quot;  tmp&quot;)</div><div class="line"></div><div class="line">if(tmp\&lt;=0)</div><div class="line">&#123;</div><div class="line">theLabel=0;</div><div class="line">&#125;else if(tmp\&gt;=Math.sqrt(data.length))</div><div class="line">&#123;</div><div class="line">theLabel=Math.sqrt(data.length)-1;</div><div class="line">&#125;else</div><div class="line">&#123;</div><div class="line">theLabel=tmp;</div><div class="line">&#125;</div><div class="line"></div><div class="line">d3.select(this)</div><div class="line">.attr(&apos;transform&apos;,function(d)&#123;</div><div class="line">return &quot;rotate(-90) translate(&quot;+x+&apos;,&apos;+y+&apos;)&apos;;</div><div class="line">&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">function dragStart ()&#123;</div><div class="line">d3.select(this).attr(&apos;fill&apos;,&apos;red&apos;).attr(&apos;font-weight&apos;,&apos;900&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">function dragText (d,i)&#123;</div><div class="line">//                        console.log(i);</div><div class="line"></div><div class="line">var x=   d3.event.x;</div><div class="line">var y=  d3.event.y-yGridSize*i;</div><div class="line">//                        console.log(&quot;d3.event.y:&quot;+d3.event.y);</div><div class="line"></div><div class="line">var tmp = cal((y-yGridSize)/yGridSize);</div><div class="line">//                        console.log(tmp+&quot;  tmp&quot;);</div><div class="line"></div><div class="line">if(tmp+i\&gt;=Math.sqrt(data.length))</div><div class="line">&#123;</div><div class="line">theLabel=Math.sqrt(data.length);</div><div class="line">&#125;else if(tmp+i\&lt;=0)&#123;</div><div class="line">theLabel=0;</div><div class="line">&#125;else&#123;</div><div class="line">theLabel=tmp+i;</div><div class="line">&#125;</div><div class="line"></div><div class="line">d3.select(this)</div><div class="line">.attr(&apos;transform&apos;,function(d)&#123;</div><div class="line">return &quot;translate(&quot;+x+&apos;,&apos;+y+&apos;)&apos;;</div><div class="line">&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">function dragEnd(d,i)&#123;</div><div class="line">d3.select(this)</div><div class="line">.attr(&apos;fill&apos;,&apos;black&apos;);</div><div class="line"></div><div class="line">if(theLabel!=i)</div><div class="line">changeLabelOrder(data,theLabel,i);</div><div class="line"></div><div class="line">scope.$apply(order); //very import</div><div class="line"></div><div class="line">//                        console.log(order);</div><div class="line"></div><div class="line">render();</div><div class="line">renderRadViz();</div><div class="line">&#125;</div><div class="line"></div><div class="line">var xGridSize = Math.floor(width / x.length);</div><div class="line">var yGridSize = Math.floor(height / y.length);</div><div class="line">var legendElementWidth = Math.floor(width *Â options.legendWidth / (options.buckets));</div><div class="line">var legendElementHeight = height / 20;</div><div class="line"></div><div class="line">var yLabels = svg.selectAll(&quot;.yLabel&quot;)</div><div class="line">.data(y)</div><div class="line">.enter().append(&quot;text&quot;)</div><div class="line">.text(function (d) &#123; return d; &#125;)</div><div class="line">.attr(&quot;x&quot;, 0)</div><div class="line">.attr(&quot;y&quot;, function (d, i) &#123; return i *Â yGridSize; &#125;)</div><div class="line">.style(&quot;text-anchor&quot;, &quot;end&quot;)</div><div class="line">.attr(&quot;transform&quot;, &quot;translate(-6,&quot; + yGridSize / 1.5 + &quot;)&quot;)</div><div class="line">.attr(&quot;class&quot;, function (d, i) &#123; return (&quot;yLabel axis&quot;); &#125;)</div><div class="line">.call(drag);</div><div class="line"></div><div class="line">var xLabels = svg.selectAll(&quot;.xLabel&quot;)</div><div class="line">.data(x)</div><div class="line">.enter().append(&quot;text&quot;)</div><div class="line">.text(function(d) &#123; return d; &#125;)</div><div class="line">.attr(&quot;y&quot;, function(d, i) &#123; return i *Â xGridSize; &#125;)</div><div class="line">.attr(&quot;x&quot;, 0)</div><div class="line">.style(&quot;text-anchor&quot;, &quot;start&quot;)</div><div class="line">.attr(&quot;transform&quot;, &quot;rotate(-90) translate(10, &quot; + xGridSize / 2 + &quot;)&quot;)</div><div class="line">.attr(&quot;class&quot;, function(d, i) &#123; return (&quot;xLabel axis&quot;); &#125;)</div><div class="line">.call(dragX);</div><div class="line"></div><div class="line">//                    var colorScales = []();</div><div class="line">//                    if (options.breaks != null &amp;&amp; options.breaks.length \&gt; 0) &#123;</div><div class="line">//                        for (b in options.colors) &#123;</div><div class="line">//                            colorScales.push(d3.scale.quantile()</div><div class="line">//                                .domain([0, options.buckets - 1, d3.max(scope.data, function(d) &#123; return d.value; &#125;)]())</div><div class="line">//                                .range(options.colors[b]()));</div><div class="line">//                        &#125;</div><div class="line">//                    &#125; else &#123;</div><div class="line">//                        colorScales.push(d3.scale.quantile()</div><div class="line">//                            .domain([0, options.buckets - 1, d3.max(scope.data, function(d) &#123; return d.value; &#125;)]())</div><div class="line">//                            .range(options.colors));</div><div class="line">//                    &#125;</div><div class="line"></div><div class="line">var cards = svg.selectAll(&quot;.square&quot;)</div><div class="line">.data(scope.data);</div><div class="line"></div><div class="line">//                    console.log(scope.data[0]())</div><div class="line"></div><div class="line">cards.enter().append(&quot;rect&quot;)</div><div class="line">.filter(function(d) &#123; return d.value != null &#125;)</div><div class="line">.attr(&quot;x&quot;, function(d) &#123; return d.xIndex *Â xGridSize; &#125;)</div><div class="line">.attr(&quot;y&quot;, function(d) &#123; return d.yIndex *Â yGridSize; &#125;)</div><div class="line">.attr(&quot;class&quot;, &quot;square&quot;)</div><div class="line">.attr(&quot;width&quot;, xGridSize)</div><div class="line">.attr(&quot;height&quot;, yGridSize)</div><div class="line">.on(&quot;click&quot;, function(d) &#123; scope.dispatch.click(d); &#125;)</div><div class="line">.on(&quot;mouseover&quot;, function(d) &#123; scope.dispatch.mouseover(d); &#125;)</div><div class="line">.on(&quot;mouseout&quot;, function(d) &#123; scope.dispatch.mouseout(d); &#125;)</div><div class="line">.on(&quot;mousemove&quot;, function(d) &#123; scope.dispatch.mousemove(d); &#125;)</div><div class="line">.style(&quot;fill&quot;, &quot;#ffffff&quot;);</div><div class="line"></div><div class="line">cards.transition().duration(options.duration).style(&quot;fill&quot;, function(d) &#123;</div><div class="line">if (options.customColors &amp;&amp; options.customColors.hasOwnProperty(d.value)) &#123;</div><div class="line">return options.customColors[d.value]();</div><div class="line">&#125; else if (options.breaks != null &amp;&amp; options.breaks.length \&gt; 0) &#123;</div><div class="line">for (b in options.breaks) &#123;</div><div class="line">if (d.xIndex \&lt; options.breaks[b]()) &#123;</div><div class="line">return colorScales[b]()(d.value);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">return colorScales[options.breaks.length]()(d.value);</div><div class="line">&#125; else &#123;</div><div class="line">return colorScales(d.value);</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">cards.exit().remove();</div><div class="line"></div><div class="line">if (options.legend) &#123;</div><div class="line"></div><div class="line">var lenendData = []();</div><div class="line">for(var i=0;i\&lt;11;i++)</div><div class="line">&#123;</div><div class="line">lenendData.push(i/5-1);</div><div class="line">&#125;</div><div class="line"></div><div class="line">var legend = svg.selectAll(&quot;.legend&quot;)</div><div class="line">.data(lenendData)</div><div class="line"></div><div class="line">legend.enter().append(&quot;g&quot;).attr(&quot;class&quot;, &quot;legend&quot;);</div><div class="line"></div><div class="line">legend.append(&quot;rect&quot;)</div><div class="line">.attr(&quot;x&quot;, function(d, i) &#123; return legendElementWidth *Â i; &#125;)</div><div class="line">.attr(&quot;y&quot;, height *Â 1.05)</div><div class="line">.attr(&quot;width&quot;, legendElementWidth)</div><div class="line">.attr(&quot;height&quot;, legendElementHeight)</div><div class="line">.style(&quot;fill&quot;, function(d, i) &#123; return colorScales(lenendData[i]()); &#125;)</div><div class="line">.style(&quot;visibility&quot;, function(d, i) &#123; return(i \&lt; options.buckets ? &quot;visible&quot; : &quot;hidden&quot;) &#125;);</div><div class="line"></div><div class="line">legend.append(&quot;text&quot;)</div><div class="line">.attr(&quot;class&quot;, &quot;legendLabel&quot;)</div><div class="line">.text(function(d,i) &#123; if(i%2==0) return lenendData[i]().toFixed(1); &#125;)</div><div class="line">.attr(&quot;x&quot;, function(d, i) &#123; return legendElementWidth *Â i; &#125;)</div><div class="line">.attr(&quot;y&quot;, height *Â 1.15)</div><div class="line">.style(&quot;text-anchor&quot;, &quot;middle&quot;);</div><div class="line"></div><div class="line">legend.exit().remove();</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div><div class="line">scope.$watch(&quot;data&quot;, debounce(function() &#123;</div><div class="line">render();</div><div class="line">&#125;,true),400);</div><div class="line"></div><div class="line">scope.$watch(&quot;order&quot;, debounce(function() &#123;</div><div class="line">render();</div><div class="line">renderRadViz();</div><div class="line">&#125;,true),400);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//                d3.select(window).on(&quot;resize&quot;, debounce(function() &#123;</div><div class="line">//                    render();</div><div class="line">//                &#125;, 500));</div><div class="line"></div><div class="line">function cal(x)</div><div class="line">&#123;</div><div class="line">if(x\&gt;0)</div><div class="line">return Math.ceil(x);</div><div class="line">else if (x==0) &#123;</div><div class="line">return 0;</div><div class="line">&#125;else&#123;</div><div class="line">return Math.ceil(x);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">function changeLabelOrder(data,i,j)</div><div class="line">&#123;</div><div class="line">var tmpLabel = order[i]();</div><div class="line">order[i]()=order[j]();</div><div class="line">order[j]()=tmpLabel;</div><div class="line">//                    console.log(order);</div><div class="line"></div><div class="line">var iLabel = &quot;&quot;;</div><div class="line">var jLabel = &quot;&quot;;</div><div class="line">for(var k=0;k\&lt;data.length;k++)</div><div class="line">&#123;</div><div class="line">if(data[k]().xIndex===i) &#123;</div><div class="line">iLabel = data[k]().x;</div><div class="line"></div><div class="line">&#125;</div><div class="line">//                        console.log(iLabel);</div><div class="line">&#125;</div><div class="line">for(var k=0;k\&lt;data.length;k++)</div><div class="line">&#123;</div><div class="line">if(data[k]().yIndex===j) &#123;</div><div class="line">jLabel = data[k]().y;</div><div class="line"></div><div class="line">&#125;</div><div class="line">//                        console.log(jLabel);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">for(var k=0;k\&lt; data.length;k++)</div><div class="line">&#123;</div><div class="line">if(data[k]().xIndex===i)&#123;</div><div class="line">data[k]().xIndex=j;</div><div class="line">data[k]().x=jLabel;</div><div class="line">&#125;else if(data[k]().xIndex===j)</div><div class="line">&#123;</div><div class="line">data[k]().xIndex=i;</div><div class="line">data[k]().x=iLabel;</div><div class="line">&#125;</div><div class="line"></div><div class="line">if(data[k]().yIndex===i)&#123;</div><div class="line">data[k]().yIndex=j;</div><div class="line">data[k]().y=jLabel;</div><div class="line">&#125;else if(data[k]().yIndex===j)</div><div class="line">&#123;</div><div class="line">data[k]().yIndex=i;</div><div class="line">data[k]().y=iLabel;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">var n = Math.sqrt(data.length);</div><div class="line">for(var k=0;k\&lt;n;k++)</div><div class="line">&#123;</div><div class="line"></div><div class="line">tmp = data[i+k*n]().value;</div><div class="line">data[i+k*n]().value=data[j+k*n]().value;</div><div class="line">data[j+k*n]().value=tmp;</div><div class="line">&#125;</div><div class="line">for(var k=0;k\&lt;n;k++)</div><div class="line">&#123;</div><div class="line"></div><div class="line">tmp = data[i*n+k]().value;</div><div class="line">data[i*n+k]().value=data[j*n+k]().value;</div><div class="line">data[k+j*n]().value=tmp;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Behavior-in-d3&quot;&gt;&lt;a href=&quot;#Behavior-in-d3&quot; class=&quot;headerlink&quot; title=&quot;Behavior in d3&quot;&gt;&lt;/a&gt;Behavior in d3&lt;/h1&gt;&lt;p&gt;åœ¨d3ä¸­ï¼Œè¡Œä¸ºè¢«è®¾è®¡æˆäº†ä¸€ç§ç»„ä»¶ï¼Œå¯ä»¥åˆ›å»ºä¸€
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>å†·é—¨ä½†å®ç”¨çš„d3.jså†…ç½®å‡½æ•°</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/%E5%86%B7%E9%97%A8%E4%BD%86%E5%AE%9E%E7%94%A8%E7%9A%84d3.js%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/å†·é—¨ä½†å®ç”¨çš„d3.jså†…ç½®å‡½æ•°/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2016-06-07T03:12:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨d3.jsçš„APIæ–‡æ¡£ä¸­ï¼Œæä¾›äº†å¾ˆå¤šå†…ç½®çš„å‡½æ•°ï¼Œä½†æ˜¯æœ‰äº›å¾ˆæœ‰ç”¨çš„å†…ç½®å‡½æ•°å´è¢«æ— æƒ…çš„å¿½ç•¥äº†ï¼Œè¿™ç¯‡åšå®¢å°±æ¥æ•´ç†æ•´ç†è¿™äº›è¢«é—å¿˜å´å¾ˆå®ç”¨çš„å‡½æ•°ã€‚å¸Œæœ›æ•´ç†è¿‡åï¼Œä»–ä»¬ä¸å†è¢«é—å¿˜ã€‚</p><h1 id="selection-classed-name-ã€valueã€‘"><a href="#selection-classed-name-ã€valueã€‘" class="headerlink" title="selection.classed(name,ã€valueã€‘)"></a>selection.classed(name,ã€valueã€‘)</h1><p>valueå‚æ•°å¯é€‰ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œåˆ™è¿”å›ä¸nameå‚æ•°åŒ¹é…çš„ç¬¬ä¸€ä¸ªéç©ºå…ƒç´ æ˜¯å¦ç»‘å®šäº†æŒ‡å®šçš„CSSç±»ï¼Œtrueè¡¨ç¤ºç»‘å®šï¼Œfalseè¡¨ç¤ºæœªç»‘å®šã€‚å¦‚æœvalueæŒ‡å®šäº†çš„è¯ï¼Œå°±æ˜¯ä¸ºselectionæ·»åŠ /åˆ é™¤CSSç±»ã€‚<br>è¿™ç‚¹ä¸selection.attr(name,ã€valueã€‘)éå¸¸ç±»ä¼¼ï¼Œä½†æ˜¯ç›¸æ¯”è€Œè¨€ï¼Œå°±å†·é—¨çš„å¤šï¼Œææ€•æ²¡æœ‰å¤šå°‘äººä¸çŸ¥é“selection.attr(name,ã€valueã€‘)ï¼Œä½†æ˜¯æœ‰å¾ˆå¤šäººçœŸçš„ä¸çŸ¥é“selection.classed(name,ã€valueã€‘)ã€‚<br>è¿™ä¸ªå‡½æ•°å¾ˆå®ç”¨ï¼Œæ¯”å¦‚é¼ æ ‡è¿›å…¥æŸäº›ç‚¹ï¼Œè®©è¿™äº›ç‚¹é«˜äº®ä»¥è¡¨ç¤ºå¼ºè°ƒï¼Œä½†æ˜¯ç§»å‡ºå»ä¹‹åï¼Œè®©ä»–ä»¬å›å¤åŸæ¥çš„æ ·å¼å°±å¯ä»¥ç”¨è¿™ä¸ªå‡½æ•°ï¼Œå…å»äº†é‡æ–°è®¾ç½®æ ·å¼çš„éº»çƒ¦ï¼Œç”šè‡³æœ‰æ—¶å€™æ¢å¤åŸæ¥æ ·å¼çš„æ—¶å€™ï¼Œè¿˜éœ€è¦åˆ¤æ–­ï¼Œå°±æ›´éº»çƒ¦äº†ã€‚</p><h1 id="transition-filter-selector"><a href="#transition-filter-selector" class="headerlink" title="transition.filter(selector)"></a>transition.filter(selector)</h1><p>è¿‡æ»¤ä¹Ÿæœ‰è¿‡æ¸¡ï¼Œè¿™ç‚¹å¯èƒ½å¾ˆå¤šäººéƒ½å¿½ç•¥äº†ï¼Œæ¯”å¦‚è®¾ç½®åŠ¨ç”»ç»“æŸæ—¶ï¼Œç´¢å¼•ä¸ºå¥‡æ•°çš„å…ƒç´ æ—‹è½¬30åº¦ã€‚ç”šè‡³å¯ä»¥è‡ªå·±å®šä¹‰è§„åˆ™ï¼Œå¦‚ç¬¬5ã€10ã€15ä¸ªå…ƒç´ æ”¹å˜ï¼Œå…¶ä»–çš„ä¸å˜ã€‚</p><h1 id="d3-interpolate-a-b"><a href="#d3-interpolate-a-b" class="headerlink" title="d3.interpolate(a,b)"></a>d3.interpolate(a,b)</h1><p>è¿”å›ä¸€ä¸ªä»‹äºa,bä¹‹é—´çš„é»˜è®¤æ’å€¼å™¨ï¼Œæ’å€¼å™¨çš„ç±»å‹å–å†³äºbçš„ç±»å‹ã€‚<br>1ï¼‰å¦‚æœbæ˜¯é¢œè‰²ç±»å‹ï¼Œé‚£ä¹ˆè¿”å›çš„æ˜¯interpolateRgbæ’å€¼å™¨<br>2ï¼‰å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œåˆ™è¿”å›interpolateStringæ’å€¼å™¨<br>3ï¼‰å¦‚æœæ˜¯æ•°ç»„ç±»å‹ï¼Œåˆ™è¿”å›interpolateArrayæ’å€¼å™¨<br>4ï¼‰å¦‚æœæ˜¯å¯¹è±¡ç±»å‹ï¼Œä¸”ä¸èƒ½å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²ç±»å‹ï¼Œåˆ™è¿”å›interpolateObjectæ’å€¼å™¨<br>5ï¼‰å¦åˆ™ï¼Œè¿”å›interpolateNumberæ’å€¼å™¨</p><h1 id="æ•°ç»„ç›¸å…³API"><a href="#æ•°ç»„ç›¸å…³API" class="headerlink" title="æ•°ç»„ç›¸å…³API"></a>æ•°ç»„ç›¸å…³API</h1><p>ä½¿ç”¨d3æ—¶ï¼Œä¼šæœ‰å¤§é‡çš„æ•°ç»„æ“ä½œï¼Œå¦‚æœèƒ½åˆç†è¿ç”¨d3æä¾›çš„æ•°ç»„ç›¸å…³çš„å‡½æ•°ï¼Œå°†ä¼šä½¿å¾—å·¥ä½œæ•ˆç‡å¤§å¤§æé«˜ã€‚</p><h2 id="d3-ascending-a-b"><a href="#d3-ascending-a-b" class="headerlink" title="d3.ascending(a,b)"></a>d3.ascending(a,b)</h2><p>å¦‚æœa\<b,è¿”å›-1ï¼Œa\>bï¼Œè¿”å›1ï¼Œå¦‚æœa=b,è¿”å›0.<br>åœ¨å¯è§†åŒ–å…ƒç´ éœ€è¦æœ‰åºçš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å¾ˆæœ‰ç”¨ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬æ’å¥½åºã€‚</b,è¿”å›-1ï¼Œa\></p><h2 id="d3-min-d3-max-d3-extent"><a href="#d3-min-d3-max-d3-extent" class="headerlink" title="d3.min(),d3.max(),d3.extent()"></a>d3.min(),d3.max(),d3.extent()</h2><p>å‰ä¸¤ä¸ªå‡½æ•°çŸ¥é“çš„äººåº”è¯¥ä¸å°‘ï¼Œä½†æ˜¯æœ€åä¸€ä¸ªå´ç›¸å¯¹å†·é—¨ï¼Œå®ƒå¯ä»¥ç›´æ¥è¿”å›æ•°ç»„è‡ªç„¶æ’åºçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼Œçœçš„åŒæ—¶è°ƒç”¨å‰é¢ä¸¤ä¸ªå‡½æ•°äº†ã€‚</p><h2 id="d3-sum-d3-mean-d3-median-d3-quantile"><a href="#d3-sum-d3-mean-d3-median-d3-quantile" class="headerlink" title="d3.sum(),d3.mean(),d3.median(),d3.quantile()"></a>d3.sum(),d3.mean(),d3.median(),d3.quantile()</h2><p>åŸºæœ¬çš„æ±‚å’Œã€å¹³å‡æ•°ã€ä¸­ä½æ•°ã€påˆ†ä½æ•°ï¼Œéƒ½å¸®ä½ å®ç°å¥½äº†ï¼Œä¹‹å‰è¿˜å‚»ä¹ä¹çš„è‡ªå·±å»å®ç°äº†ï¼Œè™½ç„¶ä¸éš¾ï¼Œä½†æ˜¯ä»£ç ä¼šå¾ˆéš¾çœ‹ã€‚</p><h2 id="d3-shuffle-array"><a href="#d3-shuffle-array" class="headerlink" title="d3.shuffle(array)"></a>d3.shuffle(array)</h2><p>ç”¨Fisher-Yates shuffleç®—æ³•æŠŠä¼ å…¥çš„æ•°ç»„éšæœºæ’åºã€‚è¿™æ ·æƒ³å¾—åˆ°ä¹±åºçš„æ—¶å€™ä¼šä¸ä¼šæ¯”è¾ƒé«˜å¤§ä¸Šå‘¢ï¼Ÿå˜¿å˜¿ã€‚</p><h2 id="d3-keys-object-d3-values-object"><a href="#d3-keys-object-d3-values-object" class="headerlink" title="d3.keys(object),d3.values(object)"></a>d3.keys(object),d3.values(object)</h2><p>keysè¿”å›ä¸€ä¸ªåŒ…å«æŒ‡å®šå¯¹è±¡(å…³è”æ•°ç»„)ä¸­æ‰€æœ‰å±æ€§åç§°çš„æ•°ç»„ã€‚è¿™ç‚¹å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚ç”¨d3.csv()è¯»æ–‡ä»¶çš„æ—¶å€™ï¼Œæƒ³è¦æ»¤æ‰ä¸€äº›æ— å…³çš„dimensionï¼Œæ¯”å¦‚idç­‰ç­‰ï¼Œç”¨è¿™ä¸ªå‡½æ•°å°±å¾ˆæœ‰ç”¨ã€‚</p><h2 id="d3-map-d3-set"><a href="#d3-map-d3-set" class="headerlink" title="d3.map(),d3.set()"></a>d3.map(),d3.set()</h2><p>æ˜ å°„ä¸é›†åˆæ˜¯å¾ˆå¸¸è§çš„æ•°æ®ç»“æ„ï¼Œä½†æ˜¯ä¸æ˜¯æ‰€æœ‰jsç‰ˆæœ¬ä¸­éƒ½æœ‰é»˜è®¤çš„å®ç°çš„ï¼Œä½†æ˜¯d3æä¾›äº†ã€‚æ˜¨å¤©åœ¨åšé¡¹ç›®çš„æ—¶å€™å°±é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œæœ€åæ˜¯å€Ÿç”¨äº†d3æä¾›çš„mapä¸setè§£å†³äº†ã€‚</p><h2 id="d3-mergeï¼ˆarraysï¼‰"><a href="#d3-mergeï¼ˆarraysï¼‰" class="headerlink" title="d3.mergeï¼ˆarraysï¼‰"></a>d3.mergeï¼ˆarraysï¼‰</h2><p>åˆå¹¶æŒ‡å®šå‚æ•°arraysä¸ºä¸€ä¸ªæ•°ç»„ï¼Œä¸å†…ç½®çš„concatç±»ä¼¼ï¼Œä¸è¿‡å¤„ç†äºŒç»´æ•°ç»„çš„æ—¶å€™ï¼Œå®ƒä¼šæ›´æ–¹ä¾¿ã€‚</p><h2 id="d3-zip-arrays-ï¼Œd3-pairs-arrays"><a href="#d3-zip-arrays-ï¼Œd3-pairs-arrays" class="headerlink" title="d3.zip(arrays)ï¼Œd3.pairs(arrays)"></a>d3.zip(arrays)ï¼Œd3.pairs(arrays)</h2><p>d3.zip(ã€1ï¼Œ2ã€‘ï¼Œã€3ï¼Œ4ï¼Œ5ã€‘)è¿”å›ã€ã€1ï¼Œ3ã€‘ï¼Œã€2ï¼Œ4ã€‘ã€‘æœ‰å•¥ç”¨è‡ªå·±ä½“ä¼šã€‚<br>d3.pairs(ã€1ï¼Œ2ï¼Œ3ï¼Œ4ã€‘)è¿”å›ã€ã€1ï¼Œ2ã€‘ï¼Œã€2ï¼Œ3ã€‘ï¼Œã€3ï¼Œ4ã€‘ã€‘</p><h2 id="d3-transpose-matrix"><a href="#d3-transpose-matrix" class="headerlink" title="d3.transpose(matrix)"></a>d3.transpose(matrix)</h2><p>è½¬ç½®äºŒç»´çŸ©é˜µç”¨çš„ã€‚</p><h1 id="brush"><a href="#brush" class="headerlink" title="brush"></a>brush</h1><p>ä½œä¸ºä¸€ä¸ªå¯è§†åŒ–ç³»ç»Ÿï¼Œæ€ä¹ˆèƒ½æ²¡æœ‰brushï¼å®ç°brushçš„åŠŸèƒ½éå¸¸ç®€å•ï¼Œæ„é€ åˆ·å­ä¹‹å‰ï¼Œéœ€è¦åˆ¶å®šx/yæ¯”ä¾‹å°ºå’Œç©ºçš„èŒƒå›´ã€‚ç»˜åˆ¶çš„åˆ·å­å¯ä»¥é‡æ–°è°ƒæ•´å¤§å°å’Œä½ç½®ã€‚<br>å…³äºbrushçš„ä½¿ç”¨ï¼Œè¯·çœ‹å‰é¢çš„åšå®¢ï¼ˆassociate brushï¼‰ã€‚</p><h1 id="æ—¶é—´çš„è®¡æ•°"><a href="#æ—¶é—´çš„è®¡æ•°" class="headerlink" title="æ—¶é—´çš„è®¡æ•°"></a>æ—¶é—´çš„è®¡æ•°</h1><p>d3.time.dayOfYear(date) è¿”å›å‚æ•°dateæ˜¯ä¸€å¹´é‡Œçš„ç¬¬å‡ å¤©ï¼Œ1æœˆ1æ—¥æ˜¯ç¬¬0å¤©ã€‚<br>weekOfYearâ€¦.ç­‰ç­‰å‡½æ•°ä¹Ÿæ˜¯æœ‰çš„ï¼Œéœ€è¦ç”¨çš„æ—¶å€™å¯ä»¥æŸ¥æŸ¥APIï¼Œçœçš„å†™é—°å¹´çš„åˆ¤æ–­ï¼Œå˜¿å˜¿ã€‚</p><h1 id="å¸ƒå±€"><a href="#å¸ƒå±€" class="headerlink" title="å¸ƒå±€"></a>å¸ƒå±€</h1><p>Stack(layersã€,indexã€‘),è®©æˆ‘è®°å¿†æœ€æ·±ï¼Œä¹‹å‰åšä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œå°±ä¸çŸ¥é“æœ‰è¿™ä¸œè¥¿å­˜åœ¨ï¼Œæ„£æ˜¯è‡ªå·±å®ç°äº†ä¸€éï¼Œéº»çƒ¦ä¸è¯´,å¯¹ä¸å¯¹å¯èƒ½è¿˜ä¸€å®š.</p><h1 id="åœ°ç†"><a href="#åœ°ç†" class="headerlink" title="åœ°ç†"></a>åœ°ç†</h1><p>åœ°ç†çš„APIè¿™å—æˆ‘å¾ˆé™Œç”Ÿ,æ²¡æœ‰ä»€ä¹ˆæœºä¼šåšè¿™æ–¹é¢çš„é¡¹ç›®,æ‰€ä»¥ç”¨çš„å¾ˆå°‘,åé¢æœ‰æœºä¼šå†æ¥è¡¥å…….</p><h1 id="å‡ ä½•"><a href="#å‡ ä½•" class="headerlink" title="å‡ ä½•"></a>å‡ ä½•</h1><p>åŒæ ·é™Œç”Ÿçš„è¿˜æœ‰å‡ ä½•è¿™éƒ¨åˆ†çš„å†…å®¹,æ¯”å¦‚å››å‰æ ‘/å‡¸åŒ…/å¤šè¾¹å½¢/æ³°æ£®å¤šè¾¹å½¢,è®°ä½è¿™éƒ¨åˆ†æœ‰å°±å¯ä»¥äº†,åé¢ç”¨è¿‡ä¹‹åå†æ¥è¡¥å…….</p><h1 id="è¡Œä¸º"><a href="#è¡Œä¸º" class="headerlink" title="è¡Œä¸º"></a>è¡Œä¸º</h1><p>ç”±zoomå’Œdragä¸¤éƒ¨åˆ†ç»„æˆï¼Œå¾ˆé‡è¦å´å¾ˆç®€å•çš„å†…å®¹ï¼Œå¸Œæœ›å¥½å¥½æŒæ¡ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;åœ¨d3.jsçš„APIæ–‡æ¡£ä¸­ï¼Œæä¾›äº†å¾ˆå¤šå†…ç½®çš„å‡½æ•°ï¼Œä½†æ˜¯æœ‰äº›å¾ˆæœ‰ç”¨çš„å†…ç½®å‡½æ•°å´è¢«æ— æƒ…çš„å¿½ç•¥äº†ï¼Œè¿™ç¯‡åšå®¢å°±æ¥æ•´ç†æ•´ç†è¿™äº›è¢«é—å¿˜å´å¾ˆå®ç”¨çš„å‡½æ•°ã€‚å¸Œ
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>æµ…è°ˆd3.jsä¸­å¼ºåˆ¶å¼‚æ­¥æ–‡ä»¶è¯»å–åŒæ­¥çš„å››ç§æ–¹æ³•</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/%E6%B5%85%E8%B0%88d3.js%E4%B8%AD%E7%9A%84%E5%BC%82%E6%AD%A5%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E7%9A%84%E5%A4%84%E7%90%86/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/æµ…è°ˆd3.jsä¸­çš„å¼‚æ­¥æ–‡ä»¶è¯»å–çš„å¤„ç†/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-24T04:14:19.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="é—®é¢˜æå‡º"><a href="#é—®é¢˜æå‡º" class="headerlink" title="é—®é¢˜æå‡º"></a>é—®é¢˜æå‡º</h1><p>åœ¨ä½¿ç”¨d3.jsæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨d3.csv()æˆ–è€…d3.json()å‡½æ•°æ¥ä»æ–‡ä»¶ä¸­è¯»å–å‡ºæ•°æ®ï¼Œä¸å¹¸çš„æ˜¯ï¼Œå¶å°”ä»£ç çš„ç»“æœå¹¶ä¸æ˜¯æˆ‘ä»¬é¢„æ–™çš„é‚£æ ·ã€‚ä¹ æƒ¯äº†è¿‡ç¨‹å¼ç¼–ç¨‹çš„æˆ‘å¼€å§‹çš„æ—¶å€™ä¹Ÿæ˜¯è¿™æ ·ï¼Œæœ€è®©äººå¤´ç–¼çš„æ˜¯javascriptå¹¶ä¸ä¼šå‘Šè¯‰ä½ é—®é¢˜å‡ºåœ¨å“ªé‡Œäº†ã€‚æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œæ‰¾äº†åŠå¤©bugï¼Œç¡®å®šä»£ç ä¸»ä½“éƒ¨åˆ†æ²¡æœ‰é—®é¢˜ä¹‹åï¼Œæˆ‘åªèƒ½å¼€å§‹ä½¿ç”¨console.log()å°†å˜é‡ä¸€ä¸ªä¸€ä¸ªçš„è¾“å‡ºåˆ°æ§åˆ¶å°é‡Œã€‚<br>ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªé—®é¢˜æ—¶çš„å›¾ç‰‡æ˜¯è¿™æ ·çš„ï¼š<br><img src="http://i13.tietuku.cn/b620500d4f1d6bb2.jpg" alt=""><br>é—®é¢˜å‡ºåœ¨ç¬¬72è¡Œå’Œç¬¬75è¡Œï¼Œä¸­é—´å‡ è¡Œå®Œå…¨æ²¡æœ‰å¯¹ordertxtè¿›è¡Œæ“ä½œï¼Œä½†æ˜¯æœ€åçš„ç»“æœå°±æ˜¯å’Œé¢„æƒ³çš„è¾“å‡ºä¸å»åˆï¼Œåæ¥æ‰¾äº†ä¸ªå…¶ä»–æ–¹æ³•æŠŠè¿™ä¸ªé—®é¢˜ç»™è§£å†³äº†ï¼Œä»Šå¤©åˆé‡åˆ°äº†ç±»ä¼¼çš„è¿™ä¸ªé—®é¢˜ï¼Œå°±ä¸‹å†³å¿ƒæ¥æ‹”æ‰è¿™æ ¹åˆºã€‚</p><h1 id="è¯•éªŒ"><a href="#è¯•éªŒ" class="headerlink" title="è¯•éªŒ"></a>è¯•éªŒ</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;script\&gt;</div><div class="line"></div><div class="line">console.log(&quot;before csv1 &quot;);</div><div class="line">d3.csv(&quot;flowers.csv&quot;, function(data) &#123;console.log(data)&#125;);</div><div class="line">console.log(&quot;before csv2&quot;);</div><div class="line">d3.csv(&quot;flowers.csv&quot;,function(error,data2) &#123;console.log(error, data2)&#125;);</div><div class="line"></div><div class="line">\&lt;/script\&gt;</div><div class="line"></div></pre></td></tr></table></figure><p>believe it or not,ä¸Šé¢çš„ä»£ç å°†äº§ç”Ÿä¸‹é¢å›¾ä¸­çš„è¾“å‡ºç»“æœï¼Œå› ä¸ºjavascriptçš„<strong>å¼‚æ­¥ç‰¹æ€§</strong>ã€‚è¯´åˆ°å¼‚æ­¥ï¼Œå¤§éƒ¨åˆ†æ—¶å€™æ˜¯è®©äººå¼€å¿ƒçš„ï¼Œä½†å¶å°”ä¹Ÿä¼šä»¤äººå¤´ç–¼ï¼Œè‡³å°‘åœ¨è¿™é‡Œï¼Œå°±æ˜¯ä»¤äººå¤´ç–¼ã€‚</p><p><img src="http://i12.tietuku.cn/1b8435a64150532d.jpg" alt=""></p><h1 id="è§£å†³æ–¹æ³•1"><a href="#è§£å†³æ–¹æ³•1" class="headerlink" title="è§£å†³æ–¹æ³•1"></a>è§£å†³æ–¹æ³•1</h1><p>ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘å·§å¦™çš„ç»•å¼€äº†è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨çš„æ–¹æ³•æ˜¯ï¼šæˆ‘æŠŠæ•°æ®çš„å¤„ç†æ”¾åœ¨äº†d3.csv(â€œflowers.csvâ€,function(data){dealWithData()â€¦})å›è°ƒå‡½æ•°é‡Œé¢ï¼Œè¿™æ ·æ•°æ®çš„å¤„ç†å°±å’Œd3çš„è¯»æ–‡ä»¶æ“ä½œå˜æˆäº†ç»‘åœ¨ä¸€æ ¹ç»³ä¸Šçš„èš‚èš±äº†ï¼Œè¦ä¹ˆä¸€èµ·æ‰§è¡Œå®Œï¼Œè¦ä¹ˆéƒ½ä¸æ‰§è¡Œã€‚<br>è²Œä¼¼ä¸–ç•Œå’Œå¹³äº†ï¼Œä½†æ˜¯ä»Šå¤©ä¸‹åˆåˆé‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œè€Œä¸”æ•°æ®çš„å˜åŒ–æ˜¯éšæ—¶éšåœ°çš„ï¼Œå¯ä¸æ˜¯å’Œä¸Šä¸€æ¬¡é‡åˆ°çš„é‚£æ ·ï¼Œæ‰€æœ‰ä¼šå‘ç”Ÿçš„å˜åŒ–éƒ½å¯ä»¥é¢„å…ˆå†™æˆä»£ç çš„ã€‚äºæ˜¯æˆ‘å¼€å§‹äº†å¯¹è§£å†³æ–¹æ³•çš„è‹¦è‹¦è¿½å¯»ã€‚</p><h1 id="è§£å†³æ–¹æ³•2"><a href="#è§£å†³æ–¹æ³•2" class="headerlink" title="è§£å†³æ–¹æ³•2"></a>è§£å†³æ–¹æ³•2</h1><p>ç¬¬äºŒç§æ–¹æ³•æ˜¯å€ŸåŠ©ä¸€äº›helperç±»åº“(queue.js)æ¥å¼ºåˆ¶æ•°æ®åœ¨åŠ è½½å®Œæˆä¹‹åæ‰å»è§¦å‘ç›¸åº”çš„æ“ä½œã€‚è¿™ç§æ–¹æ³•æ˜¯æˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°çš„ï¼Œå¹¶æ²¡æœ‰å»äº²è‡ªè¯•è¿‡ï¼Œä¹Ÿè®¸ä¼šæˆåŠŸï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬ä¼šå˜åŒ–çš„æ•°æ®ï¼Œä¸èƒ½æå‰å°†å¤„ç†é€»è¾‘å†™å‡ºä»£ç ï¼Œè¿™ç§æ–¹æ³•è¿˜æ˜¯ä¸åˆæ ¼çš„ã€‚</p><h1 id="è§£å†³æ–¹æ³•3"><a href="#è§£å†³æ–¹æ³•3" class="headerlink" title="è§£å†³æ–¹æ³•3"></a>è§£å†³æ–¹æ³•3</h1><p>ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯åœ¨stack overflowé‡ŒæŸ¥åˆ°çš„ï¼Œè¯•äº†ä¸€ä¸‹æ˜¯å¯ä»¥çš„ï¼Œä»–è¿™é‡Œç”¨çš„æ˜¯d3.text()å‡½æ•°ï¼Œå°†æ–‡ä»¶å…ˆloadè¿›æ¥ï¼Œç„¶åå†ä½¿ç”¨d3.csv.parseæˆ–è€…d3.csv.parseRowsï¼Œè¿™æ ·å°±ä¼šæ˜¯åŒæ­¥çš„äº†ã€‚å‚è€ƒæ–‡æœ«çš„Reference 3çš„å®ç°ã€‚</p><h1 id="è§£å†³æ–¹æ³•4"><a href="#è§£å†³æ–¹æ³•4" class="headerlink" title="è§£å†³æ–¹æ³•4"></a>è§£å†³æ–¹æ³•4</h1><p>æ–¹æ³•4æ˜¯æˆ‘è‡ªå·±æƒ³å‡ºæ¥çš„ï¼Œæœ€è¿‘å‡ å¤©ä¸€ç›´åœ¨åšangularå’Œd3ç»“åˆåœ¨ä¸€èµ·çš„å·¥ä½œï¼Œæˆ‘å°±åœ¨æƒ³èƒ½å¦å€ŸåŠ©angularæ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆå‘¢ï¼Ÿä¸‡å¹¸ï¼ŒAngularä¸­ç¡®å®æœ‰è¿™ä¹ˆä¸€ä¸ªå‡½æ•°ï¼Œä¼¼ä¹å°±æ˜¯ä¸ºè¿™ä¸ªé—®é¢˜é‡èº«å®šåšçš„ï¼Œä¸”è§£å†³äº†å‰é¢çš„æ–¹æ³•éƒ½æ²¡æœ‰è§£å†³çš„æ•°æ®åæœŸåŠ¨æ€å˜åŒ–çš„é—®é¢˜ã€‚è¿™ä¸ªå‡½æ•°å°±æ˜¯<strong>$watch</strong>å‡½æ•°ã€‚</p><h2 id="watchåˆ—è¡¨"><a href="#watchåˆ—è¡¨" class="headerlink" title="$watchåˆ—è¡¨"></a>$watchåˆ—è¡¨</h2><p>æ¯å½“æˆ‘ä»¬åœ¨è§†å›¾ä¸­è¿½è¸ªä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œä¼šç»™å®ƒæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç„¶åå¸Œæœ›åœ¨é¡µé¢ä¸­è§¦å‘è¯¥äº‹ä»¶æ—¶è°ƒç”¨è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚æ¯”å¦‚AngularJSä¸­æœ€ä»¤äººå°è±¡æ·±åˆ»çš„åŒå‘ç»‘å®šï¼Œåœ¨inputä¸­è¾“å…¥ä¸€ä¸ªå­—æ¯ï¼Œæœ‰ç€ç›¸åŒng-modelçš„å˜é‡å°±ä¼šè·Ÿç€inputçš„è¾“å…¥è€Œå‘ç”Ÿæ”¹å˜ã€‚<br>å‘ç”Ÿè¿™ä¸€å˜åŒ–çš„åŸå› æ˜¯æˆ‘ä»¬æŠŠUIä¸­çš„è¾“å…¥å­—æ®µç»‘å®šç»™äº†$scope.nameå±æ€§ï¼Œä¸ºäº†æ›´æ–°è¿™ä¸ªè§†å›¾ï¼ŒAngularéœ€è¦<strong>è¿½è¸ªå˜åŒ–</strong>ï¼Œæ˜¯é€šè¿‡ç»™$watchåˆ—è¡¨æ·»åŠ ä¸€ä¸ªç›‘æ§å‡½æ•°åšåˆ°è¿™ä¸€ç‚¹çš„ã€‚</p><h2 id="è„æ£€æŸ¥"><a href="#è„æ£€æŸ¥" class="headerlink" title="è„æ£€æŸ¥"></a>è„æ£€æŸ¥</h2><p>è„æ£€æŸ¥æ˜¯ä¸€ä¸ªç®€å•çš„è¿‡ç¨‹ï¼Œå¯å½’ç»“ä¸ºä¸€ä¸ªéå¸¸åŸºç¡€çš„æ¦‚å¿µï¼šæ£€æŸ¥å€¼æ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œè€Œæ•´ä¸ªåº”ç”¨è¿˜æ²¡åŒæ­¥è¯¥å˜åŒ–ã€‚<br>Angularä¼šéå†$watchåˆ—è¡¨ï¼Œåªè¦æœ‰ä»»ä½•çš„å€¼å‘ç”Ÿæ¯”å˜åŒ–ï¼Œåº”ç”¨å°†ä¼šé€€å›åˆ°$watchå¾ªç¯ä¸­ï¼Œç›´åˆ°æ£€æµ‹åˆ°ä¸åœ¨å‘ç”Ÿä»»ä½•å˜åŒ–ã€‚</p><h2 id="watch"><a href="#watch" class="headerlink" title="$watch"></a>$watch</h2><p>$scopeå¯¹è±¡ä¸Šçš„$watchæ–¹æ³•ä¼šç»™Angularäº‹ä»¶å¾ªç¯å†…çš„æ¯ä¸ª$digestè°ƒç”¨è£…é…ä¸€ä¸ªè„æ£€æŸ¥ï¼Œå¦‚æœåœ¨æ£€æµ‹åˆ°å˜åŒ–ï¼ŒAngularæ€»æ˜¯ä¼šè¿”å›$digestå¾ªç¯ã€‚<br>$watchå‡½æ•°æœ¬èº«æ¥å—ä¸¤ä¸ªå¿…è¦å‚æ•°å’Œä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯watchçš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯<strong>å›è°ƒå‡½æ•°</strong>ï¼Œä¸€æ—¦watchçš„å¯¹è±¡å˜äº†çš„æ—¶å€™è§¦å‘ï¼›å¯é€‰çš„å‚æ•°æ˜¯ä¸€ä¸ªboolå€¼ï¼Œå‘Šè¯‰Angularæ˜¯å¦æ£€æŸ¥<strong>ä¸¥æ ¼ç›¸ç­‰</strong>ã€‚<br>å…³äºå›è°ƒå‡½æ•°å’Œä¸¥æ ¼ç›¸ç­‰ï¼Œè¿˜æœ‰ä¸€äº›æƒ³è¯´çš„ã€‚</p><h3 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h3><p>æˆ‘ä¸€ç›´æ˜¯è¿™ä¹ˆç†è§£å›è°ƒå‡½æ•°çš„ï¼Œç ”ç©¶ç”Ÿçš„å¯¼å¸ˆä¼šåˆ†é…ç»™æ¯ä¸ªç ”ç©¶ç”Ÿæ´»å»å¹²ï¼Œè€Œä»–è‡ªå·±ä¹Ÿæœ‰è‡ªå·±çš„äº‹æƒ…ï¼Œå¦‚æœç»™æŸä¸ªç ”ç©¶ç”Ÿå®‰æ’çš„æ´»ä»–åšå¥½äº†ï¼Œå°±è¿‡æ¥ç»™ä»–è¯´ä¸€å£°ï¼Œå¯¼å¸ˆè´Ÿè´£æ±‡æ€»ï¼Œå°†æ´»å†™æˆè®ºæ–‡å‘è¡¨å‡ºå»ã€‚è¿™å…¶å®å°±æ˜¯å›è°ƒå‡½æ•°å·¥ä½œçš„åŸç†ã€‚<br>å½“ç„¶å¯¼å¸ˆä¸å¯èƒ½åœ¨è¿™è¾¹ç­‰ç€ç ”ç©¶ç”Ÿå¹²æ´»ï¼Œè‡ªå·±ä»€ä¹ˆéƒ½ä¸å¹²ï¼›æˆ–è€…è‡ªå·±ä»€ä¹ˆéƒ½å¹²äº†ï¼Œä¹Ÿæ²¡ç ”ç©¶ç”Ÿä»€ä¹ˆäº‹äº†ã€‚</p><h3 id="ä¸¥æ ¼ç›¸ç­‰"><a href="#ä¸¥æ ¼ç›¸ç­‰" class="headerlink" title="ä¸¥æ ¼ç›¸ç­‰"></a>ä¸¥æ ¼ç›¸ç­‰</h3><p>æ¯”å¦‚æœ‰ä¸€ä¸ªæ•°ç»„ï¼Œa=ã€1ï¼Œ2ï¼Œ3ã€‘ï¼Œåé¢ä¿®æ”¹äº†aã€0ã€‘=2,åœ¨AngularJSçœ‹æ¥ï¼Œè¿™ä¸ªæ•°ç»„å¹¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºè¿˜æ˜¯3ä¸ªå˜é‡ï¼Œè€Œå¦‚æœä»ä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è¯´ï¼Œå®ƒå·²ç»å‘ç”Ÿäº†å˜åŒ–ï¼Œè¿™å°±æ˜¯ä¸¥æ ¼ç›¸ç­‰å’Œç›¸ç­‰çš„ä¸åŒï¼Œåœ¨javascriptä¸­ï¼Œä¹Ÿæœ‰==å’Œ===çš„åŒºåˆ«ã€‚</p><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>å†™åˆ°è¿™é‡Œï¼Œå¤§å®¶åº”è¯¥çŸ¥é“è¯¥æ€ä¹ˆåšäº†ï¼Œå³è°ƒç”¨$watchå‡½æ•°æ¥è§‚æµ‹æˆ‘ä»¬éœ€è¦å…³æ³¨çš„dataï¼Œæ¯å½“å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå°±æ ¹æ®æ–°çš„dataï¼Œé‡æ–°ç»˜åˆ¶å›¾æ ‡ã€‚å› æ­¤ï¼Œæˆ‘ä»¬æœ€å¥½å°†renderçš„è¿‡ç¨‹æŠ½è±¡æˆä¸€ä¸ªå‡½æ•°ï¼Œæ–¹ä¾¿æˆ‘ä»¬åæœŸè°ƒç”¨ã€‚<br>æ¯”å¦‚ï¼Œæˆ‘ä»¬æƒ³è¦è§‚æµ‹dataæ•°ç»„çš„å˜åŒ–ï¼Œå¹¶ä¸”æ ¹æ®å®ƒçš„å˜åŒ–æ¥é‡æ–°ç»˜åˆ¶å›¾ç‰‡ã€‚é‚£ä¹ˆæˆ‘ä»¬çš„ä»£ç å®ç°å°±åº”è¯¥åƒä¸‹é¢è¿™æ ·ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"> scope.$watch(&quot;data&quot;, function() &#123;</div><div class="line">render();</div><div class="line">//renderå‡½æ•°æ˜¯ç»˜åˆ¶çš„è¿‡ç¨‹ï¼Œæ¢æˆè‡ªå·±çš„å³å¯ã€‚</div><div class="line">&#125;,true);</div><div class="line"></div></pre></td></tr></table></figure></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>D3.jsåŠ è½½csvå’Œjsonæ•°æ® <a href="http://www.bubuko.com/infodetail-942138.html" target="_blank" rel="external">http://www.bubuko.com/infodetail-942138.html</a></li><li>d3: make the d3.csv function syncronous <a href="http://stackoverflow.com/questions/19899005/d3-make-the-d3-csv-function-syncronous" target="_blank" rel="external">http://stackoverflow.com/questions/19899005/d3-make-the-d3-csv-function-syncronous</a></li><li>read csv/tsv with no header line in D3 <a href="http://stackoverflow.com/questions/13870265/read-csv-tsv-with-no-header-line-in-d3" target="_blank" rel="external">http://stackoverflow.com/questions/13870265/read-csv-tsv-with-no-header-line-in-d3</a></li><li>ã€ŠAngularJSæƒå¨æ•™ç¨‹ã€‹</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;é—®é¢˜æå‡º&quot;&gt;&lt;a href=&quot;#é—®é¢˜æå‡º&quot; class=&quot;headerlink&quot; title=&quot;é—®é¢˜æå‡º&quot;&gt;&lt;/a&gt;é—®é¢˜æå‡º&lt;/h1&gt;&lt;p&gt;åœ¨ä½¿ç”¨d3.jsæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨d3.csv()æˆ–è€…d3.json()å‡½æ•°æ¥ä»æ–‡ä»¶ä¸­è¯»å–å‡ºæ•°æ®ï¼Œä¸å¹¸çš„æ˜¯ï¼Œå¶å°”ä»£ç çš„ç»“æœå¹¶
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>Build reusable visualization using d3.js and AngularJS</title>
    <link href="http://zhihaozhang.github.io/2014/11/15/Build%20reuseable%20visualization%20using%20d3.js%20and%20AngularJS/"/>
    <id>http://zhihaozhang.github.io/2014/11/15/Build reuseable visualization using d3.js and AngularJS/</id>
    <published>2014-11-15T05:54:57.000Z</published>
    <updated>2017-09-24T04:15:14.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>å‰é¢ä¸¤ç¯‡åšå®¢ä»‹ç»äº†å¦‚ä½•å€ŸåŠ©angularï¼Œè®©æˆ‘ä»¬çš„å¯è§†åŒ–å›¾èƒ½å¤Ÿæ›´æœ‰<strong>æ¨¡å—åŒ–</strong>ã€<strong>æ–¹ä¾¿å¤ç”¨</strong>ã€<strong>å…·æœ‰äº¤äº’æ€§</strong>ï¼Œä¸è¿‡å‰é¢çš„åšå®¢åªä»‹ç»äº†åŸºæœ¬çš„åŸç†ä»¥åŠæœ€ç®€å•çš„å›¾ï¼Œåœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬æ¥ä¸€èµ·ç»˜åˆ¶ä¸€ä¸ªç›¸å¯¹å¤æ‚ä¸€äº›çš„çƒ­åŠ›å›¾ï¼Œæœ€ç»ˆçš„æ•ˆæœå¦‚ä¸‹å›¾ã€‚<br><img src="http://i13.tietuku.cn/5b566b315d0593c2.jpg" alt=""><br>è¿™ä¸ªçƒ­åŠ›å›¾ä¸»è¦æ˜¯ç”¨æ¥å±•ç°ç»´åº¦ä¸ç»´åº¦ä¹‹é—´çš„ç›¸å…³æ€§çš„ï¼Œè€Œç›¸å…³æ€§åœ¨0-1ä¹‹é—´ã€‚åƒä¸‡ä¸è¦å°çœ‹è¿™ä¸ªçƒ­åŠ›å›¾ï¼Œå›¾ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œç”šè‡³æ¯ä¸€ä¸ªå­—éƒ½æ˜¯ç»˜åˆ¶å‡ºæ¥çš„ï¼Œå®Œæˆè¿™ä¸ªçœ‹ä¼¼ç®€å•çš„çƒ­åŠ›å›¾å¤§æ¦‚éœ€è¦<strong>350è¡Œä»£ç </strong>ã€‚</p><h1 id="å…·ä½“å®ç°"><a href="#å…·ä½“å®ç°" class="headerlink" title="å…·ä½“å®ç°"></a>å…·ä½“å®ç°</h1><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><p>æˆ‘ä»¬æƒ³è¦ç”¨çƒ­åŠ›å›¾çš„æ—¶å€™å‘¢ï¼Œå¸Œæœ›èƒ½åƒå†…ç½®çš„html DOMå…ƒç´ ä¸€æ ·ä½¿ç”¨ï¼Œæ¯”å¦‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">\&lt;heatmap\&gt;\&lt;/heatmap\&gt;</div><div class="line"></div><div class="line">//å¦‚æœæˆ‘ä»¬èƒ½æŒ‡å®šä¸€äº›å±æ€§å°±æ›´å¥½äº†ï¼Œæ¯”å¦‚ä¸‹é¢ã€‚</div><div class="line"></div><div class="line">\&lt;heatmap class=&quot;chart&quot; data=&quot;data&quot; dispatch=&quot;dispatch&quot; options=&quot;options&quot;\&gt;\&lt;/heatmap\&gt;</div></pre></td></tr></table></figure><br>ä¸è¦ç€æ€¥æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥å®Œæˆã€‚</p><h2 id="create-directive-using-Angular"><a href="#create-directive-using-Angular" class="headerlink" title="create directive using Angular"></a>create directive using Angular</h2><p>å‰é¢çš„åšå®¢é‡Œå·²ç»ä»‹ç»è¿‡äº†å¦‚ä½•ä½¿ç”¨Angularæ¥æ„é€ æŒ‡ä»¤äº†ï¼Œä¸»è¦æ˜¯å€ŸåŠ©angular.directive(â€˜heatmapâ€™,function(){â€¦})æ¥å®Œæˆçš„ï¼Œä¸»ä½“æ¡†æ¶å¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">angular.module(&quot;heatmap&quot;, []()).directive(&quot;heatmap&quot;,</div><div class="line">function() &#123;</div><div class="line">return &#123;</div><div class="line">restrict: &quot;E&quot;,</div><div class="line">replace: true,</div><div class="line">scope: &#123;</div><div class="line">data: &quot;=&quot;,</div><div class="line">options: &quot;=?&quot;,</div><div class="line">dispatch: &quot;=?&quot;</div><div class="line">&#125;,</div><div class="line">transclude: false,</div><div class="line">template: &quot;\&lt;div\&gt;\&lt;/div\&gt;&quot;,</div><div class="line">link: function(scope, element) &#123;</div><div class="line">â€¦</div><div class="line">//æš‚æ—¶å…ˆä¸è´´å‡ºæ¥ï¼Œåé¢è¯¦è§£ã€‚</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;ï¼‰</div><div class="line"></div></pre></td></tr></table></figure></p><h2 id="link-function"><a href="#link-function" class="headerlink" title="link function"></a>link function</h2><p>å‰é¢å·²ç»æè¿‡äº†ï¼Œlink functionç±»ä¼¼äºé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„æ„é€ (constructor)å‡½æ•°,åœ¨ä¸ªå‡½æ•°é‡Œï¼Œæˆ‘ä»¬éœ€è¦ç”¨d3.jsæ¥ç»˜åˆ¶æ‰€éœ€çš„æ‰€æœ‰è§†è§‰å…ƒç´ ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸€äº›æ•°æ®ã€‚</p><h3 id="data"><a href="#data" class="headerlink" title="data"></a>data</h3><p>æ•°æ®æ˜¯ç»´åº¦ä¸ç»´åº¦ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œå› æ­¤ï¼Œå¯¹äºæ¯ä¸€ä¸ªæ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„æœ‰ï¼šç»´åº¦1ï¼Œç»´åº¦2ï¼Œç»´åº¦1ä¸ç»´åº¦2ä¹‹é—´çš„ç›¸å…³æ€§ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">\&lt;script\&gt;</div><div class="line"></div><div class="line">var s =[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;,&quot;d&quot;,&quot;e&quot;,&quot;f&quot;,&quot;g&quot;,&quot;h&quot;,&quot;i&quot;,&apos;j&apos;,&apos;k&apos;,&apos;l&apos;]();</div><div class="line">var data = []();</div><div class="line">for(var i=0;i\&lt; s.length;i++)</div><div class="line">for(var j=0;j\&lt; s.length;j++)</div><div class="line">&#123;</div><div class="line">data.push(&#123;&apos;y&apos;:s[j](),&apos;x&apos;:s[i](),&quot;value&quot;:Math.random()&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">\&lt;/script\&gt;</div><div class="line"></div></pre></td></tr></table></figure><br>è¿™æ ·æˆ‘ä»¬å¾—åˆ°çš„æ•°æ®å°†ä¼šæ˜¯è¿™æ ·çš„ç»“æ„ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">data = [</div><div class="line">]()&#123;</div><div class="line">&quot;y&quot;: &quot;a&quot;,</div><div class="line">&quot;x&quot;: â€œaâ€,</div><div class="line">&quot;value&quot;: 1.0</div><div class="line">&#125;,</div><div class="line">&#123;</div><div class="line">&quot;y&quot;: &quot;a&quot;,</div><div class="line">&quot;x&quot;: â€œbâ€,</div><div class="line">&quot;value&quot;: 0.73</div><div class="line">&#125;ï¼Œâ€¦]</div></pre></td></tr></table></figure></p><h3 id="options"><a href="#options" class="headerlink" title="options"></a>options</h3><p>ä¸ºäº†å®ç°optionsçš„å¯é…ç½®ï¼Œæˆ‘ä»¬éœ€è¦é¢„å…ˆæä¾›ä¸€äº›å·²ç»å®šå¥½çš„optionã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">  var options = &#123;</div><div class="line">legend: true,</div><div class="line">margin: &#123; top: 50, right: 0, bottom: 100, left: 50 &#125;,</div><div class="line">buckets: 9,</div><div class="line">colors: [&quot;#ffffd9&quot;, &quot;#edf8b1&quot;, &quot;#c7e9b4&quot;, &quot;#7fcdbb&quot;, &quot;#41b6c4&quot;, &quot;#1d91c0&quot;, &quot;#225ea8&quot;, &quot;#253494&quot;, &quot;#081d58&quot;](),</div><div class="line">duration: 1000,</div><div class="line">legendWidth: 0.3,</div><div class="line">breaks: null</div><div class="line">&#125;;</div><div class="line"></div></pre></td></tr></table></figure><br>ä¸ºäº†ä½¿å¾—å¯ä»¥æ·»åŠ æˆ–è€…æ›¿æ¢é»˜è®¤çš„optionsï¼Œæˆ‘ä»¬å€ŸåŠ©angular.extend()å‡½æ•°å°†scopeé‡Œä¼ è¿›æ¥çš„optionså’Œé»˜è®¤çš„optionsè¿›è¡Œåˆå¹¶ï¼Œä½œä¸ºæ–°çš„optionsã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> if (scope.options) &#123;</div><div class="line">options = angular.extend(options, scope.options);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h3 id="dispatch"><a href="#dispatch" class="headerlink" title="dispatch"></a>dispatch</h3><p>é€šè¿‡dispatché¢„å…ˆå®šä¹‰ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚click,mouseover,mouse out,mouse moveï¼Œåœ¨ç‰¹å®šçš„æƒ…å†µä¸‹å¯ä»¥è§¦å‘ä»–ä»¬ã€‚ä»£ç è¿™æ ·å†™èµ·æ¥ä¼šæ¯”è¾ƒä¼˜é›…ï¼Œæ˜¾å¾—éå¸¸çš„æœ‰æ¡ç†ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">scope.dispatch = d3.dispatch(&quot;click&quot;, &quot;mouseover&quot;, &quot;mouseout&quot;, &quot;mousemove&quot;);</div><div class="line"></div><div class="line"> $scope.$watch(&quot;dispatch&quot;, function() &#123;</div><div class="line">if ($scope.dispatch) &#123;</div><div class="line">$scope.dispatch.on(&quot;click&quot;, function(e) &#123;</div><div class="line">console.log(e);</div><div class="line">&#125;);</div><div class="line">$scope.dispatch.on(&quot;mouseover&quot;, function(e) &#123;</div><div class="line">return tooltip.text(e.y + &quot;: &quot; + e.x + &quot; (&quot; + e.value + &quot;)&quot;).style(&quot;visibility&quot;, &quot;visible&quot;);</div><div class="line">&#125;)</div><div class="line">$scope.dispatch.on(&quot;mousemove&quot;, function(e) &#123;</div><div class="line">return tooltip.style(&quot;top&quot;, (d3.event.pageY - 10) + &quot;px&quot;).style(&quot;left&quot;, (d3.event.pageX + 10) + &quot;px&quot;);</div><div class="line">&#125;)</div><div class="line">$scope.dispatch.on(&quot;mouseout&quot;, function(e) &#123;</div><div class="line">return tooltip.style(&quot;visibility&quot;, &quot;hidden&quot;);</div><div class="line">&#125;);</div><div class="line">&#125;</div><div class="line">&#125;, true);</div><div class="line"></div></pre></td></tr></table></figure></p><h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><p>å‰æœŸçš„å‡†å¤‡å·¥ä½œåšå¾—å·®ä¸å¤šäº†ï¼Œæ¥ä¸‹æ¥åˆ°äº†æœ€é‡è¦çš„ç¯èŠ‚ï¼Œ<strong>ç»˜åˆ¶</strong>ã€‚è¯´é‡è¦ä¹Ÿé‡è¦ï¼Œä½†å…¶å®è¿™åº”è¯¥æ˜¯d3.jsçš„åŸºæœ¬åŠŸäº†ã€‚æ— éå°±æ˜¯æ§åˆ¶æ¯ä¸ªå…ƒç´ çš„å„ç§å±æ€§ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå®šä¹‰çš„svgä¸å†æ˜¯d3.select(â€˜bodyâ€™)äº†ï¼Œè€Œæ˜¯select(elementã€0ã€‘)ã€‚<br>ç›¸å…³ä»£ç ä»¥åŠæ³¨é‡Šå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">  var render = function() &#123;</div><div class="line"></div><div class="line">var w = element[0]().offsetWidth;</div><div class="line">var h = element[0]().offsetHeight;</div><div class="line">var width = w - options.margin.left - options.margin.right;</div><div class="line">var height = h - options.margin.top - options.margin.bottom;</div><div class="line">//å…ˆè¦ç§»é™¤ä¹‹å‰çš„è®°å½•</div><div class="line">d3.select(element[0]()).select(&quot;svg&quot;).remove();</div><div class="line">//svgçš„ä½ç½®ã€å¤§å°</div><div class="line">var svg = d3.select(element[0]()).append(&quot;svg&quot;)</div><div class="line">.attr(&quot;width&quot;, width + options.margin.left + options.margin.right)</div><div class="line">.attr(&quot;height&quot;, height + options.margin.top + options.margin.bottom)</div><div class="line">.append(&quot;g&quot;)</div><div class="line">.attr(&quot;transform&quot;, &quot;translate(&quot; + options.margin.left + &quot;,&quot; + options.margin.top + &quot;)&quot;);</div><div class="line">//æ‰¾åˆ°dataä¸­æ¯ä¸€ä¸ªç»´åº¦çš„åæ ‡ï¼Œæ–¹ä¾¿ç»˜åˆ¶</div><div class="line">var xu = &#123;&#125;;</div><div class="line">var x = []();</div><div class="line">var yu = &#123;&#125;;</div><div class="line">var y = []();</div><div class="line"></div><div class="line">for (var i in scope.data) &#123;</div><div class="line">if (typeof(xu[scope.data[i]().x]) == &quot;undefined&quot;) &#123;</div><div class="line">x.push(scope.data[i]().x);</div><div class="line">&#125;</div><div class="line">xu[scope.data[i]().x] = 0;</div><div class="line">if (typeof(yu[scope.data[i]().y]) == &quot;undefined&quot;) &#123;</div><div class="line">y.push(scope.data[i]().y);</div><div class="line">&#125;</div><div class="line">yu[scope.data[i]().y] = 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line">for (d in scope.data) &#123;</div><div class="line">scope.data[d]().xIndex = x.indexOf(scope.data[d]().x);</div><div class="line">scope.data[d]().yIndex = y.indexOf(scope.data[d]().y);</div><div class="line">&#125;</div><div class="line">//æ ¹æ®ç»´åº¦æ¥å†³å®šçƒ­åŠ›å›¾æ¯ä¸€å—çš„é•¿å®½ï¼Œæ›´dynamic</div><div class="line">var xGridSize = Math.floor(width / x.length);</div><div class="line">var yGridSize = Math.floor(height / y.length);</div><div class="line">var legendElementWidth = Math.floor(width \*Â options.legendWidth / (options.buckets));</div><div class="line">var legendElementHeight = height / 20;</div><div class="line">// ç»˜åˆ¶yè½´æ—çš„å…ƒç´ å</div><div class="line">var yLabels = svg.selectAll(&quot;.yLabel&quot;)</div><div class="line">.data(y)</div><div class="line">.enter().append(&quot;text&quot;)</div><div class="line">.text(function (d) &#123; return d; &#125;)</div><div class="line">.attr(&quot;x&quot;, 0)</div><div class="line">.attr(&quot;y&quot;, function (d, i) &#123; return i \*Â yGridSize; &#125;)</div><div class="line">.style(&quot;text-anchor&quot;, &quot;end&quot;)</div><div class="line">.attr(&quot;transform&quot;, &quot;translate(-6,&quot; + yGridSize / 1.5 + &quot;)&quot;)</div><div class="line">.attr(&quot;class&quot;, function (d, i) &#123; return (&quot;yLabel axis&quot;); &#125;);</div><div class="line">// ç»˜åˆ¶xè½´æ—çš„å…ƒç´ å</div><div class="line">var xLabels = svg.selectAll(&quot;.xLabel&quot;)</div><div class="line">.data(x)</div><div class="line">.enter().append(&quot;text&quot;)</div><div class="line">.text(function(d) &#123; return d; &#125;)</div><div class="line">.attr(&quot;y&quot;, function(d, i) &#123; return i \*Â xGridSize; &#125;)</div><div class="line">.attr(&quot;x&quot;, 0)</div><div class="line">.style(&quot;text-anchor&quot;, &quot;start&quot;)</div><div class="line">.attr(&quot;transform&quot;, &quot;rotate(-90) translate(10, &quot; + xGridSize / 2 + &quot;)&quot;)</div><div class="line">.attr(&quot;class&quot;, function(d, i) &#123; return (&quot;xLabel axis&quot;); &#125;);</div><div class="line"></div><div class="line">var colorScales = []();</div><div class="line">if (options.breaks != null &amp;&amp; options.breaks.length \&gt; 0) &#123;</div><div class="line">for (b in options.colors) &#123;</div><div class="line">colorScales.push(d3.scale.quantile()</div><div class="line">.domain([0, options.buckets - 1, d3.max(scope.data, function(d) &#123; return d.value; &#125;)]())</div><div class="line">.range(options.colors[b]()));</div><div class="line">&#125;</div><div class="line">&#125; else &#123;</div><div class="line">colorScales.push(d3.scale.quantile()</div><div class="line">.domain([0, options.buckets - 1, d3.max(scope.data, function(d) &#123; return d.value; &#125;)]())</div><div class="line">.range(options.colors));</div><div class="line">&#125;</div><div class="line">//ç»˜åˆ¶çƒ­åŠ›å›¾ä¸­çš„æœ€å°cellå•ä½ï¼Œå¹¶åˆ¶å®šé¢œè‰²ï¼ŒåŠ¨ä½œ</div><div class="line">var cards = svg.selectAll(&quot;.square&quot;)</div><div class="line">.data(scope.data);</div><div class="line"></div><div class="line">cards.enter().append(&quot;rect&quot;)</div><div class="line">.filter(function(d) &#123; return d.value != null &#125;)</div><div class="line">.attr(&quot;x&quot;, function(d) &#123; return d.xIndex \*Â xGridSize; &#125;)</div><div class="line">.attr(&quot;y&quot;, function(d) &#123; return d.yIndex \*Â yGridSize; &#125;)</div><div class="line">.attr(&quot;class&quot;, &quot;square&quot;)</div><div class="line">.attr(&quot;width&quot;, xGridSize)</div><div class="line">.attr(&quot;height&quot;, yGridSize)</div><div class="line">.on(&quot;click&quot;, function(d) &#123; scope.dispatch.click(d); &#125;)</div><div class="line">.on(&quot;mouseover&quot;, function(d) &#123; scope.dispatch.mouseover(d); &#125;)</div><div class="line">.on(&quot;mouseout&quot;, function(d) &#123; scope.dispatch.mouseout(d); &#125;)</div><div class="line">.on(&quot;mousemove&quot;, function(d) &#123; scope.dispatch.mousemove(d); &#125;)</div><div class="line">.style(&quot;fill&quot;, &quot;#ffffff&quot;);</div><div class="line"></div><div class="line">//å¢åŠ åŠ¨ç”»æ•ˆæœ                cards.transition().duration(options.duration).style(&quot;fill&quot;, function(d) &#123;</div><div class="line">if (options.customColors &amp;&amp; options.customColors.hasOwnProperty(d.value)) &#123;</div><div class="line">return options.customColors[d.value]();</div><div class="line">&#125; else if (options.breaks != null &amp;&amp; options.breaks.length \&gt; 0) &#123;</div><div class="line">for (b in options.breaks) &#123;</div><div class="line">if (d.xIndex \&lt; options.breaks[b]()) &#123;</div><div class="line">return colorScales[b]()(d.value);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">return colorScales[options.breaks.length]()(d.value);</div><div class="line">&#125; else &#123;</div><div class="line">return colorScales[0]()(d.value);</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">cards.exit().remove();</div><div class="line"></div><div class="line">if (options.legend) &#123;</div><div class="line"></div><div class="line">var legend = svg.selectAll(&quot;.legend&quot;)</div><div class="line">.data([0]().concat(colorScales[0]().quantiles()).concat(d3.max(scope.data, function (d) &#123; return d.value; &#125;)), function(d) &#123; return d; &#125;);</div><div class="line"></div><div class="line">legend.enter().append(&quot;g&quot;).attr(&quot;class&quot;, &quot;legend&quot;);</div><div class="line">//ä¸‹é¢çš„å‚è€ƒæ•°å€¼å¯¹åº”çš„é¢œè‰²</div><div class="line">legend.append(&quot;rect&quot;)</div><div class="line">.attr(&quot;x&quot;, function(d, i) &#123; return legendElementWidth \*Â i; &#125;)</div><div class="line">.attr(&quot;y&quot;, height \*Â 1.05)</div><div class="line">.attr(&quot;width&quot;, legendElementWidth)</div><div class="line">.attr(&quot;height&quot;, legendElementHeight)</div><div class="line">.style(&quot;fill&quot;, function(d, i) &#123; return options.colors[i](); &#125;)</div><div class="line">.style(&quot;visibility&quot;, function(d, i) &#123; return(i \&lt; options.buckets ? &quot;visible&quot; : &quot;hidden&quot;) &#125;);</div><div class="line">//å‚è€ƒæ•°å€¼</div><div class="line">legend.append(&quot;text&quot;)</div><div class="line">.attr(&quot;class&quot;, &quot;legendLabel&quot;)</div><div class="line">.text(function(d,i) &#123; return (0.1\*i+0.1).toFixed(1); &#125;)</div><div class="line">.attr(&quot;x&quot;, function(d, i) &#123; return legendElementWidth \*Â i; &#125;)</div><div class="line">.attr(&quot;y&quot;, height \*Â 1.15)</div><div class="line">.style(&quot;text-anchor&quot;, &quot;middle&quot;);</div><div class="line"></div><div class="line">legend.exit().remove();</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div></pre></td></tr></table></figure></p><h3 id="å¢åŠ å“åº”"><a href="#å¢åŠ å“åº”" class="headerlink" title="å¢åŠ å“åº”"></a>å¢åŠ å“åº”</h3><p>å½“æ•°æ®å˜åŒ–ï¼Œæˆ–webpageçš„çª—å£å¤§å°å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå¸Œæœ›èƒ½å¤Ÿé‡æ–°ç»˜åˆ¶çƒ­åŠ›å›¾ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸Šé¢å°†renderå‡½æ•°å®šä¹‰ä¸ºä¸€ä¸ªå˜é‡çš„åŸå› ã€‚<br>ç›‘æ§æ•°æ®çš„å˜åŒ–ï¼Œå¯ä»¥å€ŸåŠ©angularçš„$watchå‡½æ•°æ¥å®Œæˆã€‚ä¸ºäº†æœ‰å»¶æ—¶çš„æ•ˆæœï¼Œéœ€è¦ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œä»£ç å¦‚ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">//æ•°æ®å˜åŒ–äº†</div><div class="line">scope.$watch(&quot;data&quot;, function() &#123;</div><div class="line">render();</div><div class="line">&#125;, true);</div><div class="line">//çª—å£å¤§å°æ”¹å˜</div><div class="line">d3.select(window).on(&quot;resize&quot;, debounce(function() &#123;</div><div class="line">render();</div><div class="line">&#125;, 500));</div><div class="line"></div><div class="line">//è¾…åŠ©å‡½æ•°ï¼Œæ§åˆ¶å»¶æ—¶</div><div class="line">var debounce = function(f, timeout) &#123;</div><div class="line">var id = -1;</div><div class="line">return function() &#123;</div><div class="line">if (id \&gt; -1) &#123;</div><div class="line">window.clearTimeout(id);</div><div class="line">&#125;</div><div class="line">id = window.setTimeout(f, timeout);</div><div class="line">&#125;</div><div class="line">&#125;;</div><div class="line"></div></pre></td></tr></table></figure><h3 id="CSSæ ·å¼è¡¨"><a href="#CSSæ ·å¼è¡¨" class="headerlink" title="CSSæ ·å¼è¡¨"></a>CSSæ ·å¼è¡¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">\&lt;style\&gt;</div><div class="line">.xLabel, .yLabel, .legendLabel &#123;</div><div class="line">font-size: 9px;</div><div class="line">font-family: Verdana;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.tooltip &#123;</div><div class="line">font-size: 9px;</div><div class="line">font-family: Verdana;</div><div class="line">background-color: #333333;</div><div class="line">padding: 5px;</div><div class="line">color: #ffffff;</div><div class="line">border-radius: 3px;</div><div class="line">opacity: 0.7;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.chart &#123;</div><div class="line">width: 50%;</div><div class="line">height: 600px;</div><div class="line">background-color: #ffffff;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.square &#123;</div><div class="line">cursor: pointer;</div><div class="line">&#125;</div><div class="line"></div><div class="line">\&lt;/style\&gt;</div></pre></td></tr></table></figure><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li>ã€ŠD3 on AngularJSã€‹ <a href="https://leanpub.com/d3angularjs" target="_blank" rel="external">https://leanpub.com/d3angularjs</a></li><li>ã€ŠBuild custom directives with AngularJSã€‹ <a href="http://ngnewsletter.wpengine.com/?p=218" target="_blank" rel="external">http://ngnewsletter.wpengine.com/?p=218</a></li><li>ã€ŠAngularJS &amp; D3: Directives for Visualizationsã€‹ <a href="https://www.youtube.com/watch?v=aqHBLS_6gF8" target="_blank" rel="external">https://www.youtube.com/watch?v=aqHBLS_6gF8</a></li><li>pieterprovoostâ€™s github <a href="https://github.com/pieterprovoost/heatmap" target="_blank" rel="external">https://github.com/pieterprovoost/heatmap</a></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h1&gt;&lt;p&gt;å‰é¢ä¸¤ç¯‡åšå®¢ä»‹ç»äº†å¦‚ä½•å€ŸåŠ©angularï¼Œè®©æˆ‘ä»¬çš„å¯è§†åŒ–å›¾èƒ½å¤Ÿæ›´æœ‰&lt;strong&gt;æ¨¡å—åŒ–&lt;/strong&gt;ã€&lt;strong&gt;æ–¹ä¾¿å¤ç”¨&lt;/st
      
    
    </summary>
    
      <category term="visualization" scheme="http://zhihaozhang.github.io/categories/visualization/"/>
    
    
      <category term="d3" scheme="http://zhihaozhang.github.io/tags/d3/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨Javaç”ŸæˆJsonæ–‡ä»¶</title>
    <link href="http://zhihaozhang.github.io/2014/04/24/%E7%94%A8Java%E7%94%9F%E6%88%90Json%E6%96%87%E4%BB%B6/"/>
    <id>http://zhihaozhang.github.io/2014/04/24/ç”¨Javaç”ŸæˆJsonæ–‡ä»¶/</id>
    <published>2014-04-24T12:55:00.000Z</published>
    <updated>2017-09-24T04:15:45.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Json"><a href="#Json" class="headerlink" title="Json"></a>Json</h1><h2 id="Jsonæ˜¯ä»€ä¹ˆ"><a href="#Jsonæ˜¯ä»€ä¹ˆ" class="headerlink" title="Jsonæ˜¯ä»€ä¹ˆ"></a>Jsonæ˜¯ä»€ä¹ˆ</h2><blockquote><p>  ã€ç™¾åº¦ç™¾ç§‘ã€‘JSON(JavaScript Object Notation) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚å®ƒåŸºäºECMAScriptçš„ä¸€ä¸ªå­é›†ã€‚ JSONé‡‡ç”¨å®Œå…¨ç‹¬ç«‹äºè¯­è¨€çš„æ–‡æœ¬æ ¼å¼ï¼Œä½†æ˜¯ä¹Ÿä½¿ç”¨äº†ç±»ä¼¼äºCè¯­è¨€å®¶æ—çš„ä¹ æƒ¯ï¼ˆåŒ…æ‹¬Cã€C++ã€C#ã€Javaã€JavaScriptã€Perlã€Pythonç­‰ï¼‰ã€‚è¿™äº›ç‰¹æ€§ä½¿JSONæˆä¸ºç†æƒ³çš„æ•°æ®äº¤æ¢è¯­è¨€ã€‚ æ˜“äºäººé˜…è¯»å’Œç¼–å†™ï¼ŒåŒæ—¶ä¹Ÿæ˜“äºæœºå™¨è§£æå’Œç”Ÿæˆ(ç½‘ç»œä¼ è¾“é€Ÿç‡)ã€‚</p></blockquote><h2 id="Jsonè¯­æ³•è§„åˆ™"><a href="#Jsonè¯­æ³•è§„åˆ™" class="headerlink" title="Jsonè¯­æ³•è§„åˆ™"></a>Jsonè¯­æ³•è§„åˆ™</h2><p>JSON è¯­æ³•æ˜¯ JavaScript å¯¹è±¡è¡¨ç¤ºè¯­æ³•çš„å­é›†ã€‚<br>1.æ•°æ®åœ¨é”®å€¼å¯¹ä¸­<br>2.æ•°æ®ç”±é€—å·åˆ†éš”<br>3.èŠ±æ‹¬å·ä¿å­˜å¯¹è±¡<br>4.æ–¹æ‹¬å·ä¿å­˜æ•°ç»„<br>ä¾‹å¦‚ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">&quot;people&quot;:[</div><div class="line">    &#123;&quot;firstName&quot;:&quot;Brett&quot;,&quot;lastName&quot;:&quot;McLaughlin&quot;,&quot;email&quot;:&quot;aaaa&quot;&#125;,</div><div class="line">    &#123;&quot;firstName&quot;:&quot;Jason&quot;,&quot;lastName&quot;:&quot;Hunter&quot;,&quot;email&quot;:&quot;bbbb&quot;&#125;,</div><div class="line">    &#123;&quot;firstName&quot;:&quot;Elliotte&quot;,&quot;lastName&quot;:&quot;Harold&quot;,&quot;email&quot;:&quot;cccc&quot;&#125;</div><div class="line">]</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure></p><h1 id="Javaå†™å…¥Jsonæ ¼å¼æ•°æ®åˆ°-jsonæ ¼å¼æ–‡ä»¶"><a href="#Javaå†™å…¥Jsonæ ¼å¼æ•°æ®åˆ°-jsonæ ¼å¼æ–‡ä»¶" class="headerlink" title="Javaå†™å…¥Jsonæ ¼å¼æ•°æ®åˆ°.jsonæ ¼å¼æ–‡ä»¶"></a>Javaå†™å…¥Jsonæ ¼å¼æ•°æ®åˆ°.jsonæ ¼å¼æ–‡ä»¶</h1><p>ç”¨Javaç”Ÿæˆjsonæ ¼å¼çš„æ–‡ä»¶åˆ†æˆä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯<strong>ç”Ÿæˆjsonæ ¼å¼æ•°æ®</strong>ï¼Œç¬¬äºŒæ­¥æ˜¯<strong>å°†jsonæ ¼å¼çš„æ•°æ®å†™å…¥æ–‡ä»¶</strong>ã€‚</p><h2 id="ç”Ÿæˆjsonæ ¼å¼æ•°æ®"><a href="#ç”Ÿæˆjsonæ ¼å¼æ•°æ®" class="headerlink" title="ç”Ÿæˆjsonæ ¼å¼æ•°æ®"></a>ç”Ÿæˆjsonæ ¼å¼æ•°æ®</h2><p>ç”Ÿæˆjsonæ ¼å¼çš„æ•°æ®æ˜¯å€ŸåŠ©json-libæ‰€éœ€çš„å…¨éƒ¨jaråŒ…åšåˆ°çš„ï¼Œå¯ä»¥åˆ°<a href="http://download.csdn.net/detail/u014481096/8493539" target="_blank" rel="external">è¿™é‡Œ</a>å…è´¹ä¸‹è½½å…¨éƒ¨æ‰€éœ€çš„jaråŒ…ã€‚ä¸‹è½½å®Œæˆåï¼Œå¯¼å…¥åˆ°é¡¹ç›®ä¸­ã€‚<br>è¿™äº›jaråŒ…å¯ä»¥å°†Listã€Mapã€Beanã€æ•°ç»„ç­‰è½¬æˆjsonæ ¼å¼çš„æ•°æ®ï¼Œéå¸¸æ–¹ä¾¿ã€‚ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œç»™å‡ºäº†ä¸€éƒ¨åˆ†çš„ä¾‹å­ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">List&lt;String&gt; list = new ArrayList&lt;String&gt;();</div><div class="line">list.add(&quot;hello&quot;);</div><div class="line">list.add(&quot;world&quot;);</div><div class="line"></div><div class="line">HashMap&lt;String,String&gt; map = new HashMap&lt;String,String&gt;();</div><div class="line">map.put(&quot;name&quot;, &quot;attribute a&quot;);</div><div class="line">map.put(&quot;id&quot;,&quot;dingdangmao&quot;);</div><div class="line"></div><div class="line">people p1 = new people(&quot;zhangsan&quot;,&quot;310504&quot;,&quot;552339&quot;,259034);</div><div class="line">people p2 = new people(&quot;zhangsi&quot;,&quot;52083&quot;,&quot;85640&quot;,42153);</div><div class="line">people p3 = new people(&quot;zhangwu&quot;,&quot;515910&quot;,&quot;828669&quot;,362642);</div><div class="line">people p4 = new people(&quot;zhangliu&quot;,&quot;315910&quot;,&quot;728669&quot;,562642);</div><div class="line">people p5 = new people(&quot;zhangqi&quot;,&quot;415910&quot;,&quot;928669&quot;,162642);</div><div class="line"></div><div class="line">ArrayList&lt;String&gt; m = new ArrayList&lt;String&gt;();</div><div class="line">m.add(new String(p1.toString()));</div><div class="line">m.add(new String(p2.toString()));</div><div class="line">m.add(new String(p3.toString()));</div><div class="line">m.add(new String(p4.toString()));</div><div class="line">m.add(new String(p5.toString()));</div><div class="line"></div><div class="line">JSONArray j = JSONArray.fromObject(m);</div><div class="line">System.out.println(j);</div><div class="line"></div><div class="line">net.sf.json.JSONArray jsonArray = net.sf.json.JSONArray.fromObject(map);</div><div class="line"></div><div class="line">boolean[] boolArray = new boolean[]&#123;true,false,true&#125;;      </div><div class="line">JSONArray jsonArray1 = JSONArray.fromObject( boolArray );      </div><div class="line">System.out.println( jsonArray1 );      </div><div class="line">System.out.println(jsonArray.toString());</div><div class="line"></div></pre></td></tr></table></figure><h2 id="å°†jsonæ ¼å¼çš„æ•°æ®å†™å…¥æ–‡ä»¶"><a href="#å°†jsonæ ¼å¼çš„æ•°æ®å†™å…¥æ–‡ä»¶" class="headerlink" title="å°†jsonæ ¼å¼çš„æ•°æ®å†™å…¥æ–‡ä»¶"></a>å°†jsonæ ¼å¼çš„æ•°æ®å†™å…¥æ–‡ä»¶</h2><p>å°†å·²æœ‰çš„jsonæ ¼å¼æ–‡ä»¶å†™å…¥æ–‡ä»¶å’Œå…¶ä»–çš„Javaå†™æ–‡ä»¶å¹¶æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œä½†ä¸ºäº†åšåˆ°æœ‰æ ¼å¼çš„å°†jsonå¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œæ˜¯éœ€è¦å‚è€ƒæ•°æ®ç»“æ„ä¸­çš„æ‹¬å·åŒ¹é…é—®é¢˜çš„ã€‚è¿™é‡Œå‚è€ƒäº†<a href="http://blog.csdn.net/gemuandyou/article/details/46737879" target="_blank" rel="external">CSDNçš„åšå®¢</a>ï¼Œæ„Ÿè°¢ä½œè€…ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public void writeToJson(String filePath,JSONArray object) throws IOException</div><div class="line">&#123;</div><div class="line">    File file = new File(filePath);</div><div class="line">    char [] stack = new char[1024];</div><div class="line">    int top=-1;</div><div class="line"></div><div class="line">    String string = object.toString();</div><div class="line"></div><div class="line">    StringBuffer sb = new StringBuffer();</div><div class="line">    char [] charArray = string.toCharArray();</div><div class="line">    for(int i=0;i&lt;charArray.length;i++)&#123;</div><div class="line">        char c= charArray[i];</div><div class="line">        if (&apos;&#123;&apos; == c || &apos;[&apos; == c) &#123;  </div><div class="line">            stack[++top] = c; </div><div class="line">            sb.append(&quot;\n&quot;+charArray[i] + &quot;\n&quot;);  </div><div class="line">            for (int j = 0; j &lt;= top; j++) &#123;  </div><div class="line">                sb.append(&quot;\t&quot;);  </div><div class="line">            &#125;  </div><div class="line">            continue;  </div><div class="line">        &#125;</div><div class="line">         if ((i + 1) &lt;= (charArray.length - 1)) &#123;  </div><div class="line">                char d = charArray[i+1];  </div><div class="line">                if (&apos;&#125;&apos; == d || &apos;]&apos; == d) &#123;  </div><div class="line">                    top--; </div><div class="line">                    sb.append(charArray[i] + &quot;\n&quot;);  </div><div class="line">                    for (int j = 0; j &lt;= top; j++) &#123;  </div><div class="line">                        sb.append(&quot;\t&quot;);  </div><div class="line">                    &#125;  </div><div class="line">                    continue;  </div><div class="line">                &#125;  </div><div class="line">            &#125;  </div><div class="line">            if (&apos;,&apos; == c) &#123;  </div><div class="line">                sb.append(charArray[i] + &quot;&quot;);  </div><div class="line">                for (int j = 0; j &lt;= top; j++) &#123;  </div><div class="line">                    sb.append(&quot;&quot;);  </div><div class="line">                &#125;  </div><div class="line">                continue;  </div><div class="line">            &#125;  </div><div class="line">            sb.append(c);  </div><div class="line">        &#125;  </div><div class="line">        Writer write = new FileWriter(file);  </div><div class="line">        write.write(sb.toString());  </div><div class="line">        write.flush();  </div><div class="line">        write.close();  </div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure><h1 id="one-more-thing"><a href="#one-more-thing" class="headerlink" title="one more thing"></a>one more thing</h1><p>åœ¨å°†jsonæ ¼å¼çš„æ•°æ®å†™å‡ºåˆ°æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦å†™å‡ºâ€å·æ¥ï¼Œåœ¨æ§åˆ¶å°è¾“å‡ºçš„æ—¶å€™ï¼Œå¾ˆå¤šäººéƒ½çŸ¥é“ä½¿ç”¨è½¬æ„ç¬¦ï¼Œå³System.out.println(â€œ/â€œâ€); ï¼Œä¸è¿‡åœ¨å°è¯•å†™å…¥åˆ°æ–‡ä»¶çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¹ˆæè¡Œä¸é€šï¼Œè¾“å‡ºåˆ°æ–‡ä»¶çš„æ—¶å€™è¿˜æ˜¯ä¼šæœ‰/ï¼Œè¿™è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ<br>çªå‘å¥‡æƒ³ï¼Œåœ¨éœ€è¦è¾“å‡ºçš„Stringçš„åŸºç¡€ä¸Šå†åŒ…ä¸€å±‚new String(string)<strong>æ¶ˆåŒ–</strong>æ‰è½¬æ„ç¬¦ã€‚çœŸçš„æˆåŠŸäº†ï¼æœ‰æ—¶å€™ï¼ŒçœŸçš„éœ€è¦ä¸€ç‚¹çµæ„Ÿ~<br><img src="http://ww2.sinaimg.cn/large/aa2320a8gw1evvieprj07j214c0qqn3r.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Json&quot;&gt;&lt;a href=&quot;#Json&quot; class=&quot;headerlink&quot; title=&quot;Json&quot;&gt;&lt;/a&gt;Json&lt;/h1&gt;&lt;h2 id=&quot;Jsonæ˜¯ä»€ä¹ˆ&quot;&gt;&lt;a href=&quot;#Jsonæ˜¯ä»€ä¹ˆ&quot; class=&quot;headerlink&quot; title=&quot;Jso
      
    
    </summary>
    
      <category term="Java" scheme="http://zhihaozhang.github.io/categories/Java/"/>
    
    
      <category term="Json" scheme="http://zhihaozhang.github.io/tags/Json/"/>
    
  </entry>
  
</feed>
